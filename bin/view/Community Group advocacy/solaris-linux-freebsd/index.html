<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>Solaris, Linux, BSD (Community Group advocacy.solaris-linux-freebsd) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd" />
                    <link rel="canonical" href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd" />
                            <meta name="document" content="Community Group advocacy.solaris-linux-freebsd"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Community Group advocacy"/>
    <meta name="page" content="solaris-linux-freebsd"/>
    <meta name="version" content="1.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Community+Group+advocacy/pages/solaris-linux-freebsd"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="Solaris, Linux, BSD" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="admin" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Community Group advocacy";
XWiki.currentPage = "solaris-linux-freebsd";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd";
window.docediturl = "/bin/edit/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd";
window.docsaveurl = "/bin/save/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd";
window.docgeturl = "/bin/get/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Community_Group_advocacy viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FCommunity%2BGroup%2Badvocacy%2Fsolaris%252Dlinux%252Dfreebsd"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+advocacy/"><strong>Community Group advocacy</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Community+Group+advocacy" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <table style="width: 100%;">
        <tr>
            <td style="width: 1%;">
                 <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>  
            </td>
            <td id="logo-text" style="width: 1%;">
                Solaris
            </td>         
            <td style="width: 98%;">
                <table id="loading-indicator">
                    <tr>
                        <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
                                 alt="Loading" title="Loading"/></td>
                        <td>Loading...</td>
                    </tr>
                </table>
            </td>
            <td style="width: 1%;">
                <table id="iconbar">
                    <tr>
                    <td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
                        Collectives</a></td>
                    <td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
                            Discussions</a></td>
                    <td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
                            Documentation</a></td>
                    <td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
                            Download</a></td>
                    <td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
                            Source Browser</a></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                              <a href='/bin/view/Community+Group+advocacy/articles'>Articles</a> <span class='separator'>&#187;</span> <span class='current'>Solaris, Linux, BSD</span>
                </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
        <a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?language=en" class="language-default language-current">en</a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
          <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?format=pdf&amp;language=en" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?format=rtf&amp;language=en" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?format=html&amp;language=en" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?viewer=code&amp;language=en"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?viewer=comments&amp;language=en" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?viewer=attachments&amp;language=en" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?viewer=history&amp;language=en" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?viewer=information&amp;language=en" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?viewer=code&amp;language=en" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?xpage=print&amp;language=en" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          <span class="submenuitem "><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd?xpage=copy" id="tmActionCopy" class="tmActionCopy">Copy</a></span>
      </span></div>
</div>

    </div>
    <div id="mainContentArea">
      








    
<div id="document-title"><h1>Solaris, Linux, BSD</h1></div>





              <div id="document-info">
    <div>
          </div>
    <div class="clearfloats"></div>
  </div>

<div id="xwikicontent">
<h1 id="HAComparisonofSolaris2CLinux2CandFreeBSDKernels"><span>A Comparison of Solaris, Linux, and FreeBSD Kernels</span></h1><h3 id="HbyMaxBruning"><span>by Max Bruning</span></h3><p>October 14, 2005</p><p>I spend most of my time teaching classes on Solaris internals, device drivers, and kernel crash dump analysis and debugging. When explaining to classes how various subsystems are implemented in Solaris, students often ask, "How does it work in Linux?" or, "In FreeBSD, it works like this, how about Solaris?" This article examines three of the basic subsystems of the kernel and compares implementation between Solaris 10, Linux 2.6, and FreeBSD 5.3.</p><p>The three subsystems examined are scheduling, memory management, and file system architecture. I chose these subsystems because they are common to any operating system (not just Unix and Unix-like systems), and they tend to be the most well-understood components of the operating system.</p><p>This article does not go into in-depth details on any of the subsystems described. For that, refer to the source code, various websites, and books on the subject. For specific books, see:</p><ul><li><em>Solaris Internals: Core Kernel Architecture</em> by McDougall and Mauro (visit <span class="wikiexternallink"><a href="http://www.solarisinternals.com/">Solaris Internals</a></span>)</li><li><em>The Design and Implementation of the FreeBSD Operating System</em> by McKusick and Neville-Neil (visit <span class="wikiexternallink"><a href="http://www.mckusick.com/FreeBSDbook.html">The Design and Implementation of the FreeBSD Operating System</a></span>)</li><li><em>Linux Kernel Development</em> by Love (visit <span class="wikiexternallink"><a href="http://rlove.org/kernel_book">Linux Kernel Development, 2nd Edition</a></span>) and <em>Understanding the Linux Kernel</em> by Bovet and Cesati (visit <span class="wikiexternallink"><a href="http://www.oreilly.com/catalog/linuxkernel2">Understanding the Linux Kernel, 2nd Edition</a></span>)</li></ul><p>If you search the Web for Linux, FreeBSD, and Solaris comparisons, most of the hits discuss old (in some cases, Solaris 2.5, Linux 2.2, etc.) versions of the OSes. Many of the "facts" are incorrect for the newest releases, and some were incorrect for the releases they intended to describe. Of course, most of them also make value judgments on the merits of the OSes in question, and there is little information comparing the kernels themselves. The following sites seem more or less up to date:</p><ul><li>"<span class="wikiexternallink"><a href="http://www.softpanorama.org/Articles/solaris_vs_linux.shtml">Solaris Vs. Linux</a></span>" is pretty one-sided for Solaris 10 over Linux.</li><li>"<span class="wikiexternallink"><a href="http://software.newsforge.com/print.pl?sid=04/12/27/1243207">Comparing MySQL Performance</a></span>" on Solaris 10, Linux, FreeBSD, and others.</li><li>"<span class="wikiexternallink"><a href="http://see.sun.com/Apps/DCS/mcp?q=STI00HTG6Hjxpv">Fast Track to Solaris 10 Adoption</a></span>" has some comparisons between Linux and Solaris.</li><li>"<span class="wikiexternallink"><a href="http://www.rednova.com/news/technology/135074/solaris_10_heads_for_linux_territory/index.html">Solaris 10 Heads for Linux Territory</a></span>" is not really a comparison, but reviews Solaris 10.</li></ul><p>One of the more interesting aspects of the three OSes is the amount of similarities between them. Once you get past the different naming conventions, each OS takes fairly similar paths toward implementing the different concepts. Each OS supports time-shared scheduling of threads, demand paging with a not-recently-used page replacement algorithm, and a virtual file system layer to allow the implementation of different file system architectures. Ideas that originate in one OS often find their way into others. For instance, Linux also uses the concepts behind Solaris's <span class="wikiexternallink"><a href="http://www.usenix.org/publications/library/proceedings/bos94/bonwick.html">slab memory allocator</a></span>. Much of the terminology seen in the FreeBSD source is also present in Solaris. With Sun's move to open source Solaris, I expect to see much more cross-fertilization of features. Currently, the LXR project provides a source cross-reference browser for FreeBSD, Linux, and other Unix-related OSes, available at <span class="wikiexternallink"><a href="http://fxr.watson.org/">fxr.watson.org</a></span>. It would be great to see OpenSolaris source added to that site.</p><h3 id="HSchedulingandSchedulers"><span>Scheduling and Schedulers</span></h3><p>The basic unit of scheduling in Solaris is the <span class="box code">kthread_t</span>; in FreeBSD, the <span class="box code">thread</span>; and in Linux, the <span class="box code">task_struct</span>. Solaris represents each process as a <span class="box code">proc_t</span>, and each thread within the process has a <span class="box code">kthread_t</span>. Linux represents processes (and threads) by <span class="box code">task_struct</span> structures. A single-threaded process in Linux has a single <span class="box code">task_struct</span>. A single-threaded process in Solaris has a <span class="box code">proc_t</span>, a single <span class="box code">kthread_t</span>, and a <span class="box code">klwp_t</span>. The <span class="box code">klwp_t</span> provides a save area for threads switching between user and kernel modes. A single-threaded process in FreeBSD has a <span class="box code">proc</span> struct, a <span class="box code">thread</span> struct, and a <span class="box code">ksegrp</span> struct. The <span class="box code">ksegrp</span> is a "kernel scheduling entity group." Effectively, all three OSes schedule threads, where a thread is a <span class="box code">kthread_t</span> in Solaris, a <span class="box code">thread</span> structure in FreeBSD, and a <span class="box code">task_struct</span> in Linux.</p><p>Scheduling decisions are based on priority. In Linux and FreeBSD, the lower the priority value, the better. This is an inversion; a value closer to 0 represents a higher priority. In Solaris, the higher the value, the higher the priority. <span class="wikilink"><a href="#table1">Table 1</a></span> shows the priority values of the different OSes.</p><p><em>Table 1. Scheduling Priorities in Solaris, Linux, and FreeBSD<br/></em></p><table><tr><th scope="col">Solaris</th><th scope="col">Priorities</th><th scope="col">Scheduling Class</th></tr><tr><td> </td><td>0-59</td><td>Time Shared, Interactive, Fixed, Fair Share Scheduler</td></tr><tr><td> </td><td>60-99</td><td>System Class</td></tr><tr><td> </td><td>100-159</td><td>Real-Time (note real-time higher than system threads)</td></tr><tr><td> </td><td>160-169</td><td>Low level Interrupts</td></tr><tr><th scope="row">Linux</th><th scope="col">Priorities</th><th scope="col">Scheduling Class</th></tr><tr><td> </td><td>0-99</td><td>System Threads, Real time (SCHED_FIFO, SCHED_RR)</td></tr><tr><td> </td><td>100-139</td><td>User priorities (SCHED_NORMAL)</td></tr><tr><th scope="row">FreeBSD</th><th scope="col">Priorities&nbsp;</th><th scope="col">Scheduling Class</th></tr><tr><td> </td><td>0-63</td><td>Interrupt</td></tr><tr><td> </td><td>64-127</td><td>Top-half Kernel</td></tr><tr><td> </td><td>128-159</td><td>Real-time user (system threads are better priority)</td></tr><tr><td> </td><td>160-223</td><td>Time-share user</td></tr><tr><td> </td><td>224-255</td><td>Idle user</td></tr></table><p>All three OSes favor interactive threads/processes. Interactive threads run at better priority than compute-bound threads, but tend to run for shorter time slices. Solaris, FreeBSD, and Linux all use a per-CPU "runqueue." FreeBSD and Linux use an "active" queue and an "expired" queue. Threads are scheduled in priority from the active queue. A thread moves from the active queue to the expired queue when it uses up its time slice (and possibly at other times to avoid starvation). When the active queue is empty, the kernel swaps the active and expired queues. FreeBSD has a third queue for "idle" threads. Threads run on this queue only when the other two queues are empty. Solaris uses a "dispatch queue" per CPU. If a thread uses up its time slice, the kernel gives it a new priority and returns it to the dispatch queue. The "runqueues" for all three OSes have separate linked lists of runnable threads for different priorities. (Though FreeBSD uses one list per four priorities, both Solaris and Linux use a separate list for each priority.)</p><p>Linux and FreeBSD use an arithmetic calculation based on run time versus sleep time of a thread (as a measure of "interactive-ness") to arrive at a priority for the thread. Solaris performs a table lookup. None of the three OSes support "gang scheduling." Rather than schedule <em>n</em> threads, each OS schedules, in effect, the next thread to run. All three OSes have mechanisms to take advantage of caching (warm affinity) and load balancing. For hyperthreaded CPUs, FreeBSD has a mechanism to help keep threads on the same CPU node (though possibly a different hyperthread). Solaris has a similar mechanism, but it is under control of the user and application, and is not restricted to hyperthreads (called "processor sets" in Solaris and "processor groups" in FreeBSD).</p><p>One of the big differences between Solaris and the other two OSes is the capability to support multiple "scheduling classes" on the system at the same time. All three OSes support Posix <span class="box code">SCHED_FIFO</span>, <span class="box code">SCHED_RR</span>, and <span class="box code">SCHED_OTHER</span> (or <span class="box code">SCHED_NORMAL</span>). <span class="box code">SCHED_FIFO</span> and <span class="box code">SCHED_RR</span> typically result in "realtime" threads. (Note that Solaris and Linux support kernel preemption in support of realtime threads.) Solaris has support for a "fixed priority" class, a "system class" for system threads (such as page-out threads), an "interactive" class used for threads running in a windowing environment under control of the X server, and the Fair Share Scheduler in support of resource management. See <span class="box code">priocntl(1)</span> for information about using the classes, as well as an overview of the features of each class. See <span class="box code">FSS(7)</span> for an overview specific to the Fair Share Scheduler. The scheduler on FreeBSD is chosen at compile time, and on Linux the scheduler depends on the version of Linux.</p><p>The ability to add new scheduling classes to the system comes with a price. Everywhere in the kernel that a scheduling decision can be made (except for the actual act of choosing the thread to run) involves an indirect function call into scheduling class-specific code. For instance, when a thread is going to sleep, it calls scheduling-class-dependent code that does whatever is necessary for sleeping in the class. On Linux and FreeBSD, the scheduling code simply does the needed action. There is no need for an indirect call. The extra layer means there is slightly more overhead for scheduling on Solaris (but more features).</p><h3 id="HMemoryManagementandPaging"><span>Memory Management and Paging</span></h3><p>In Solaris, every process has an "address space" made up of logical section divisions called "segments." The segments of a process address space are viewable via <span class="box code">pmap(1)</span>. Solaris divides the memory management code and data structures into platform-independent and platform-specific parts. The platform-specific portions of memory management is in the HAT, or hardware address translation, layer. FreeBSD describes its process address space by a vmspace, divided into logical sections called regions. Hardware-dependent portions are in the "pmap" (physical map) module and "vmap" routines handle hardware-independent portions and data structures. Linux uses a memory descriptor to divides the process address space into logical sections called "memory areas" to describe process address space. Linux also has a <span class="box code">pmap</span> command to examine process address space.</p><p>Linux divides machine-dependent layers from machine-independent layers at a much higher level in the software. On Solaris and FreeBSD, much of the code dealing with, for instance, page fault handling is machine-independent. On Linux, the code to handle page faults is pretty much machine-dependent from the beginning of the fault handling. A consequence of this is that Linux can handle much of the paging code more quickly because there is less data abstraction (layering) in the code. However, the cost is that a change in the underlying hardware or model requires more changes to the code. Solaris and FreeBSD isolate such changes to the HAT and pmap layers respectively.</p><p>Segments, regions, and memory areas are delimited by:</p><ul><li>Virtual address of the start of the area.</li><li>Their location within an object/file that the segment/region/memory area maps.</li><li>Permissions.</li><li>Size of the mapping.</li></ul><p>For instance, the text of a program is in a segment/region/memory area. The mechanisms in the three OSes to manage address spaces are very similar, but the names of data structures are completely different. Again, more of the Linux code is machine-dependent than is true of the other two OSes.</p><h4 id="HPaging"><span>Paging</span></h4><p>All three operating systems use a variation of a least recently used algorithm for page stealing/replacement. All three have a daemon process/thread to do page replacement. On FreeBSD, the <span class="box code">vm_pageout</span> daemon wakes up periodically and when free memory becomes low. When available memory goes below some thresholds, <span class="box code">vm_pageout</span> runs a routine (<span class="box code">vm_pageout_scan</span>) to scan memory to try to free some pages. The <span class="box code">vm_pageout_scan</span> routine may need to write modified pages asynchronously to disk before freeing them. There is one of these daemons regardless of number of CPUs. Solaris also has a <span class="box code">pageout</span> daemon that also runs periodically and in response to low-free-memory situations. Paging thresholds in Solaris are automatically calibrated at system startup so that the daemon does not overuse the CPU or flood the disk with page-out requests. The FreeBSD daemon uses values that, for the most part, are hard-coded or tunable in order to determine paging thresholds. Linux also uses an LRU algorithm that is dynamically tuned while it runs. On Linux, there can be multiple <span class="box code">kswapd</span> daemons, as many as one per CPU. All three OSes use a global working set policy (as opposed to per process working set).</p><p>FreeBSD has several page lists for keeping track of recently used pages. These track "active," "inactive," "cached," and "free" pages. Pages move between these linked lists depending on their uses. Frequently accessed pages will tend to stay on the active list. Data pages of a process that exits can be immediately placed on the free list. FreeBSD may swap entire processes out if <span class="box code">vm_pageout_scan</span> cannot keep up with load (for example, if the system is low on memory). If the memory shortage is severe enough, <span class="box code">vm_pageout_scan</span> will kill the largest process on the system.</p><p>Linux also uses different linked lists of pages to facilitate an LRU-style algorithm. Linux divides physical memory into (possibly multiple sets of) three "zones:" one for DMA pages, one for normal pages, and one for dynamically allocated memory. These zones seem to be very much an implementation detail caused by x86 architectural constraints. Pages move between "hot," "cold," and "free" lists. Movement between the lists is very similar to the mechanism on FreeBSD. Frequently accessed pages will be on the "hot" list. Free pages will be on the "cold" or "free" list.</p><p>Solaris uses a free list, hashed list, and vnode page list to maintain its variation of an LRU replacement algorithm. Instead of scanning the vnode or hash page lists (more or less the equivalent of the "active"/"hot" lists in the FreeBSD/Linux implementations), Solaris scans all pages uses a "two-handed clock" algorithm as described in <em>Solaris Internals</em> and elsewhere. The two hands stay a fixed distance apart. The front hand ages the page by clearing reference bit(s) for the page. If no process has referenced the page since the front hand visited the page, the back hand will free the page (first asynchronously writing the page to disk if it is modified).</p><p>All three operating systems take NUMA locality into account during paging. The I/O buffer cache and the virtual memory page cache is merged into one system page cache on all three OSes. The system page cache is used for reads/writes of files as well as <span class="box code">mmap</span>ped files and text and data of applications.</p><h3 id="HFileSystems"><span>File Systems</span></h3><p>All three operating systems use a data abstraction layer to hide file system implementation details from applications. In all three OSes, you use <span class="box code">open</span>, <span class="box code">close</span>, <span class="box code">read</span>, <span class="box code">write</span>, <span class="box code">stat</span>, etc. system calls to access files, regardless of the underlying implementation and organization of file data. Solaris and FreeBSD call this mechanism VFS ("virtual file system") and the principle data structure is the <span class="box code">vnode</span>, or "virtual node." Every file being accessed in Solaris or FreeBSD has a <span class="box code">vnode</span> assigned to it. In addition to generic file information, the <span class="box code">vnode</span> contains pointers to file-system-specific information. Linux also uses a similar mechanism, also called VFS (for "virtual file switch"). In Linux, the file-system-independent data structure is an <span class="box code">inode</span>. This structure is similar to the <span class="box code">vnode</span> on Solaris/FreeBSD. (Note that there is an <span class="box code">inode</span> structure in Solaris/FreeBSD, but this is file-system-dependent data for UFS file systems). Linux has two different structures, one for file operations and the other for inode operations. Solaris and FreeBSD combine these as "vnode operations."</p><p>VFS allows the implementation of many file system types on the system. This means that there is no reason that one of these operating systems could not access the file systems of the other OSes. Of course, this requires the relevant file system routines and data structures to be ported to the VFS of the OS in question. All three OSes allow the stacking of file systems. <span class="wikilink"><a href="#fs_table">Table 2</a></span> lists file system types implemented in each OS, but it does not show <em>all</em> file system types.</p><p><em>Table 2. Partial List of File System Types</em></p><table><tr><th scope="col">Solaris</th><td>ufs</td><td>Default local file system (based on BSD Fast Filesystem)</td></tr><tr><td> </td><td>nfs</td><td>Remote Files</td></tr><tr><td> </td><td>proc</td><td>/proc files; see proc(4)</td></tr><tr><td> </td><td>namefs</td><td>Name file system; allows opening of doors/streams as files</td></tr><tr><td> </td><td>ctfs</td><td>Contract file system used with Service Management Facility</td></tr><tr><td> </td><td>tmpfs</td><td>Uses anonymous space (memory/swap) for temporary files</td></tr><tr><td> </td><td>swapfs</td><td>Keeps track of anonymous space (data, heap, stack, etc.)</td></tr><tr><td> </td><td>objfs</td><td>Keeps track of kernel modules, see objfs(7FS)</td></tr><tr><td> </td><td>devfs</td><td>Keeps track of /devices files; see devfs(7FS)</td></tr><tr><th scope="row">FreeBSD</th><td>ufs</td><td>Default local file system (ufs2, based on BSD Fast Filesystem)</td></tr><tr><td> </td><td>defvs</td><td>Keeps track of /dev files</td></tr><tr><td> </td><td>ext2</td><td>Linux ext2 file system (GNU-based)</td></tr><tr><td> </td><td>nfs</td><td>Remote files</td></tr><tr><td> </td><td>ntfs</td><td>Windows NT file system</td></tr><tr><td> </td><td>smbfs</td><td>Samba file system</td></tr><tr><td> </td><td>portalfs</td><td>Mount a process onto a directory</td></tr><tr><td> </td><td>kernfs</td><td>Files containing various system information</td></tr><tr><th scope="row">Linux</th><td>ext3</td><td>Journaling, extent-based file system from ext2</td></tr><tr><td> </td><td>ext2</td><td>Extent-based file system</td></tr><tr><td> </td><td>afs</td><td>AFS client support for remote file sharing</td></tr><tr><td> </td><td>nfs</td><td>Remote files</td></tr><tr><td> </td><td>coda</td><td>Another networked file system</td></tr><tr><td> </td><td>procfs</td><td>Processes, processors, buses, platform specifics</td></tr><tr><td> </td><td>reiserfs</td><td>Journaling file system</td></tr></table><h3 id="HConclusions"><span>Conclusions</span></h3><p>Solaris, FreeBSD, and Linux are obviously benefiting from each other. With Solaris going open source, I expect this to continue at a faster rate. My impression is that change is most rapid in Linux. The benefits of this are that new technology has a quick incorporation into the system. Unfortunately, the documentation (and possibly some robustness) sometimes lags behind. Linux has many developers, and sometimes it shows. FreeBSD has been around (in some sense) the longest of the three systems. Solaris has its basis in a combination of BSD Unix and AT&amp;T Bell Labs Unix. Solaris uses more data abstraction layering, and generally could support additional features quite easily because of this. However, most of the layering in the kernel is undocumented. Probably, source code access will change this.</p><p>A brief example to highlight differences is page fault handling. In Solaris, when a page fault occurs, the code starts in a platform-specific trap handler, then calls a generic <span class="box code">as_fault()</span> routine. This routine determines the segment where the fault occurred and calls a "segment driver" to handle the fault. The segment driver calls into file system code. The file system code calls into the device driver to bring in the page. When the page-in is complete, the segment driver calls the HAT layer to update page table entries (or their equivalent). On Linux, when a page fault occurs, the kernel calls the code to handle the fault. You are immediately into platform-specific code. This means the fault handling code can be quicker in Linux, but the Linux code may not be as easily extensible or ported.</p><p>Kernel visibility and debugging tools are critical to get a correct understanding of system behavior. Yes, you can read the source code, but I maintain that you can easily misread the code. Having tools available to test your hypothesis about how the code works is invaluable. In this respect, I see Solaris with <span class="box code">kmdb</span>, <span class="box code">mdb</span>, and DTrace as a clear winner. I have been "reverse engineering" Solaris for years. I find that I can usually answer a question by using the tools faster than I can answer the same question by reading source code. With Linux, I don't have as much choice for this. FreeBSD allows use of <span class="box code">gdb</span> on kernel crash dumps. <span class="box code">gdb</span> can set breakpoints, single step, and examine and modify data and code. On Linux, this is also possible once you download and install the tools.</p><p>Max Bruning currently teaches and consults on Solaris internals, device drivers, kernel (as well as application) crash analysis and debugging, networking internals, and specialized topics. Contact him at max@bruningsystems.com or <span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://mbruning.blogspot.com/."><span class="wikigeneratedlinkcontent">http://mbruning.blogspot.com/.</span></a></span></p>
</div>


    <div class="clearfloats"></div>
  </div>      <div id="xdocFooter">
  
                

       <div class="doc-tags" id="xdocTags">
        Tags:
        </div>
  
  <div id="xdocAuthors">
    <div class="xdocCreation">       Created by admin on 2009/10/26 12:07<br/>
          </div>
    <div class="xdocLastModification">       Last modified by admin on 2009/10/26 12:07
    </div>
  </div>
</div>
<div id="xwikidata" class="layoutsubsection">
        </div>  
    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Community Group advocacy Pages</h1>
<div class="xwikipanelcontents">
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/articles">Articles</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/christensen%2Dprofile">Profile: Christensen</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/dtrace%2Dteam%2Dprofile">Profile: DTrace</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/intro%2Dsolaris%2Ddrivers">Solaris Drivers</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/schilling%2Dprofile">Profile: Schilling</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/solaris%2Ddriver%2Dprogramming">Driver Programming</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/solaris%2Dlinux%2Dfreebsd">Solaris, Linux, BSD</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/solaris%2Dx86%2Dnotebooks">Solaris on Notebooks</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/teer%2Dprofile">Profile: Teer</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/tucker%2Dprofile">Profile: Tucker</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/using%2Dvmware">OpenSolaris & VMWare</a></span></li>
</ul></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/buttons">Fan Buttons</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/files">Files</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/marketing">Marketing</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/articles%2Dvideos%2Dstuff">Articles and Videos</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/buy%2Dswag">OpenSolaris Swag</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/contributoraward">Contributor Awards</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/help">How you can help</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/highlights">Marketing Highlights</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/homepagegraphics">Graphics July 2006</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/immigrants">Immigrants</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/mktg%2Dannouncements">Marketing Announces</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/mktgdownloads">OpenSolaris Artwork</a></span></li>
</ul></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/merger%2Darchive">Merger Archive</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/newsletter">Newsletter Archive</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/0405">2004&#45;2005</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/2006">2006</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/2007">2007</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/2008">2008</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/2009">2009</a></span></li>
</ul></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/os%2Dpresentations">OSUG Presentations</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/techdays%2Darchive%2D06%2D07">Tech Days 06&#45;07</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/techdays%2Darchive%2D07%2D08">Tech Days 07&#45;08</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/ug%2Dleaders">User Group Leaders</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+advocacy/usergroups">User Group Background</a></span></li>
</ul>
                              </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2012, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
