<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>Kernel Sockets (Project kernel-sockets.WebHome) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Project+kernel%2Dsockets/WebHome" />
                    <link rel="canonical" href="/bin/view/Project+kernel%2Dsockets/" />
                            <meta name="document" content="Project kernel-sockets.WebHome"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Project kernel-sockets"/>
    <meta name="page" content="WebHome"/>
    <meta name="version" content="2.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Project+kernel-sockets/pages/WebHome"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="Kernel Sockets" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="admin" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Project kernel-sockets";
XWiki.currentPage = "WebHome";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Project+kernel%2Dsockets/";
window.docediturl = "/bin/edit/Project+kernel%2Dsockets/WebHome";
window.docsaveurl = "/bin/save/Project+kernel%2Dsockets/WebHome";
window.docgeturl = "/bin/get/Project+kernel%2Dsockets/WebHome";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Project_kernel-sockets viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FProject%2Bkernel%252Dsockets%2F"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+kernel%2Dsockets/"><strong>Project kernel-sockets</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Project+kernel%2Dsockets" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <table style="width: 100%;">
        <tr>
            <td style="width: 1%;">
                 <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>
            </td>
            <td style="width: 99%;">
                <table id="loading-indicator">
                    <tr>
                        <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
                                 alt="Loading" title="Loading"/></td>
                        <td>Loading...</td>
                    </tr>
                </table>
            </td>
            <td style="width: 1%;">
                <table id="iconbar">
                    <tr>
                    <td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
                        Collectives</a></td>
                    <td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
                            Discussions</a></td>
                    <td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
                            Documentation</a></td>
                    <td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
                            Download</a></td>
                    <td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
                            Source Browser</a></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                  <span class='current'>Kernel Sockets</span>
          </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
            <a href="/bin/view/Project+kernel%2Dsockets/?language=" class="language-default language-current"></a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
          <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Project+kernel%2Dsockets/WebHome?format=pdf" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+kernel%2Dsockets/WebHome?format=rtf" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+kernel%2Dsockets/WebHome?format=html" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+kernel%2Dsockets/?viewer=code"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Project+kernel%2Dsockets/?viewer=comments" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+kernel%2Dsockets/?viewer=attachments" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+kernel%2Dsockets/?viewer=history" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Project+kernel%2Dsockets/?viewer=information" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Project+kernel%2Dsockets/?viewer=code" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Project+kernel%2Dsockets/?xpage=print" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          <span class="submenuitem "><a href="/bin/view/Project+kernel%2Dsockets/?xpage=copy" id="tmActionCopy" class="tmActionCopy">Copy</a></span>
      </span></div>
</div>

    </div>
    <div id="mainContentArea">
      








    
<div id="document-title"><h1>Kernel Sockets</h1></div>

              <div id="document-info">
    <div>
          </div>
    <div class="clearfloats"></div>
  </div>

<div id="xwikicontent">
<h3 id="HPleaseNote:KernelSocketsisnowpartofProjectVolo"><span>Please Note: Kernel Sockets is now part of Project Volo</span></h3><p>The mercurial gate listed below only contains the original prototype. Please use the Volo gate to obtain the latest release.</p><p>&lt;<span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://www.opensolaris.org/os/project/volo/"><span class="wikigeneratedlinkcontent">http://www.opensolaris.org/os/project/volo/</span></a></span>&gt;</p><h3 id="HIntroduction"><span>Introduction</span></h3><p>The goal of this project is to develop an interface for creating sockets within kernel modules.</p><h3 id="HTryingthingsout"><span>Trying things out</span></h3><h4 id="HGettingthesource"><span>Getting the source</span></h4><p>You can obtain the source code for this project using Mercurial. The repository is:</p><p> &nbsp;&nbsp;&nbsp;&nbsp;<span class="wikiexternallink"><a class="wikimodel-freestanding" href="ssh://anon@hg.opensolaris.org/hg/kernel-sockets/ksocket"><span class="wikigeneratedlinkcontent">ssh://anon@hg.opensolaris.org/hg/kernel-sockets/ksocket</span></a></span></p><p><strong>WARNING</strong></p><p>This is work in progress, and the current interface is <em>not</em> stable, and the code is not fully tested. Therefore, it is <em>very</em> likely that there are bugs, some of which that could cause your system to <strong>crash</strong>.&nbsp;</p><p>A guide on how to use Mercurial is available at:<br/>&lt;<span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://www.opensolaris.org/os/community/tools/scm/hg_help/"><span class="wikigeneratedlinkcontent">http://www.opensolaris.org/os/community/tools/scm/hg_help/</span></a></span>&gt;</p><h4 id="HBuildingthesource"><span>Building the source</span></h4><p>Detailed information on how to build ON is available at &lt;<span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://www.opensolaris.org/os/community/on/devref_toc/"><span class="wikigeneratedlinkcontent">http://www.opensolaris.org/os/community/on/devref_toc/</span></a></span>&gt;</p><p>Use the 20070312 closed bins.</p><h4 id="HUsingKernelSockets"><span>Using Kernel Sockets</span></h4><p>Please read the <span class="wikiexternallink"><a href="https://markebrooks.github.io/bin/download/Project+kernel-sockets/files/kernel-sockets.pdf">design document</a></span> first! Some types have changed, but the document still gives an overview of what to expect from the interface.</p><h5 id="HBasicInterface"><span>Basic Interface</span></h5><p>If you have done some network programming with sockets before, then the kernel socket interface should look very familiar (that was at least the goal!)</p><p>The basic interface is currently composed of the following functions:<br/>&nbsp;&nbsp;&nbsp;&nbsp;</p><table><tr><td>&nbsp;int ksock_socket(ksocket_t *s, int domain, int type, int protocol)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_bind(ksocket_t s, const struct sockaddr *addr, socklen_t addrlen)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_listen(ksocket_t s, int backlog)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_accept(ksocket_t s, ksocket_t <em>ns, struct sockaddr&nbsp;</em>addr, socklen_t *addrlen)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_connect(ksocket_t s, const struct sockaddr *addr, socklen_t addrlen)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_send(ksocket_t s, void <em>msg, size_t msgsize, int flags, size_t&nbsp;</em>sent)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_recv(ksocket_t s, void <em>msg, size_t msgsize, int flags, size_t&nbsp;</em>recvd)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_shutdown(ksocket_t s, int how)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_close(ksocket_t s)&nbsp;</td><td><br/></td></tr><tr><td>int ksock_setsockopt(ksocket_t s, int level, int optname, const void *optval, int optlen)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_getsockopt(ksocket_t s, int level, int optname, void <em>optval, int&nbsp;</em>optlen)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_getpeername(ksocket_t s, struct sockaddr <em>addr, socklen_t&nbsp;</em>addrlen)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_getsockname(ksocket_t s, struct sockaddr <em>addr, socklen_t&nbsp;</em>addrlen)&nbsp;</td><td><br/></td></tr><tr><td>&nbsp;int ksock_ioctl(ksocket_t s, int cmd, intptr_t arg)&nbsp;</td><td></td></tr></table><p>All of the above functions return a result code that indicates whether the operation was successful. If an error was encountered, then the errno is returned, otherwise 0 is returned. Some userland socket functions (e.g., <span class="box code">socket()</span> and <span class="box code">send()</span>) return information other than error/success, and the kernel socket variant of those functions take an additional value-return argument.</p><p>For example, creating a new TCP socket would be done as follows:</p><pre>
    ksocket~_t s;
    int error;
    ...
    if ((error = ksock~_socket(&amp;s, AF~_INET, SOCK~_STREAM, 0)) != 0)
            goto fail;
</pre><p>By default, kernel socket operations are <em>blocking</em>, however, that behavior <br/>can be controlled using <span class="box code">ksock_ioctl()</span> (i.e, <span class="box code">ksock<span style="color: #666666; ">~</span>_ioctl(s, FIONBIO, <span style="color: #666666; ">&amp;</span>onoff)</span>) Similarly, <span class="box code">SIOCATMARK</span> can be used to query about <em>out of band</em> data. However, there are several ioctls that are not allowed, specifically <span class="box code">SIOCSPGRP</span>, <span class="box code">SIOCGPGRP</span> and <span class="box code">FIOASYNC</span>. In addition, no STREAMs specific ioctls are supported (such as <span class="box code">I_POP</span> and <span class="box code">I_PUSH</span>)</p><div class="wikimodel-emptyline"></div><h5 id="HEventNotification"><span>Event Notification</span></h5><p>As mentioned in the previous section, kernel sockets can be made <em>non-blocking</em> by using <span class="box code">ksock_ioctl()</span>, however, there is no <span class="box code">select()</span> or <span class="box code">poll()</span> functions that can be used to determine whether an event has take place. Instead, event notification is done asynchronously via a callback interface.</p><p>There are six events currently defined:</p><pre>
    /*
     \* Callback: connected
     \* Occurs:
     \*     When the socket have reached a connected state.
     \* Arguments:
     \*     s:        kernel socket the event occurred on
     \*     arg:      user supplied argument
     \*/
    typedef void (//ksock~_connected~_callback~_t)(ksocket~_t s, void //arg);  
    /\*
     \* Callback: disconnected
     \* Occurs:
     \*     When the socket have been disconnected.
     \* Arguments:
     \*     s:        kernel socket the event occurred on
     \*     arg:      user supplied argument
     \*     reason:   indication why the socket was disconnected.
     \*               0: Normal shutdown sequence; &gt;0: errno (ie., ECONNRESET);
     \*               &lt;0: Unknown reason
     \*/
    typedef void (//ksock~_disconnected~_callback~_t)(ksocket~_t s, void //arg, int reason);
    /\*
     \* Callback: newconn
     \* Occurs:
     \*     When a new connection has been added to the accept queue.
     \* Arguments:
     \*     s:        kernel socket the event occurred on
     \*     arg:      user supplied argument
     \*/
    typedef void (//ksock~_newconn~_callback~_t)(ksocket~_t s, void //arg);
    /\*
     \* Callback: recv
     \* Occurs:
     \*     When data has arrived or an event has occurred that affects the
     \*     ability to receive data.
     \* Arguments:
     \*     s:        kernel socket the event occurred on
     \*     arg:      user supplied argument
     \*     msglen:   0: end-of-file reached; &gt;0: # bytes received; &lt;0: unknown event
     \*/
    typedef void (//ksock~_recv~_callback~_t)(ksocket~_t s, void //arg, ssize_t msglen);
    /\*
     \* Callback: xmit
     \* Occurs:
     \*     When send buffers have been freed up so that new data can be
     \*     transmitted, or an event has occurred that affects the ability
     \*     to transmit data.
     \* Arguments:
     \*     s:        kernel socket the event occurred on
     \*     arg:      user supplied argument
     \*     freebuf:  0: unable to send more data; &gt;0: # bytes that can be sent
     \*               without blocking; &lt;0: unknown event
     \*/
    typedef void (//ksock~_xmit~_callback~_t)(ksocket~_t s, void //arg, ssize_t freebuf);
    /\*
     \* Callback: exception
     \* Occurs:
     \*     When there is an exception event (i.e. TCP urgent data has arrived)
     \* Arguments:
     \*     s:        kernel socket the event occurred on
     \*     arg:      user supplied argument
     \*     msglen:   transport specific event
     \*/
    typedef void (//ksock~_exception~_callback~_t)(ksocket~_t s, void //arg, uint32_t event);
</pre><p>Enabling callbacks for a specific socket would be done as follows:</p><pre>
    #include &lt;sys/ksocket.h&gt;
    ...
    ksock~_callbacks~_t xxx~_callbacks = {
        xxx~_connected,
        xxx~_disconnected,
        xxx~_newconn,
        xxx~_recv,
        xxx~_xmit,
        xxx~_exception
    };
    ...
    void foo(void)
    {
        ksocket~_t s;
        xxx~_data~_t *dp;        
        ...
        ksock~_callbacks(s, &amp;xxx~_callbacks, dp);
        ...
    }
</pre><p>It is not required to have a callback for each event, leaving it as NULL will<br/>disable the specific event. Also, disabling callbacks is done by passing in NULL to <span class="box code">ksock_callbacks()</span>. Callbacks will automatically be disabled when a socket is being closed (i.e., by using <span class="box code">ksock_close()</span>).</p><p>The amount of work done in a callback function should be <em>limited</em>, and it is specifically <em>not</em> allowed to use kernel socket functions. If heavy processing is needed, or if kernel socket functions need to be called (e.g., <span class="box code">ksock_recv()</span>), then another thread should be dispatched.</p>
</div>


    <div class="clearfloats"></div>
  </div>      <div id="xdocFooter">
  
                

       <div class="doc-tags" id="xdocTags">
        Tags:
        </div>
  
  <div id="xdocAuthors">
    <div class="xdocCreation">       Created by  on 2009/10/26 11:41<br/>
          </div>
    <div class="xdocLastModification">       Last modified by admin on 2009/10/26 12:14
    </div>
  </div>
</div>
<div id="xwikidata" class="layoutsubsection">
        </div>  
    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Project kernel-sockets Pages</h1>
<div class="xwikipanelcontents">
                                 <span class="wikilink"><a href="#">Kernel Sockets</a></span>
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Project+kernel%2Dsockets/files">Files</a></span></li>
</ul>
                    </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2011, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
