<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>smf(5) FAQ (Community Group smf.faq) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Community+Group+smf/faq" />
                    <link rel="canonical" href="/bin/view/Community+Group+smf/faq" />
                            <meta name="document" content="Community Group smf.faq"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Community Group smf"/>
    <meta name="page" content="faq"/>
    <meta name="version" content="2.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Community+Group+smf/pages/faq"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="smf(5) FAQ" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="Liane Praza" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Community Group smf";
XWiki.currentPage = "faq";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Community+Group+smf/faq";
window.docediturl = "/bin/edit/Community+Group+smf/faq";
window.docsaveurl = "/bin/save/Community+Group+smf/faq";
window.docgeturl = "/bin/get/Community+Group+smf/faq";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Community_Group_smf viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FCommunity%2BGroup%2Bsmf%2Ffaq"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+smf/"><strong>Community Group smf</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Community+Group+smf" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <div id="header_banner">
	<table style="width: 100%;">
	    <tr>
		<td style="width: 1%;">
		    <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>  
		</td>
		<td id="logo-text" style="width: 1%;">
		    Solaris
		</td>         
		<td style="width: 98%;">
		    <table id="loading-indicator">
			<tr>
			    <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
				    alt="Loading" title="Loading"/></td>
			    <td>Loading...</td>
			</tr>
		    </table>
		</td>
		<td style="width: 1%;">
		    <table id="iconbar">
			<tr>
			<td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
			    Collectives</a></td>
			<td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
				Discussions</a></td>
			<td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
				Documentation</a></td>
			<td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
				Download</a></td>
			<td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
				Source Browser</a></td>
			</tr>
		    </table>
		</td>
	    </tr>
	</table>
    </div>
    <div id="site-notice">
	<span>
	    <a href="https://markebrooks.github.io/bin/view/Main/">ATTENTION: This website and all services within the opensolaris.org domain will be unavailable after March 24, 2013.</a>	   
	</span>
    </div>
</div>
 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                  <span class='current'>smf(5) FAQ</span>
          </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
        <a href="/bin/view/Community+Group+smf/faq?language=en" class="language-default language-current">en</a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
          <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Community+Group+smf/faq?format=pdf&amp;language=en" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+smf/faq?format=rtf&amp;language=en" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+smf/faq?format=html&amp;language=en" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+smf/faq?viewer=code&amp;language=en"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Community+Group+smf/faq?viewer=comments&amp;language=en" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+smf/faq?viewer=attachments&amp;language=en" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+smf/faq?viewer=history&amp;language=en" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+smf/faq?viewer=information&amp;language=en" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+smf/faq?viewer=code&amp;language=en" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Community+Group+smf/faq?xpage=print&amp;language=en" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          </span></div>
</div>

    </div>
    <div id="mainContentArea">
      








    
<div id="document-title"><h1>smf(5) FAQ</h1></div>





              <div id="document-info">
    <div>
          </div>
    <div class="clearfloats"></div>
  </div>

<div id="xwikicontent">
<h1 id="Hsmf28529FrequentlyAskedQuestions"><span>smf(5) Frequently Asked Questions</span></h1><p>Table of Contents</p><p><strong>JavaScript must be enabled in your browser to display the table of contents.</strong></p><pre>
                Welcome to the smf(5) community FAQ!

This Q&amp;A is divided into four sections:  General for general description
of how SMF works and further clarification of official documentation;
Administrative for how-to questions; Troubleshooting, and Writing SMF
Manifests.  The information on manifest writing covers such a broad range
of topics that it merits a section of its own.
</pre><h2 id="H1.GeneralSection:generaldescriptionsofhowsmf28529works"><span>1. General Section: general descriptions of how smf(5) works</span></h2><h3 id="H1.1.ShortlistingofSMFfilesanddirectories"><span>1.1. Short listing of SMF files and directories</span></h3><ul><li>/var/svc: logs, manifests, profiles</li><li>/lib/svc: methods, seed repository, restore_repository script</li><li>/etc/svc: repository.db, repository backups, volatile (a tmpfs)</li></ul><p>/var/svc/manifest/site is reserved for manifests specific to your site.</p><h3 id="H1.2.ShortlistingofSMFcommands"><span>1.2. Short listing of SMF commands</span></h3><ul><li>svcs(1): service status listing</li><li>svcadm(1M): administrative actions</li><li>svccfg(1M): property modification, can be batch or interactive mode</li><li>svcprop(1): property reporting, suitable for scripting</li><li>inetadm(1M):administrative and property modification for inetd services</li><li>inetconv(1M): convert legacy inetd.conf entries to SMF manifest and service</li></ul><h3 id="H1.3.ShortlistingofrelevantSMFmanpages"><span>1.3. Short listing of relevant SMF man pages</span></h3><p>smf(5), svcs(1), svcadm(1M), svccfg(1M), svcprop(1), svc.startd(1M),svc.configd(1M), smf_security(5), smf_bootstrap(5), smf_method(5), smf_restarter(5), service_bundle(4), inetconv(1M), inetadm(1M), inetd(1M)</p><h3 id="H1.4.Howpermanentissvcadm281M293F"><span>1.4. How permanent is svcadm(1M)?</span></h3><p>Unless the "-t" option is used, svcadm(1M) enable/disable is persistent through reboots, patches, and upgrades. The "-t" option indicates that this specified state is good only until the next reboot.</p><h3 id="H1.5.Aremilestonesthesameasrunlevels3F"><span>1.5. Are milestones the same as run levels?</span></h3><p>A milestone is a new mechanism made to be compatible with run-levels. Milestones define a specific state of system readiness, each with a specific set of services enabled. Before smf(5), system boot progresses from run level S to 3, executing scripts in /etc/rc?.d &nbsp;along the way. With smf(5), system boot does not progress from milestone to milestone, the dependency determines the order of service start.</p><p>Except for none, and all, milestones show up as services in SMF. However, the system can only be in one of the following milestones at any time:</p><p>none, single-user, multi-user, multi-user-server, all</p><p>Regardless of the state of milestone/* as shown by "svcs -a". For the system's current milestone, check the options_ovr/milestone property of svc:/system/svc/restarter:default</p><pre>
# svcprop -p options_ovr/milestone restarter:default
</pre><p>If this command returns the following error:</p><pre>
svcprop: Couldn't find property 'options_ovr/milestone'
for instance 'svc:/system/svc/restarter:default'.
</pre><p>then the system is in its default milestone.</p><p>To view the system's default milestone, see question <span class="wikilink"><a href="#ADMN13">2.13</a></span>.</p><p>Other milestones exist to declare that some set of services are ready. They are available for use as dependencies. For example, if milestone/devices is online, it indicates that device/fc-fabric and device/local have finished. Use "svcs -d &lt;milestone&gt;" to list the dependencies for the milestone.</p><h3 id="H1.6.Wheredidtheoutputofthercscriptsgo3F"><span>1.6. Where did the output of the rc scripts go?</span></h3><p>rc scripts are now started in the analogous milestone, and all outputs from them during boot are logged to the milestone service's log file in /var/svc/log. For example, scripts in /etc/rc3.d are run in milestone multi-user-server, invoked by start method /sbin/rc3. The output of those scripts go to /var/svc/log/milestone-multi-user-server:default.log.</p><ul><li>svc:/milestone/single-user:default starts /etc/rcS.d</li><li>svc:/milestone/multi-user:default starts /etc/rc2.d</li><li>svc:/milestone/multi-user-server:default starts /etc/rc3.d</li></ul><h3 id="H1.7.WhenIrunsvcs-a2CIseeacolumnlabeledSTIME.Doesthatmean22StartTime223F"><span>1.7. When I run svcs -a, I see a column labeled STIME. Does that mean "Start Time"?</span></h3><p>STIME stands for "State Time", the time when the service entered that state. It is precise to the sub-second, although only the second is printed. "svcs -a" lists services in the order that they finished starting. STIME is not authoritative, svcadm(1M) refresh will update it. To find out when a service was started, you have to look at the log.</p><h3 id="H1.8.IsSMFintegratedwithFMA3F"><span>1.8. Is SMF integrated with FMA?</span></h3><p>No. In particular, the smf(5) doesn't send any telemetry to fmd(1M).</p><h3 id="H1.9.CanImakemyservicedependonazone3F"><span>1.9. Can I make my service depend on a zone?</span></h3><p>No, smf(5) doesn't have the mechanism to support dependencies on zones.</p><h3 id="H1.10.Whyis22Importingservicedescriptions202622soslow3F"><span>1.10. Why is "Importing service descriptions…" so slow?</span></h3><p>It's serial and does a lot of syncing (to guard against power failure, etc). We're working on it (see <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6351623">CR 6351623</a></span>).</p><h3 id="H1.11.svcs28129showsmeaservicestatewithan2Anexttoit2Cforexample2Conline2A2Cwhatdoesitmean3F"><span>1.11. svcs(1) shows me a service state with an * next to it, for example, online*, what does it mean?</span></h3><p>It means the service is still in transition, use "svcs -v" to see the next state.</p><h3 id="H1.12.WhereareSMFlogs3FDoIneedtorotatethem3F"><span>1.12. Where are SMF logs? Do I need to rotate them?</span></h3><p>svc.startd stores log files in the /etc/svc/volatile directory in early stages of boot, before /var is mounted read-write.</p><p>SMF logs are kept in /var/svc/log. For service log files, invoke</p><pre>
# svcs -x &lt;service&gt;
</pre><p>This does not work for disabled services. You don't need to rotate SMF logs, it's already managed by logadm(1M), see /etc/logadm.conf. Output from the /etc/rc.?/* legacy scripts are collected in the appropriate /var/svc/log/milestone-* file.</p><h3 id="H1.13.IsthereadditionalSMFdocumentation2Cinadditiontoexistingmanpages3F"><span>1.13. Is there additional SMF documentation, in addition to existing man pages?</span></h3><ul><li><span class="wikiexternallink"><a href="http://www.sun.com/bigadmin/content/selfheal/">BigAdmin SMF site</a></span></li><li><span class="wikilink"><a href="/bin/view/Community+Group+smf/">OpenSolaris SMF site</a></span></li><li><span class="wikiexternallink"><a href="http://www.opensolaris.org/jive/forum.jspa?forumID=24">OpenSolaris SMF Community Discussions</a></span></li><li><span class="wikilink"><a href="/bin/view/Community+Group+smf/manifests">Ready-made SMF manifests</a></span></li><li><span class="wikiexternallink"><a href="http://docs.sun.com/app/docs/doc/817-1985/6mhm8o5rq?q=817-1985&amp;a=view">System Administration Guide</a></span></li><li><span class="wikilink"><a href="/bin/view/Community+Group+smf/faq">SMF FAQ</a></span></li></ul><h2 id="H2.AdministrativeSection:administrative22howto202622questions"><span>2. Administrative Section: administrative "how to…" questions</span></h2><h3 id="H2.1.HowcanIallowuserXtocontrolserviceY3F"><span>2.1. How can I allow user X to control service Y?</span></h3><p>SMF uses RBAC to delegate service management responsibility. The following properties can be set:</p><p>action_authorization: can execute method; allows you to do:</p><ul><li>svcadm [enable | disable] -t</li><li>svcadm refresh</li><li>svcadm restart</li><li>svcadm mark maintenance</li><li>svcadm clear</li></ul><p>value_authorization: can change values of existing property. It allows you to permanently enable or disable a service because you are changing the general/enabled property of the service.</p><p>modify_authorization: can change, add, or delete properties.</p><p>See /var/svc/manifest/network/ssh.xml for an example.</p><p>The value of these properties, a string, must be added to a user security attributed in /etc/user_attr. Here's how to allow user jdoe to enable/disable ssh:</p><p>/var/svc/manifest/network/ssh.xml:</p><pre>
        &lt;property_group name='general' type='framework'&gt;
                &lt;!~-- to start stop sshd ~--&gt;
                &lt;propval name='action_authorization' type='astring'
                                value='solaris.smf.manage.ssh' /&gt;
                &lt;propval name='value_authorization' type='astring'
                                value='solaris.smf.manage.ssh' /&gt;
        &lt;/property_group&gt;

        /etc/user_attr:
                jdoe::::auths=solaris.smf.manage.ssh
</pre><p>The string solaris.smf.manage.ssh can be any arbitrary string, but solaris.smf.manage.ssh is more descriptive than, say, "fooblat".</p><p>To see the auction_authorization authorizations for a service, run:</p><pre>
# svcprop -p general/action_authorization
</pre><p>If the service has none, you can add one with svccfg(1M)</p><pre>
# svccfg -s &lt;FMRI&gt; setprop general/action_authorization = astring: \
"solaris.smf.manage.service"
# svcadm refresh &lt;FMRI&gt;
</pre><p>To allow a user to change the properties in a certain property group, give the user value_authorization. To allow the user to modify, add or remove the properties in a certain property group, give them modify_authorization.</p><p>To allow a user to do manage any service, give him solaris.smf.manage. To give a user full control over the repository, give him solaris.smf.modify.</p><p>Give a user authorization by modifying /etc/user_attr</p><pre>
# echo "jdoe::::auths=solaris.smf.manage.service" &gt;&gt; /etc/user_attr
</pre><p>You can see a user's authorizations with "auths jdoe".</p><h3 id="H2.2.HowdoIaddadependencytoanexistingservice3F"><span>2.2. How do I add a dependency to an existing service?</span></h3><p>By using svccfg(1M), let's say that you want to add a filesystem/local dependency to a service:</p><pre>
# svccfg -s &lt;FMRI&gt;
&gt; addpg myfs-local dependency  &lt;~-- "myfs-local" is the descriptive name
&gt; setprop myfs-local/grouping = astring: "require_all"
&gt; setprop myfs-local/restart_on = astring: "none"
&gt; setprop myfs-local/type = astring: "service"
&gt; setprop myfs-local/entities = fmri: "svc:/system/filesystem/local"
&gt; exit
# svcadm refresh &lt;FMRI&gt;
</pre><p>If you've made a mistake, invoke editprop, which will launch the $EDITOR, or vi if $EDITOR is not set. Find your mistake, correct it, and uncomment the hash at the beginning of the command. After saving and quitting the $EDITOR, the command you've uncommented is executed.</p><p>Note that svccfg import employs a syntax checker to validate your XML manifest. Interactive svccfg does no such validating and will allow you to make a mistake that would have been caught by svccfg import.</p><h3 id="H2.3.Whycan27tIjustmodifymyFMRImanifestandaddthefollowing2026"><span>2.3. Why can't I just modify my FMRI manifest and add the following…</span></h3><pre>
        &lt;dependency name='myfs-local'
                grouping='require_all'
                restart_on='none'
                type='service'&gt;
                &lt;service_fmri value='svc:/system/filesystem/local' /&gt;
        &lt;/dependency&gt;
</pre><p>Never modify manifests in place. This can't be stressed enough. Always use svccfg to modify or customize a service. SMF detects customizations by comparing current property values with those from the last manifest imported. If your customizations are in a manifest, then SMF will think that you have no customizations. In a future patch or upgrade, SMF may drop in a new manifest and erase all the customizations you've added in the manifest.</p><h3 id="H2.4.HowdoIbackuptherepository3F"><span>2.4. How do I back up the repository?</span></h3><p>Currently the ability to take repository backup at will does not exist. 4 backup copies are taken automatically and kept in /etc/svc. You can make copies of /etc/svc/repository.db but there is a risk that such a copy won't be self-consistent if svc.configd(1M) makes a change during the copy.</p><h3 id="H2.5.HowdoItakeasnapshotofaservice27sconfiguration3F"><span>2.5. How do I take a snapshot of a service's configuration?</span></h3><p>Currently you can't take snapshots at will. There is an RFE filed to make this possible, see <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6199307">CR 6199307</a></span>. You can use svccfg export &lt;service&gt; to get an XML file describing the currently running service.</p><h3 id="H2.6.Whydoesn27t22svccfgexportapache222work3F"><span>2.6. Why doesn't "svccfg export apache2" work?</span></h3><p>svccfg(1M) only exports services. In /network/http:apache2, network is the functional category, http is the service, apache2 is the instance. You can export the service using svccfg export http, the exported manifest will include the instance. Work is underway to enable svccfg to export instances, see <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6299665">CR 6299665</a></span>.</p><h3 id="H2.7.HowdoIfigureoutwhodisabledthisservice3F"><span>2.7. How do I figure out who disabled this service?</span></h3><p>Currently smf(5) does not track who does what.</p><h3 id="H2.8.HowdoImakeSMFsendmeanemailwhenaservicechangesstate3F"><span>2.8. How do I make SMF send me an email when a service changes state?</span></h3><p>That level of functionality does not currently exist as of yet.</p><h3 id="H2.9.HowcanItakeasnapshotofalloftheservicesonmysystem2CsoIcancheckforchangeslater3F"><span>2.9. How can I take a snapshot of all of the services on my system, so I can check for changes later?</span></h3><p>There is no ability to take snapshots at will yet. <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6199307">CR 6199307</a></span> has been filed to allow snapshot-at-will, and <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6389280">CR 6389280</a></span> has been filed to allow users to compare snapshots. The alternative is to use svccfg(1M) export to output service properties in XML files and compare those, or svccfg archive to get a full service description for all services in one XML file. Also see <span class="wikilink"><a href="#ADMN5">question 2.5</a></span>.</p><h3 id="H2.10.Iaminmilestonesingle-userforsomediagnostic3BIwanttoenablesomeservicebutcan27t."><span>2.10. I am in milestone single-user for some diagnostic; I want to enable some service but can't.</span></h3><p>This is propably due to your repository not mounted as writeable, you can check this by looking at the output of mount(1M) and check the writeability of the root filesystem.</p><p>You can get around this problem by using svcadm enable -t to temporarily enable the service. Better yet, use svcadm enable -rt to also enable all your service's dependencies all at once.</p><h3 id="H2.11.HowdoIturnonverboselogging3F"><span>2.11. How do I turn on verbose logging?</span></h3><p>Set the options/logging property of the restarter:</p><pre>
# svccfg -s /system/svc/restarter:default
&gt; addpg options application
&gt; setprop options/logging = astring: "verbose"
&gt; setprop options/type = astring: "framework"
&gt; exit
# svcadm refresh /system/svc/restarter:default
</pre><p>Also see <span class="wikilink"><a href="#TRBL5">question 3.5</a></span> for use of boot -m verbose.</p><h3 id="H2.12.HowdoIdeleteaservice3F"><span>2.12. How do I delete a service?</span></h3><p>Use svccfg delete. This will fail if the service is running. In that case, either disable the service with svcadm(1M), or use svccfg delete -f. Remove the service manifest. This last step is to avoid SMF re-enabling the service in case of a seed repository recovery when SMF re-imports manifests.</p><p><em>Warning</em>: Delete services at your own risk. You might inadvertently upset a milestone or another service which depends on the service you just deleted, and the effect might not be immediately noticeable.</p><h3 id="H2.13.HowdoIfindoutwhatismysystem27sdefaultmilestone3F"><span>2.13. How do I find out what is my system's default milestone?</span></h3><pre>
# svcprop -p options/milestone restarter:default
</pre><p>If this property does not exist, that is, you get the following error:</p><pre>
svcprop: Couldn't find property `options/milestone'
for instance `svc:/system/svc/restarter:default'.
</pre><p>then the system's default milestone is all.</p><p>The difference between the properties options/milestone and options_ovr/milestone is that the former records your default boot milestone if you have changed it since last boot. The latter records your current milestone if you've used svcadm to transition to another milestone since last boot. Your current milestone and your default boot milestone are not necessarily the same. The system always returns to its default milestone every time it boots.</p><p>If options/milestone does not exist, the default milestone is all.</p><p>If options_ovr/milestone does not exist, the current milestone is the default milestone.</p><h3 id="H2.14.HowdoIleavemycurrentmilestone3F"><span>2.14. How do I leave my current milestone?</span></h3><p>If you want to change run-level, use /sbin/init. Milestones are compatible with run-levels, but are not run-levels. See <span class="wikilink"><a href="#GEN5">Question 1.5</a></span>. Changing the system's milestone does not change its run level.</p><p>If you've used svcadm milestone or boot -m milestone= to get to where you are now, you can use:</p><pre>
# svcadm milestone &lt;new milestone&gt;
</pre><p>to go to a new milestone.</p><h3 id="H2.15.HowdoIcreatemyownmilestone3F"><span>2.15. How do I create my own milestone?</span></h3><p>You can't create milestones that you can boot to. The milestones which svcadm milestone accepts are hardcoded into svcadm(1M) and svc.startd(1M). See <span class="wikilink"><a href="#GEN5">question 1.5</a></span> for the milestones that the system can be in.</p><p>You can create a milestone to declare that a set of services is ready. Services which have milestone in their name are treated like any other services.</p><h3 id="H2.16.HowdoIfindoutwhichprocessesareassociatedwithaservice3F"><span>2.16. How do I find out which processes are associated with a service?</span></h3><pre>
# svcs -p
# svcs -pv
</pre><p>The latter will also return contract IDs.</p><h3 id="H2.17.HowdoIfindoutwhichserviceisassociatedwithaprocess3F"><span>2.17. How do I find out which service is associated with a process?</span></h3><pre>
# ps -e -o ctid,args | grep &lt;process_name&gt;
# svcs -o ctid,fmri | grep &lt;pid_found_with_previous_command&gt;
</pre><h3 id="H2.18.HowdoIseetheprocessprivilegesetformyservice3F"><span>2.18. How do I see the process privilege set for my service?</span></h3><p>Find a process associated with your service, and use</p><pre>
# ppriv -S &lt;PID&gt;
</pre><h3 id="H2.19.HowdoIassignmyservicetoruninaproject3F"><span>2.19. How do I assign my service to run in a project?</span></h3><p>See the work-around for <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6517270">CR 6517270</a></span>:</p><p>Specify all required properties directly. In this example, we're trying to have the smtp:sendmail service start in the sendmail(1M) project.</p><p>First, check if the property you're trying to set is already defined for the service:</p><pre>
# svcprop -p start/project &lt;FMRI&gt;
</pre><p>If this property is set to a value (like :default), do the following to change the project:</p><pre>
# svccfg -s &lt;fmri&gt; setprop start/project = sendmail
# svcadm refresh sendmail; svcadm restart sendmail
</pre><p>If it isn't set, specify all required properties.</p><pre>
# svccfg -s sendmail setprop start/project = astring: sendmail
# svccfg -s sendmail setprop start/user = astring: root
# svccfg -s sendmail setprop start/group = astring: :default
# svccfg -s sendmail setprop start/working_directory = astring: :default
# svccfg -s sendmail setprop start/resource_pool = astring: :default
# svccfg -s sendmail setprop start/supp_groups = astring: :default
# svccfg -s sendmail setprop start/privileges = astring: :default
# svccfg -s sendmail setprop start/limit_privileges = astring: :default
# svccfg -s sendmail setprop start/use_profile = boolean: false
# svcadm refresh sendmail; svcadm restart sendmail
</pre><p>See <span class="wikilink"><a href="#MNFST9">question 4.9</a></span> on how to create a +method_context+1 block in a manifest. See <span class="wikilink"><a href="#MNFST10">question 4.10</a></span> on how to assign a service to a project in a manifest.</p><h3 id="H2.20.HowdoIsetenvironmentvariablesformyservice3F"><span>2.20. How do I set environment variables for my service?</span></h3><p>Set one variable:</p><pre>
# svccfg -s &lt;service name&gt; setenv -m &lt;method name&gt; MYVAR value
</pre><p>Set one variable to multiple values:</p><pre>
# svccfg -s &lt;service name&gt; setenv -m &lt;method name&gt; MYVAR "val1 val2"
</pre><p>Set multiple variables:</p><pre>
# svccfg -s &lt;service name&gt; setenv -m &lt;method name&gt; MYVAR1 val1
# svccfg -s &lt;service name&gt; setenv -m &lt;method name&gt; MYVAR2 val2
</pre><p>&lt;method name&gt; can be start, stop, or refresh. Use unsetenv to unset variables. Refresh the service to commit the changes.</p><h2 id="H3.TroubleshootingSection"><span>3. Troubleshooting Section</span></h2><h3 id="H3.1.Whydoessvcs-xreportprint2Fserverafterafreshinstall3F"><span>3.1. Why does svcs -x report print/server after a fresh install?</span></h3><p>Services which depend on svc:/application/print/server:default are delivered as enabled, but svc:/application/print/server:default is delivered as disabled. This results in the dependent services being placed in the offline state, which svcs -x reports as an error.</p><h3 id="H3.2.22svc:2Fapplication2Fprint2Fserver:default22actuallyhas3dependents.Despiteitbeingdisabled2Conlytwodependentsareoffline2Conedependent28milestone2Fmulti-user29isactuallyonline.Howisthispossible3F"><span>3.2. "svc:/application/print/server:default" actually has 3 dependents. Despite it being disabled, only two dependents are offline, one dependent (milestone/multi-user) is actually online. How is this possible?</span></h3><p>There are 4 types of dependencies. One may think of them in terms of gradient, how much does a service need from a dependency before it considers that dependency satisfied. The relationship print/server has with milestone/multi-user is of type optional_all. This means that print/server can be in the disabled state and still allow milestone/multi-server to run. The relationship print/server has with the other 2 services are of type require_any and require_all, which are satisfied when print/server is online or degraded.</p><h3 id="H3.3.Whyissvc.configd281M29takingupalotofmemory3F"><span>3.3. Why is svc.configd(1M) taking up a lot of memory?</span></h3><p>You may be running into:</p><pre>
CR 6304200: svc.configd(1M) becomes a heavyweight, weighing in at 500MB
The workaround is to kill svc.configd, svc.startd(1M) will start a new
one.  This is fixed in patch 118833-36.
</pre><h3 id="H3.4.Whyissvc.configd281M29takingupalotofCPU3F"><span>3.4. Why is svc.configd(1M) taking up a lot of CPU?</span></h3><p>You may be running into</p><pre>
CR 6237669: _check_services() SMF logic causing svc.configd overwork.
If you are frequently mounting NFS filesystems, every mount is causing
SMF to unnecessarily refresh a set of related services and to consume
a lot of CPU doing so.  This is fixed in patch 118833-36.
</pre><p>svc.configd(1M) only does work for its clients, and svc.startd(1M) is its biggest client. If this is not the bug you are running into, check svc.startd.</p><h3 id="H3.5.Mysystemhangsduringboot.WhatshouldIdo3F"><span>3.5. My system hangs during boot. What should I do?</span></h3><p>You can observe service start messages during boot by using boot -m verbose. For a system that hangs during boot, boot to milestone none, login and bring the system to milestone all, watch to see where your system hangs.</p><pre>
ok&gt; boot -m verbose, milestone=none
(login)
# svcadm milestone all
</pre><h3 id="H3.6.Iscrewedupmyservice.WhatshouldIdo3F"><span>3.6. I screwed up my service. What should I do?</span></h3><p>If a single service is broken, first run svcs -x &lt;FMRI&gt;, this may tell you what has gone wrong. Check the log files in /var/svc/log/service-name.log.</p><p>SMF keeps a snapshot of the last time your service successfully started. As a last resort, you can roll back to that snapshot.</p><pre>
# svccfg -s service:instance
&gt; selectsnap start
&gt; revert
&gt; exit
# svcadm refresh service:instance
</pre><h3 id="H3.7.IscrewedupmyrepositorysobadIcan27tevenbootthesystemtorestoreanoldrepositorybackup.WhatdoIdo3F"><span>3.7. I screwed up my repository so bad I can't even boot the system to restore an old repository backup. What do I do?</span></h3><p>If neither boot -s nor boot -m milestone=none provides a shell for you, then you'll have to boot net or boot from a CD. Then mount the root filesystem and run</p><pre>
# /lib/svc/bin/restore_repository -r /path/to/root
</pre><h3 id="H3.8.svcs-xsaysserviceYwas22disabledbyanadministrator222CbutIdidn27tdisableit."><span>3.8. svcs -x says service Y was "disabled by an administrator", but I didn't disable it.</span></h3><p>SMF does not record who does what, it assumes that the service was disabled by an administrator. Incidentally, you only see this when using svcs -x &lt;FMRI&gt;, invocations of svcs(1) or with the -l or -v option will just show the the state as being disabled.</p><h3 id="H3.9.WhenIset7Bnis2Fclient2Cnis2Fserver7Dtobeenabledinsite.xml2Cwhyisitnotenabledafterinstall3F"><span>3.9. When I set {nis/client, nis/server} to be enabled in site.xml, why is it not enabled after install?</span></h3><p>If you installed your system using jumpstart, the first time your system boots, site.xml is applied and then /lib/svc/method/sysidtool-system resets the name service according to the sysidcfg(4) file, disables {nis/client, nis/server} and undoes what site.xml has done. This is a bug, see <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=6421535">CR 6421535</a></span>.</p><p>To get around this, create another service that depends on sysidtool-system which re-applies site.xml.</p><h3 id="H3.10.Whyhasn27tmyservicestartedeventhoughthefile:dependencyisnowfulfilled3F"><span>3.10. Why hasn't my service started even though the file: dependency is now fulfilled?</span></h3><p>There is no file event to signal SMF that a file has come online. If SMF tries to start your service and finds that a file: dependency is not satisfied, it continues to think so forever. See <span class="wikiexternallink"><a href="http://bugs.opensolaris.org/view_bug.do?bug_id=5106165">CR 5106165</a></span>.</p><p>The workaround is to run svcadm refresh. If the file is on a remote filesystem, make sure your manifest includes the appropriate filesystem dependency to allow your service to find the files it needs before it starts.</p><h3 id="H3.11.Whyisnetwork2Fphysicalinmaintenance3F"><span>3.11. Why is network/physical in maintenance?</span></h3><p>One possible reason is that you may have aliased your hostname to 127.0.0.1, the loopback address, and then used that hostname in your /etc/hostname.interface file.</p><h3 id="H3.12.Whydoesn27tsvcs-xknowwhymy2Fsystem2Fconsole-loginisintheofflinestate3F"><span>3.12. Why doesn't svcs -x know why my /system/console-login is in the offline state?</span></h3><p>If you boot to milestone none and from there go to milestone all (see <span class="wikilink"><a href="#TRBL5">question 3.5</a></span>) without exiting the sulogin shell, svc.startd(1M) keeps console-login in the offline state. svcs -x sees that all of console-login's dependencies are satisfied, and can't figure out why console-login is offline. Your system is fine. svc.startd(1M) will notice when you've logged out of your sulogin shell and will start console-login properly after that.</p><p>In another situation, if you have a file: dependency which was not satisfied when your service start, but the file is present when you run svcs -x, SMF reports that it can't determine the reason why your service is offline. You should refresh your service (see <span class="wikilink"><a href="#TRBL9">question 3.9</a></span>).</p><h3 id="H3.13.IjustjumpstartedasystemandIgetthismessageafteritboots"><span>3.13. I just jumpstarted a system and I get this message after it boots</span></h3><pre>
svc:/milestone/multi-user-server:default
(multi-user plus exports milestone)
State: offline since Wed Feb 08 11:44:58 2006
Reason: Dependency svc:/system/install is absent.
</pre><p>However, I can't find svc:/system/install anywhere.</p><p>system/install is an service that gets added to the repository after the install is complete, but before the reboot. This service is not needed if you build your system using jumpstart, and it is removed before the reboot. If your finish script has a reboot call, and your system reboots before SMF has a chance to completely remove system/install, you will get this.</p><p>Don't call reboot in your jumpstart finish script. To fix, use svccfg(1M) to remove the dependency from multi-user-server milestone.</p><pre>
# svccfg -s multi-user-server listpg
</pre><p>Find the dependency name for svc:/system/install, and delete it.</p><pre>
# svccfg -s multi-user-server delpg
</pre><h2 id="H4.WritingSMFManifestsSection"><span>4. Writing SMF Manifests Section</span></h2><h3 id="H4.1.HowdoIwriteanSMFmanifest3F"><span>4.1. How do I write an SMF manifest?</span></h3><p>The same way you write an rc script: start with Sun-delivered manifests as examples. Copy and cut and paste as you need.</p><p>Manifests you can use as examples:</p><ul><li>/var/svc/manifest/system/utmp.xml for a simple standalone daemon</li><li>/var/svc/manifest/system/coreadm.xml for a service which run once at boot</li><li>/var/svc/manifest/network/telnet.xml for an inetd-managed service</li><li>/var/svc/manifest/network/http-apache2.xml for a service with dependencies</li><li>/var/svc/manifest/network/ssh.xml for a service which uses RBAC authorization</li></ul><p>The DTD - Document Type Definition, is /usr/share/lib/xml/dtd/service_bundle.dtd.1, and is defined at the top of each manifest. You need at least 3 things: the service name, the start and stop method, and dependencies.</p><p>The Service Developer Introduction is very helpful, you can find <span class="wikiexternallink"><a href="http://www.sun.com/bigadmin/content/selfheal/sdev_intro.html">here</a></span>.</p><p>The collection of manifest written by the SMF user community is available on the opensolaris.org "SMF Methods and Manifests" site, located <span class="wikilink"><a href="/bin/view/Community+Group+smf/manifests">here</a></span>.</p><h3 id="H4.2.HowdoIcheckmymanifestforsyntaxerror3F"><span>4.2. How do I check my manifest for syntax error?</span></h3><p>svccfg import has a built-in validator, and won't import your manifest if it has errors. Use svccfg validate &lt;XML file&gt; to check your syntax without importing the file. You can also use xmllint(1M):</p><pre>
# xmllint ~--valid &lt;XML file&gt;
</pre><h3 id="H4.3.WhichfilesystemserviceshouldIdependon3F"><span>4.3. Which filesystem service should I depend on?</span></h3><p>You should at least depend on, directly or indirectly, filesystem/minimal. If your service requires one or more files, then you should also depend, directly or indirectly, on the filesystem service that will make that file available before your service starts.</p><pre>
svcs:/system/filesystem/root /usr is mounted
svcs:/system/filesystem/usr / and /usr are read-write
svcs:/system/filesystem/minimal /var, /var/adm, /var/run, and /tmp tmp are mounted
svcs:/system/filesystem/local all other filesystems are mounted
</pre><h3 id="H4.4.WhatdoIneedinmymanifestinorderdelegateserviceadministrationtoauser3F"><span>4.4. What do I need in my manifest in order delegate service administration to a user?</span></h3><p>See <span class="wikilink"><a href="#ADMN1">question 2.1</a></span> You need:</p><pre>
&lt;property_group name='general' type='framework'&gt;
        &lt;propval name='action_authorization' type='astring'
                        value='solaris.smf.manage.service' /&gt;
        &lt;propval name='value_authorization' type='astring'
                        value='solaris.smf.manage.service' /&gt;
&lt;/property_group&gt;
</pre><p>modify_authorization are typically given per-property group, instead of in the general property group.</p><p>Don't forget to modify /etc/user_attr to add the value string to the user security profile:</p><pre>
/etc/user_attr:
        jdoe::::auths=solaris.smf.manage.ssh
</pre><h3 id="H4.5.WhatdoIneedinmymanifesttokeepmyservicefromrestartingeverytimeitcoredumpsorachildprocessexits3F2A"><span>4.5. What do I need in my manifest to keep my service from restarting every time it core dumps or a child process exits?*</span></h3><p>By default, SMF interprets a core dump or an external signal sent to a service as an error and tries to restart the service. To instruct SMF to ignore these conditions, add the following to your manifest:</p><pre>
&lt;property_group name='startd' type='framework'&gt;
        &lt;propval name='ignore_error' type='astring'
                value='core,signal' /&gt;
&lt;/property_group&gt;
</pre><h3 id="H4.6.Whataremethodtokensandhowaretheyused3F"><span>4.6. What are method tokens and how are they used?</span></h3><p>They are placeholder for service values, and are replaced with their values by the svc.startd(1M) daemon. They can only be used as parameter for method calls (start, stop, or refresh). Method tokens are not supported by the delegated restarter inetd.</p><p>svc.startd(1M) supports the following method tokens:</p><pre>
% %%
%r Name of the restarter, such as svc.startd
%m Name of the method, such as start or stop
%s Name of the service
%i Name of the instance
%f FMRI of the instance
%{prop[:,]} Value(s) of a property.
</pre><p>See the smf_method(5) manpage for more.</p><h3 id="H4.7.Whatdoesatimeout_secondsvalueof22022or22-122mean3F"><span>4.7. What does a timeout_seconds value of "0" or "-1" mean?</span></h3><p>"0" or "-1" denote infinite timeout; we recommend you use "0" and not "-1".</p><h3 id="H4.8.Whatistheinetconvpropertygroupusedfor3F"><span>4.8. What is the inetconv property group used for?</span></h3><p>It's a record of the original inetd.conf(4) line the inetconv(1M) used to generate the manifest. You don't need it if you're writing a new manifest.</p><h3 id="H4.9.HowdoIrestrictmyservicetohaveonlytheprivilegesitneeds3F"><span>4.9. How do I restrict my service to have only the privileges it needs?</span></h3><p>You need to find out what privileges your service needs, then construct a method context to tell SMF to start and stop the service with only those privileges.</p><p>Download the <span class="wikilink"><a href="/bin/view/Community+Group+security/files">privdebug.pl script</a></span></p><p>Instruction on how to use privdebug.pl is beyond the scope of this FAQ, but can be found in the <span class="wikiexternallink"><a href="http://www.sun.com/blueprints/0206/819-5507.pdf">"Privilege Debugging in the Solaris 10 Operating System" Blueprint</a></span>.</p><p>After the privdebug exercise you will have a set of privileges required for the application to start and to stop. You will add to, or subtract from the set of basic privileges to create a set of privileges that your application uses.</p><p>To see the default basic set of privileges:</p><pre>
# ppriv -l basic
</pre><p>For example, if your application needs:</p><pre>
proc_fork, proc_exec, net_privaddr to start
proc_fork, proc_exec, and proc_session to stop
</pre><p>and your basic set of privilege contains:</p><pre>
file_link_any, proc_fork, proc_exec, proc_info, proc_session
</pre><p>To start you need to:</p><pre>
subtract file_link_any, proc_info, proc_session FROM basic
add net_privaddr TO basic
</pre><p>To stop you need to:</p><pre>
subtract file_link_any, proc_info FROM basic
</pre><p>Insert a method_context block inside your exec_method block in your service manifest, as demonstrated below:</p><pre>
&lt;exec_method
        type='method'
        name='start'
        exec='/path/to/method start'
        timeout_seconds='0' &gt;
        &lt;method_context&gt;
        &lt;method_credential
                user='someuser'
                privileges='basic,!file_link_any,!proc_info,
                                !proc_session,net_privaddr'/&gt;
        &lt;/method_context&gt;
&lt;/exec_method&gt;

&lt;exec_method
        type='method'
        name='stop'
        exec='/path/to/method stop'
        timeout_seconds='0' &gt;
        &lt;method_context&gt;
        &lt;method_credential
                user='someuser'
                privileges='basic,!file_link_any,!proc_info'/&gt;
        &lt;/method_context&gt;
&lt;/exec_method&gt;
</pre><p>Common mistakes include bracketing with &lt;exec_method&gt; &lt;/exec_method&gt;, and writing "/&gt;" after timeout_seconds instead of "&gt;". The correct way is</p><pre>
&lt;exec_method
        ... properties &gt;
        &lt;method_context&gt;
        &lt;method_credential
                ... properties /&gt;
        &lt;/method_context&gt;
&lt;/exec_method&gt;
</pre><p>Also, setting a value for user is required. Import the manifest and check your service. See <span class="wikilink"><a href="#ADMN18">question 2.18</a></span> for how to view your service's privilege set.</p><h3 id="H4.10.HowdoIassignmyservicetoruninaprojectinamanifest3F"><span>4.10. How do I assign my service to run in a project in a manifest?</span></h3><pre>
&lt;exec_method
        type='method'
        name='start'
        exec='/path/to/method start'
        timeout_seconds='0' &gt;
        &lt;method_context
                project='projectname' &gt;
        &lt;method_credential
                user='someuser' /&gt;
        &lt;/method_context&gt;
&lt;/exec_method&gt;
</pre><h3 id="H4.11.WheredoIputmanifeststhatI27vewritten3F"><span>4.11. Where do I put manifests that I've written?</span></h3><p>Manifests for both Solaris and third-party services should be installed in the appropriate subdirectory under /var/svc/manifest. Site-local service manifests should be installed under /var/svc/manifest/site. (Manifests can be stored in other locations, but only manifests stored under /var/svc/manifest will be automatically imported by SMF).</p><p>svc.startd(1M) methods invoke executables, and these executables can be installed wherever you would normally place other executables. Following the conventions defined in filesystem(5), we recommend putting method scripts which are intended for use by only SMF — i.e. not by a human user — under the relevant "lib" directory. Method scripts for Solaris-provided methods are stored in /lib/svc/method. Method scripts for third-party services should be stored under /opt/packagename (/opt/packagename/lib/svc/method is recommended for consistency, but isn't required). Method scripts for site-local services should be stored in whatever tree the site reserves for its libraries/binaries.</p><h2 id="H5.HowToContribute"><span>5. How To Contribute</span></h2><p><em>special thanks to Christine Tran, David Bustos, Bernd Schemmer, and all contributing SMF community members.</em></p><p>This page represents a list of commonly asked questions, with corresponding answers, regarding the Service Management Facility introduced within Solaris 10. The FAQ is intended to be a "living document" that enables users and developers to increase their understanding of smf(5), the development of service manifests,and knowledge of the administrative command-line utilities.</p><p>We strongly encourage and welcome contribution from the SMF Community. Please send your feedback, in addition to Q&amp;A contributions to smf-discuss AT opensolaris DOT org. Please include "SMF FAQ" within your "Subject: " line.</p><p>&nbsp;Last updated 06-Nov-2008 09:32:52 PDT</p>
</div>


    <div class="clearfloats"></div>
  </div>      <div id="xdocFooter">
  
                

       <div class="doc-tags" id="xdocTags">
        Tags:
        </div>
  
  <div id="xdocAuthors">
    <div class="xdocCreation">       Created by Administrator on 2009/10/26 12:10<br/>
          </div>
    <div class="xdocLastModification">       Last modified by Liane Praza on 2009/12/26 17:14
    </div>
  </div>
</div>
<div id="xwikidata" class="layoutsubsection">
        </div>  
    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Community Group smf Pages</h1>
<div class="xwikipanelcontents">
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+smf/contributed%2Dutilities">Useful SMF Utilities</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+smf/contributors">SMF Community Facilitator and Contributors</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+smf/faq">smf(5) FAQ</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+smf/manifests">Converted services: manifests and methods</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+smf/scfdot">scfdot: SMF Dependency Graph Generator</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+smf/smf_design_docs">SMF Project Documents</a></span></li>
</ul>
                              </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2013, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
