<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>Solaris11FCS (Community Group fm.Solaris11FCS) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Community+Group+fm/Solaris11FCS" />
                    <link rel="canonical" href="/bin/view/Community+Group+fm/Solaris11FCS" />
                            <meta name="document" content="Community Group fm.Solaris11FCS"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Community Group fm"/>
    <meta name="page" content="Solaris11FCS"/>
    <meta name="version" content="1.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Community+Group+fm/pages/Solaris11FCS"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="Solaris11FCS" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="Gavin Maltby" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Community Group fm";
XWiki.currentPage = "Solaris11FCS";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Community+Group+fm/Solaris11FCS";
window.docediturl = "/bin/edit/Community+Group+fm/Solaris11FCS";
window.docsaveurl = "/bin/save/Community+Group+fm/Solaris11FCS";
window.docgeturl = "/bin/get/Community+Group+fm/Solaris11FCS";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Community_Group_fm viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FCommunity%2BGroup%2Bfm%2FSolaris11FCS"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+fm/"><strong>Community Group fm</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Community+Group+fm" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <table style="width: 100%;">
        <tr>
            <td style="width: 1%;">
                 <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>
            </td>
            <td style="width: 99%;">
                <table id="loading-indicator">
                    <tr>
                        <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
                                 alt="Loading" title="Loading"/></td>
                        <td>Loading...</td>
                    </tr>
                </table>
            </td>
            <td style="width: 1%;">
                <table id="iconbar">
                    <tr>
                    <td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
                        Collectives</a></td>
                    <td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
                            Discussions</a></td>
                    <td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
                            Documentation</a></td>
                    <td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
                            Download</a></td>
                    <td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
                            Source Browser</a></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                              <a href='/bin/view/Community+Group+fm/'>Fault Management</a> <span class='separator'>&#187;</span> <span class='current'>Solaris11FCS</span>
                </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
        <a href="/bin/view/Community+Group+fm/Solaris11FCS?language=en" class="language-default language-current">en</a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
          <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Community+Group+fm/Solaris11FCS?format=pdf&amp;language=en" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+fm/Solaris11FCS?format=rtf&amp;language=en" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+fm/Solaris11FCS?format=html&amp;language=en" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+fm/Solaris11FCS?viewer=code&amp;language=en"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Community+Group+fm/Solaris11FCS?viewer=comments&amp;language=en" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+fm/Solaris11FCS?viewer=attachments&amp;language=en" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+fm/Solaris11FCS?viewer=history&amp;language=en" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+fm/Solaris11FCS?viewer=information&amp;language=en" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+fm/Solaris11FCS?viewer=code&amp;language=en" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Community+Group+fm/Solaris11FCS?xpage=print&amp;language=en" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          </span></div>
</div>

    </div>
    <div id="mainContentArea">
      








    
<div id="document-title"><h1>Solaris11FCS</h1></div>





              <div id="document-info">
    <div>
          </div>
    <div class="clearfloats"></div>
  </div>

<div id="xwikicontent">
<h1 id="HOracleSolaris11:NewFaultManagementFeatures"><span>Oracle Solaris 11: New Fault Management Features</span></h1><ul><li><span class="wikilink"><a href="#HChassisandReceptacleInformation-DiskNameMapping">Chassis and Receptacle Information - Disk Name Mapping</a></span></li><li><span class="wikilink"><a href="#HEmailNotificationofProblemDiagnosesandUpdates">Email Notification of Problem Diagnoses and Updates</a></span></li><li><span class="wikilink"><a href="#HFanandPower-SupplyCoverage">Fan and Power-Supply Coverage</a></span></li><li><span class="wikilink"><a href="#HFRUMonitor">FRU Monitor</a></span></li><li><span class="wikilink"><a href="#HIdentity-BasedFaults">Identity-Based Faults</a></span></li><li><span class="wikilink"><a href="#HInternalSASDiskEnumerationandDiagnosis">Internal SAS Disk Enumeration and Diagnosis</a></span></li><li><span class="wikilink"><a href="#HKernelPanicModelling">Kernel Panic Modelling</a></span></li><li><span class="wikilink"><a href="#HSensorAbstractionLayer">Sensor Abstraction Layer</a></span></li><li><span class="wikilink"><a href="#HSMFServiceMaintenanceStateModellingandNotification">SMF Service Maintenance State Modelling and Notification</a></span></li><li><span class="wikilink"><a href="#HSMFServiceInstanceStateChangeNotification">SMF Service Instance State Change Notification</a></span></li><li><span class="wikilink"><a href="#HSNMPMonitoring">SNMP Monitoring</a></span></li><li><span class="wikilink"><a href="#HSubscribingtoFaultManagerProblemLifecycleEvents">Subscribing to Fault Manager Problem Lifecycle Events</a></span></li><li><span class="wikilink"><a href="#HSystemReporting">System Reporting</a></span></li><li><span class="wikilink"><a href="#HTopologySnapshots">Topology Snapshots</a></span></li><li><span class="wikilink"><a href="#HUSBFaultManagement">USB Fault Management</a></span></li><li><span class="wikilink"><a href="#HZones">Zones</a></span></li></ul><h2 id="HChassisandReceptacleInformation-DiskNameMapping"><span>Chassis and Receptacle Information - Disk Name Mapping</span></h2><p>A long-standing challenge in Solaris administration is to identify a physical disk given the logical <tt>/dev</tt> Solaris name for it - e.g., which physical disk does <tt>/dev/dsk/c2t3d0</tt> or <tt>/dev/dsk/c3t5000C50009404407d0</tt> correspond to? For cases such as <tt>c2t3d0</tt> the physical location has a bearing on the chosen logical name (<tt>t3</tt> is target 3 which was usually a fixed location on the copper SCSI chain serviced by the controller <tt>c2</tt>, wherever that is), but for disk names formed using a property of the disk (such as worldwide number <tt>5000C50009404407</tt>) the logical name only identifies a controller that has a path to that disk and the logical name may be unchanged if the disk were in a different bay. If a system is configured with even just a modest amount of storage (say a few disk shelves) there is room for confusion.</p><p>In Solaris 11, chassis "receptacles" (think of disk bays) and their "occupants" (typically disks) can be queried using the new <tt>diskinfo(1m)</tt> and <tt>croinfo(1m)</tt> commands. Moreover, descriptive aliases can be established for storage chassis: instead of a product name and serial number one can list a datacenter name and location therein, for example. These aliases are persistent and replace the default names in commands such as <tt>format(1m)</tt>.</p><p>Here's the default output:</p><div class="box code"># croinfo<br/>D:devchassis-path &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t:occupant-type &nbsp;c:occupant-compdev &nbsp;&nbsp;<br/>------------------------------------------------- &nbsp;--------------- &nbsp;---------------------<br/>/dev/chassis/SYS/HD0/disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c10t0d0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>/dev/chassis/SYS/HD1/disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c10t1d0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>/dev/chassis/SYS/HD2 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>/dev/chassis/SYS/HD3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_00/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C50009404407d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_01/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940262Bd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_02/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C500094036D3d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_03/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F6BBd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_04/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F6ABd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_05/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F57Fd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_06/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F553d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_07/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F62Fd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_08/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940EE5Fd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_09/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F597d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_10/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940ED47d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_11/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940EDBBd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_12/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F757d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_13/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F7C7d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_14/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940FB0Fd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_15/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F3EFd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_16/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F78Bd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_17/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F5CFd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_18/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F707d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_19/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F7C3d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_20/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F55Bd0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_21/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F547d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_22/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F7D3d0<br/>/dev/chassis/SUN-Storage-J4410.A3451/DISK_23/disk &nbsp;disk &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3t5000C5000940F567d0</div><p>The system has a couple of internal disks (under the well-known SYS alias) and a single Sun Storage J4410 JBOD with serial number A3541. Already a big step forward! Consulting the <tt>croinfo(1m)</tt> manpage there are a host of query options such as to ask where <tt>c3t5000C50009404407d0</tt> is, list all disks in a chassis of a given serial number, list disks with a given firmware version, etc.</p><p>Next we'll appoint an alias for the J4410 attached to this system: "DC1-ROW11-RACK3-SHELF2" - which identifies this particular J4410 JBOD with chassis serial number A3541 within our datacenter. &nbsp;Note that you can't specify aliases for individual receptacles within a chassis - those are discovered from the storage enclosure using SCSI enclosure services protocol which provides the labels as silkscreened on the receptacles themselves.</p><div class="box code"># fmadm add-alias SUN-Storage-J4410.A3451 DC1-ROW11-RACK3-SHELF2<br/><br/># diskinfo<br/>D:devchassis-path &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c:occupant-compdev &nbsp;&nbsp;<br/>------------------------------------------------ &nbsp;---------------------<br/>...<br/>/dev/chassis/DC1-ROW11-RACK3-SHELF2/DISK_00/disk &nbsp;c3t5000C50009404407d0<br/>/dev/chassis/DC1-ROW11-RACK3-SHELF2/DISK_01/disk &nbsp;c3t5000C5000940262Bd0<br/>...<br/><br/># format<br/>Searching for disks...done<br/><br/><br/>AVAILABLE DISK SELECTIONS:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0. c3t5000C50009404407d0 &lt;SEAGATE-ST330057SSUN300G-0205-279.40GB&gt;<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/scsi_vhci/disk@g5000c50009404407<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/dev/chassis/DC1-ROW11-RACK3-SHELF2/DISK_00/disk<br/><br/>	...</div><h2 id="HEmailNotificationofProblemDiagnosesandUpdates"><span>Email Notification of Problem Diagnoses and Updates</span></h2><p>An overdue feature in Solaris was the notification via email of new problem diagnoses, and of subsequent updates to those diagnoses. In Oracle Solaris 11 this functionality is provided by the <tt>svc:/system/fm/snmp-notify:default</tt> service instance (delivered in the <tt>service/fault-management/snmp-notify</tt> package). Use <tt>svcs -n</tt> to list the current notification preferences, and <tt>svccfg setnotify</tt> to express new preferences. The manpages <tt>snmp-notify(1m)</tt> and <tt>svccfg(1m)</tt> include additional information and examples. Notification preferences are expressed using the SMF command lines and not <tt>fmadm</tt>, mostly because notification of SMF service instance state transitions (see below) uses the same mechanism.</p><p>After initial install the defaults apply:</p><div class="box code"># svcs -n<br/>Notification parameters for FMA Events<br/>&nbsp;&nbsp;&nbsp;&nbsp;Event: problem-diagnosed<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notification Type: smtp<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Active: true<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reply-to: root@localhost<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;to: root@localhost<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notification Type: snmp<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Active: true<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notification Type: syslog<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Active: true<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;Event: problem-repaired<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notification Type: snmp<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Active: true<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;Event: problem-resolved<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Notification Type: snmp<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Active: true</div><p>Thus a new problem diagnosis sends an email to <tt>root@localhost</tt>, raises an SNMP trap (more configuration required to integrate this completely) and renders a summary to the console and messages file; when a problem is repaired (e.g.. through <tt>fmadm repair</tt> or through detection of a FRU replacement) and when all isolated resources are confirmed back online after the repair we raise an SNMP trap.</p><p>To configure, for example, notification by email for new problems diagnosed to another alias and to also render problem resolutions to syslog and messages:</p><div class="box code"># svccfg setnotify problem-diagnosed mailto:ops@somewhere.org<br/># svccfg setnotify problem-resolved syslog:active</div><p>Below is an example email notification show some of the header information as well as the body.</p><div class="box code">Date: Sun, 6 Nov 2011 21:02:57 -0800 (PST)<br/>From: No Access User &lt;noaccess@hyper.mydomain.com&gt;<br/>Message-Id: &lt;201111070502.pA752vpD471737@hyper.mydomain.com&gt;<br/>X-FMEV-HOSTNAME: hyper<br/>X-FMEV-CLASS: list.suspect<br/>X-FMEV-UUID: e7b60570-c12b-c5cf-fe20-eddddf8e9834<br/>X-FMEV-CODE: SMF-8000-YX<br/>X-FMEV-SEVERITY: major<br/>Reply-To: root@hyper.mydomain.com<br/>Subject: Fault Management Event: hyper:SMF-8000-YX<br/>To: ops@somewhere.org<br/><br/>SUNW-MSG-ID: SMF-8000-YX, TYPE: defect, VER: 1, SEVERITY: major<br/>EVENT-TIME: Sun Nov &nbsp;6 21:02:57 PST 2011<br/>PLATFORM: Sun-Fire-X4600-M2, CSN: 0706BE118B, HOSTNAME: hyper<br/>SOURCE: software-diagnosis, REV: 0.1<br/>EVENT-ID: e7b60570-c12b-c5cf-fe20-eddddf8e9834<br/>DESC: A service failed - the instance is restarting too quickly.<br/>AUTO-RESPONSE: The service has been placed into the maintenance state.<br/>IMPACT: svc:/system/auditd:default is unavailable.<br/>REC-ACTION: Run 'svcs -xv svc:/system/auditd:default' to determine the generic reason why the service failed, the location of any logfiles, and a list of other services impacted. Please refer to the associated reference document at http://sun.com/msg/SMF-8000-YX for the latest service procedures and policies regarding this diagnosis.</div><p>Additional information is available in the manpages mentioned above, and in <span class="wikiexternallink"><a href="https://blogs.oracle.com/robj/entry/fma_and_email_notifications">this blog entry</a></span>.</p><h2 id="HFanandPower-SupplyCoverage"><span>Fan and Power-Supply Coverage</span></h2><p>The Oracle Solaris fault manager now has visibility of fan and power-supply problems (diagnosed on the service processor). If a fan or power-supply should develop a fault, that fault will be visible in <tt>fmadm faulty</tt> output on the host. &nbsp;This functionality is built on top of the Sensor Abstraction Layer, described below.</p><h2 id="HFRUMonitor"><span>FRU Monitor</span></h2><p>The <tt>fru-monitor</tt> plugin replaces the <tt>disk-monitor</tt> fault manager plugin, and monitors the addition and removal of FRUs (field-replaceable units) to/from the system. It is also responsible for lighting service LEDs on FRUs diagnosed as faulty (although for now it is restricted to operating on disks for that functionality). Tracking the insertion and removal of hot-pluggable FRUs, particularly of disks, is essential in keeping the fault diagnosis state up-to-date.</p><h2 id="HIdentity-BasedFaults"><span>Identity-Based Faults</span></h2><p>When a hardware problem is diagnosed an internal fault manager representation of the faulty resource is used to track the problem. That representation encodes both current location information (such as a particular disk bay) and serial number information. If the component is moved within the system it used to be the case for some faults that the associated fault information would not be translated for the new location, and we would no longer be able to perform an isolation action (such as to offline the component). New functionality in Oracle Solaris 11 now assures that we correctly track the resource using the invariant "identity" information (such as serial number).</p><h2 id="HInternalSASDiskEnumerationandDiagnosis"><span>Internal SAS Disk Enumeration and Diagnosis</span></h2><p>In the past, Solaris disk diagnosis has applied primarily to disks housed in external storage chassis from which we can retrieve the necessary information using SCSI Enclosure Services. Internal disk bays usually lack this information, and so while such disks could raise error reports we could not diagnose those reports on a number of platforms (the exceptions being those few that had manually captured the details of the internal disk layout in Solaris code).</p><p>A new feature in Solaris 11 allows Solaris fault management software to enumerate internal SAS disk bays for Oracle products, and with that follows diagnosis of internal disk error reports.</p><h2 id="HKernelPanicModelling"><span>Kernel Panic Modelling</span></h2><p>If the operating system kernel should panic then on subsequent reboot when we save a crashdump for post-mortem analysis we now also raise a problem diagnosis to highlight the issue. The event raised for this problem, which can be transmitted via Oracle ASR if registered (as above), includes the panic string and panic stack for initial classification and recognition of the underlying problem. &nbsp;Here's how a typical panic would appear in the <tt>messages</tt> file (in the example the <tt>fmdump -m</tt> option is used to illustrate this output):</p><div class="box code"># fmdump -m -u 708e3733-a6b2-6739-a013-a494d189a1ba<br/>SUNW-MSG-ID: SUNOS-8000-KL, TYPE: Defect, VER: 1, SEVERITY: Major<br/>EVENT-TIME: Tue Jun 14 09:04:37 PDT 2011<br/>PLATFORM: Sun-Fire-X4600-M2, CSN: 0706BE118B, HOSTNAME: hyper<br/>SOURCE: software-diagnosis, REV: 0.1<br/>EVENT-ID: 708e3733-a6b2-6739-a013-a494d189a1ba<br/>DESC: The system has rebooted after a kernel panic.<br/>AUTO-RESPONSE: The failed system image was dumped to the dump device. &nbsp;If savecore is enabled (see dumpadm(1M)) a copy of the dump will be written to the savecore directory /var/crash/hyper.<br/>IMPACT: There may be some performance impact while the panic is copied to the savecore directory. &nbsp;Disk space usage by panics can be substantial.<br/>REC-ACTION: Use 'fmadm faulty' to provide a more detailed view of this event. If savecore is not enabled then please take steps to preserve the crash image. Use 'fmdump -Vp -u 708e3733-a6b2-6739-a013-a494d189a1ba' to view more panic detail. Please refer to the associated reference document at http://sun.com/msg/SUNOS-8000-KL for the latest service procedures and policies regarding this diagnosis.</div><p>Running the suggested command show the event in full and illustrates what would be transmitted through ASR if configured:</p><div class="box code"># fmdump -Vp -u 708e3733-a6b2-6739-a013-a494d189a1ba<br/>TIME &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UUID &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SUNW-MSG-ID<br/>Jun 14 2011 09:04:37.816512000 708e3733-a6b2-6739-a013-a494d189a1ba SUNOS-8000-KL<br/><br/>&nbsp;&nbsp;TIME &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLASS &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENA<br/>&nbsp;&nbsp;Jun 14 09:04:25.3100 ireport.os.sunos.panic.dump_available 0x0000000000000000<br/>&nbsp;&nbsp;Jun 14 09:01:25.8865 ireport.os.sunos.panic.dump_pending_on_device 0x0000000000000000<br/><br/>nvlist version: 0<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version = 0x0<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class = list.suspect<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;uuid = 708e3733-a6b2-6739-a013-a494d189a1ba<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code = SUNOS-8000-KL<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;diag-time = 1308067477 784010<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;de = fmd:///module/software-diagnosis<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fault-list-sz = 0x1<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__case_state = 0x1<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topo-uuid = da8119a1-3ff1-40e3-ec74-f703faa8fca3<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fault-list = (array of embedded nvlists)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(start fault-list[0])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nvlist version: 0<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;version = 0x0<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class = defect.sunos.kernel.panic<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;certainty = 0x64<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;asru = sw:///:path=/var/crash/hyper/.708e3733-a6b2-6739-a013-a494d189a1ba<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;resource = sw:///:path=/var/crash/hyper/.708e3733-a6b2-6739-a013-a494d189a1ba<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;savecore-succcess = 1<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dump-dir = /var/crash/hyper<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dump-files = vmdump.3<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;os-instance-uuid = 708e3733-a6b2-6739-a013-a494d189a1ba<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panicstr = BAD TRAP: type=e (#pf Page fault) rp=ffffff007aba40d0 addr=0 occurred in module "unix" due to a NULL pointer dereference<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panicstack = unix:die+d8 () | unix:trap+150c () | unix:_cmntrap+e6 () | unix:bcopy+55a () | e1000g:e1000g_m_tx+6b () | mac:mac_tx+2df () | dld:str_mdata_fastpath_put+99 () | ip:ip_xmit+946 () | ip:ire_send_wire_v4+33a () | ip:conn_ip_output+2eb () | ip:tcp_send_data+80 () | ip:tcp_timer+a61 () | ip:tcp_timer_handler+39 () | ip:squeue_drain+20b () | ip:squeue_worker+147 () | unix:thread_start+8 () | <br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;crashtime = 1308066640<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panic-time = 14 June 2011 08:50:40 AM PDT PDT<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(end fault-list[0])<br/><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fault-status = 0x1<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;severity = Major<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__ttl = 0x1<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;__tod = 0x4df78695 0x30aafc00</div><h2 id="HSensorAbstractionLayer"><span>Sensor Abstraction Layer</span></h2><p>The Sensor Abstraction Layer extends the topology library (<tt>libtopo</tt>) such that sensors and indicators can also be represented in our topology in a fashion that allows for the association of sensors and indicators to corresponding hardware resource to be programmatically determined.</p><p>The sensor abstraction layer also provides a layer of abstraction between the topology library and the lower-level interfaces that are used to control a given sensor or indicator, making it easy to write high-level software for reading sensors and controlling indicators.</p><p>More information is available in blog entries <span class="wikiexternallink"><a href="https://blogs.oracle.com/robj/entry/a_sensor_abstraction_layer_for">here</a></span> and <span class="wikiexternallink"><a href="https://blogs.oracle.com/eschrock/entry/ses_sensors">here</a></span>.</p><h2 id="HSMFServiceMaintenanceStateModellingandNotification"><span>SMF Service Maintenance State Modelling and Notification</span></h2><p>There are a number of conditions under which an SMF service instance may transition to the maintenance state, such as through the start method failing after detecting a configuration issue or repeatedly failing such as through coredump on every attempt. Service instances in maintenance state are modelled with problem diagnoses in Solaris 11, and they show up in <tt>fmadm faulty</tt> output and can directed through the same notification mechanisms (email, snmp, syslog) as for all problems (configure "problem-diagnosed" preferences with svccfg as above). Maintenance state continues to appear in <tt>svcs -x</tt> output as before. You can clear maintenance state through the conventional <tt>svcadm clear</tt> (or <tt>svcadm disable</tt>) or through <tt>fmadm repair</tt> which is equivalent to <tt>svcadm clear</tt>.</p><p>The example below will also serve to show how you can generate test diagnoses for validating your configuration - such as to confirm that email notification works as expected, or to send a test SNMP trap. &nbsp;Producing such test diagnoses in the past has not been possible without proprietary (and very dangerous!) hardware error injectors - now we can force a diagnosis simply by abusing an SMF service. &nbsp;The approach is simple - repeatedly kill all processes running under a particular service instance until SMF stops restarting it because things are restarting too frequently; &nbsp;below we use the <tt>svc:/network/ntp:default</tt> - if that service is sensitive for your installation then choose one that isn't, or write a simple service manifest for a service we can target and use that.</p><div class="box code">root@hyper:~# svcs auditd<br/>STATE &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STIME &nbsp;&nbsp;&nbsp;FMRI<br/>online &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Oct_26 &nbsp;&nbsp;svc:/system/auditd:default<br/><br/>root@hyper:~# pkill auditd<br/>root@hyper:~# pkill auditd<br/>root@hyper:~# pkill auditd<br/>root@hyper:~# pkill auditd<br/>root@hyper:~# pkill auditd<br/>root@hyper:~# pkill auditd<br/><br/>root@hyper:~# svcs auditd<br/>STATE &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STIME &nbsp;&nbsp;&nbsp;FMRI<br/>maintenance &nbsp;&nbsp;&nbsp;21:02:57 svc:/system/auditd:default</div><p>Wait a second between <tt>pkill</tt> repeats. &nbsp;You may have to kill one or two more times - it depends on how quickly the service restarts. Here's what <tt>fmadm</tt> shows:</p><div class="box code">root@hyper:~# fmadm faulty<br/>--------------- ------------------------------------ &nbsp;-------------- ---------<br/>TIME &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVENT-ID &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSG-ID &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SEVERITY<br/>--------------- ------------------------------------ &nbsp;-------------- ---------<br/>Nov 06 21:02:57 e7b60570-c12b-c5cf-fe20-eddddf8e9834 &nbsp;SMF-8000-YX &nbsp;&nbsp;&nbsp;major &nbsp;&nbsp;&nbsp;&nbsp;<br/><br/>Host &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: hyper<br/>Platform &nbsp;&nbsp;&nbsp;: Sun-Fire-X4600-M2 Chassis_id &nbsp;: 0706BE118B<br/>Product_sn &nbsp;: <br/><br/>Fault class : defect.sunos.smf.svc.maintenance<br/>Affects &nbsp;&nbsp;&nbsp;&nbsp;: svc:///system/auditd:default<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;faulted and taken out of service<br/>Problem in &nbsp;: svc:///system/auditd:default<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;faulted and taken out of service<br/><br/>Description : A service failed - the instance is restarting too quickly.<br/><br/>Response &nbsp;&nbsp;&nbsp;: The service has been placed into the maintenance state.<br/><br/>Impact &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: svc:/system/auditd:default is unavailable.<br/><br/>Action &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Run 'svcs -xv svc:/system/auditd:default' to determine the<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;generic reason why the service failed, the location of any<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logfiles, and a list of other services impacted. Please refer to<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the associated reference document at<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http://sun.com/msg/SMF-8000-YX for the latest service procedures<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and policies regarding this diagnosis.</div><p>When we've fixed the issue we can attempt to bring the service instance online<br/>again using either <tt>svcadm clear auditd</tt> or <tt>fmadm repair e7b60570-c12b-c5cf-fe20-eddddf8e9834</tt>.</p><p>Note that service instance maintenance problem diagnoses do not result in service requests through Oracle ASR - they are usually to be resolved locally with no support required.</p><h2 id="HSMFServiceInstanceStateChangeNotification"><span>SMF Service Instance State Change Notification</span></h2><p>While the SMF maintenance state problem modelling described above applies only to service instances entering maintenance state, you can also configure notification preferences for any service instance transition (i.e. not just to maintenance state).</p><p>We only model maintenance state as a problem and so "problem-diagnosed" preferences expressed in <tt>svccfg</tt> as above can only notify of that transition. An administrator can express notification preferences for <em>any</em> SMF transition (including to maintenance, so there's some overlap here) also using <tt>svccfg setnotify</tt>. Global preferences can be expressed as well as per-service-instance preferences, and <tt>svcs -n</tt> lists these preferences along with those for problem lifecycle events. The <tt>svccfg(1m)</tt> manpage has example of this.</p><div class="box code"># svccfg setnotify -g to-offline,to-maintenance mailto:admin@somehost.com<br/># svccfg -s svc:/network/smtp:sendmail setnotify to-offline mailto:admin@somehost.com<br/># svccfg -s svc:/network/smtp:sendmail setnotify to-offline snmp:active</div><p>The first command sets an email preference for all services transitioning either to maintenance or offline state. The second command expresses an email preference for an individual service instance, while the third enable SNMP trap notification for a single servince instance.</p><p>Additional information is available in the manpages mentioned above, and in <span class="wikiexternallink"><a href="https://blogs.oracle.com/gavinm/entry/notifications_for_smf_instance_state">this blog entry</a></span>.</p><h2 id="HSNMPMonitoring"><span>SNMP Monitoring</span></h2><p>SNMP trap notification of problem diagnoses and updates is nothing new, however the implementation thereof has now moved from a fault manager plugin to a separate service <tt>svc:/system/fm/snmp-notify:default</tt> delivered via the <tt>system/fault-management/snmp-notify</tt> package. Also new is the ability to configure preferences for individual problem lifecycle events, such as to trap for problem-diagnosed but not for problem-resolved - see <tt>svccfg</tt> examples above.</p><p>The SNMP MIBs are delivered in <tt>/etc/net-snmp/snmp/mibs/</tt>. The <tt>SUN-FM-MIB.mib</tt> file describes the SNMP trap available for problem lifecycle events, in addition to the full browsable MIB available if you configure the MIB plugin into your SNMP agent. The <tt>SUN-IREPORT-MIB.mib</tt> describes the trap available for SMF state transitions.</p><h2 id="HSubscribingtoFaultManagerProblemLifecycleEvents"><span>Subscribing to Fault Manager Problem Lifecycle Events</span></h2><p>For applications wishing to subscribe to fault manager events directly, a new Committed C API is delivered with <tt>libfmevent(3fm)</tt>. The <tt>libfmevent(3fm)</tt> and <tt>fmev_shdl_init(3fm)</tt> manpages document the API in detail.</p><h2 id="HSystemReporting"><span>System Reporting</span></h2><p>Oracle Solaris 11 includes a form of "phone home" offering which relays newly-diagnosed problems (as you'd see with <tt>fmadm faulty</tt> - new diagnoses in the Fault Management subsystem) to the Oracle ASR service so that problem trends may be established and a support call may be opened if appropriate. This service requires registration of the system using a valid My Oracle Support (MOS) account and the <tt>asradm(1m)</tt> command, and you also need to login to your MOS account and enable the system for monitoring. In addition to newly-diagnosed problems a periodic audit heartbeat is transmitted.</p><p>Whether registered or not, you are able to see what information would be relayed to MOS using the <tt>-n</tt> option to <tt>asradm</tt>. The <tt>asr-notify(1m)</tt> manpage describes the message format and content used by the ASR service. A new SMF service instance <tt>svc:/system/fm/asr-notify:default</tt> implements the ASR functionality.</p><div class="wikimodel-emptyline"></div><h2 id="HTopologySnapshots"><span>Topology Snapshots</span></h2><p>In some cases a reboot/panic or other major event can intercede between raising of an error report and delivery of that error report for diagnosis. An example is a cpu which suffers some uncorrectable error causing a kernel panic - telemetry is gathered at the time of the error but only diagnosed on the subsequent reboot. If the system topology changes between the event itself and the subsequent diagnosis (for example the system firmware chooses to unconfigure the errant cpu) then we need to know the topology from the time of the event in order to diagnose - the topology at diagnosis time is inadequate. This used to lead to a corner case in which we'd be unable to diagnose some problems (and we'd complain about that!). With the new feature of topology snapshots we maintain a snapshot of past topologies for replay of telemetry delayed as described.</p><p>A related feature, and also more "under the hood", is that of Configuration Numeric Association (CNA). &nbsp;Previously every dynamic reconfiguration event resulted in a full rediscovery of system topolofy, whereas a relatively small minority of cases really require a rediscovery. &nbsp;It would be possible to suffer bursts of DR events triggering numerous rediscoveries, and consuming corresponding CPU time.</p><h2 id="HUSBFaultManagement"><span>USB Fault Management</span></h2><p>Oracle Solaris 11 includes fault management features for USB. USB drivers have been hardened to be more robust in the face of USB errors and to raise structured error reports, and diagnosis rules are included to process those reports and highlight USB bus and client device faults.</p><h2 id="HZones"><span>Zones</span></h2><p>The fault manager service <tt>svc:/system/fmd:default</tt> is now active in non-global Solaris 11 zones. Most fault manager plugins are not present in such a zone as they are concerned with hardware only visible from the global zone. The main role today of fmd in a non-global zone is to play its part in the diagnosis and messaging on SMF instance maintenance, and for notification of SMF instance state transitions (for transitions other than to maintenance, as described above). Note that you may need to <tt>pkg install</tt> the <tt>system/fault-management/snmp-notify</tt> and <tt>system/fault-management/snmp-notify</tt> packages in non-global zones in which you wish to utilize those notification methods.</p>
</div>


    <div class="clearfloats"></div>
  </div>      <div id="xdocFooter">
  
                

       <div class="doc-tags" id="xdocTags">
        Tags:
        </div>
  
  <div id="xdocAuthors">
    <div class="xdocCreation">       Created by Gavin Maltby on 2011/11/09 20:57<br/>
          </div>
    <div class="xdocLastModification">       Last modified by Gavin Maltby on 2011/11/09 20:57
    </div>
  </div>
</div>
<div id="xwikidata" class="layoutsubsection">
        </div>  
    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Community Group fm Pages</h1>
<div class="xwikipanelcontents">
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+fm/FMAdrivers">FMA Aware Device Drivers</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+fm/Features">New Fault Management Features</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+fm/Solaris11FCS">Solaris11FCS</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+fm/demokit">Solaris FMA Demo Kit</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+fm/fmblogs">FM Blogs</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+fm/fmnews">FM News</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+fm/mib">SNMP Connector</a></span></li>
</ul>
                    </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2012, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
