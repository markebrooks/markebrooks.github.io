<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>Design Document (Project ddtool.designdoc) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Project+ddtool/designdoc" />
                    <link rel="canonical" href="/bin/view/Project+ddtool/designdoc" />
                            <meta name="document" content="Project ddtool.designdoc"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Project ddtool"/>
    <meta name="page" content="designdoc"/>
    <meta name="version" content="2.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Project+ddtool/pages/designdoc"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="Design Document" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="admin" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Project ddtool";
XWiki.currentPage = "designdoc";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Project+ddtool/designdoc";
window.docediturl = "/bin/edit/Project+ddtool/designdoc";
window.docsaveurl = "/bin/save/Project+ddtool/designdoc";
window.docgeturl = "/bin/get/Project+ddtool/designdoc";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Project_ddtool viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FProject%2Bddtool%2Fdesigndoc"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+ddtool/"><strong>Project ddtool</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Project+ddtool" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <table style="width: 100%;">
        <tr>
            <td style="width: 1%;">
                 <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>
            </td>
            <td style="width: 99%;">
                <table id="loading-indicator">
                    <tr>
                        <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
                                 alt="Loading" title="Loading"/></td>
                        <td>Loading...</td>
                    </tr>
                </table>
            </td>
            <td style="width: 1%;">
                <table id="iconbar">
                    <tr>
                    <td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
                        Collectives</a></td>
                    <td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
                            Discussions</a></td>
                    <td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
                            Documentation</a></td>
                    <td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
                            Download</a></td>
                    <td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
                            Source Browser</a></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                  <span class='current'>Design Document</span>
          </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
        <a href="/bin/view/Project+ddtool/designdoc?language=en" class="language-default language-current">en</a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
          <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Project+ddtool/designdoc?format=pdf&amp;language=en" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+ddtool/designdoc?format=rtf&amp;language=en" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+ddtool/designdoc?format=html&amp;language=en" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+ddtool/designdoc?viewer=code&amp;language=en"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Project+ddtool/designdoc?viewer=comments&amp;language=en" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ddtool/designdoc?viewer=attachments&amp;language=en" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ddtool/designdoc?viewer=history&amp;language=en" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ddtool/designdoc?viewer=information&amp;language=en" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ddtool/designdoc?viewer=code&amp;language=en" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Project+ddtool/designdoc?xpage=print&amp;language=en" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          <span class="submenuitem "><a href="/bin/view/Project+ddtool/designdoc?xpage=copy" id="tmActionCopy" class="tmActionCopy">Copy</a></span>
      </span></div>
</div>

    </div>
    <div id="mainContentArea">
      








    
<div id="document-title"><h1>Design Document</h1></div>

              <div id="document-info">
    <div>
          </div>
    <div class="clearfloats"></div>
  </div>

<div id="xwikicontent">
<h1 id="HDeviceDetectionToolDesign"><span><strong>Device Detection Tool Design</strong></span></h1><dl><dd>|<br/>Date</dd></dl><table><tr><td><br/>Revision</td></tr><tr><td><br/>Author</td></tr><tr><td><br/>Comment</td></tr><tr><td><br/>Mar. 26, 2008</td></tr><tr><td><br/>1.0</td></tr><tr><td><br/>Ye.Li@Sun.Com</td></tr><tr><td><br/>Design Doc of DDTool 2.0</td></tr><tr><td><br/>Feb. 26, 2009</td></tr><tr><td><br/>1.1</td></tr><tr><td><br/>Ye.Li@Sun.Com</td></tr><tr><td><br/>Design Doc of DDTool 2.2</td></tr></table><h2 id="H1.Overview"><span>1. Overview</span></h2><p>Device Detection Tool can tell you in just a couple of minutes whether the Solaris OS supports the devices that are detected in your x86/x64 system.</p><p>It produces a table that shows whether a Solaris driver is available for each device the tool detects. The table tells you whether the driver is built in to the Solaris OS or available in <span class="wikiexternallink"><a href="http://www.opensolaris.org/">OpenSolaris.org</a></span> or whether a third-party driver is available.</p><p>For its functionality and usage, refer to its <span class="wikiexternallink"><a href="http://www.sun.com/bigadmin/hcl/hcts/device_detect.jsp">official web site</a></span>.</p><p>In a certain aspect, Device Detection Tool is a 'predict' tool. It could predict whether those devices in you Windows, Linux, Mac or FreeBSD system work when a Solaris OS is installed on the machine. How does it do that? It is actually simple:<br/>[1] The tool collects device data of PCI devices in users' systems.<br/>[2] The tool compares the detected device data with a Solaris driver database which is maintained by Sun to check the Solaris driver availability status for each device.<br/>[3] The tool generates a Solaris driver availability report to show users.</p><h2 id="H2.Architecture"><span>2. Architecture</span></h2><p>Following is the architecture diagram of Device Detection Tool.</p><p><img src="https://markebrooks.github.io/bin/download/Project+ddtool/designdoc/sddt22archdiagram.jpg" alt="sddt22archdiagram.jpg"/></p><p>From the architecture diagram you can see that there are three parts of the tool: (1) Driver Database; (2) PCI device data probe program for specific system; (3) and the function unit. In the later chapters, the parts are introduced one by one.</p><h2 id="H3.DriverDatabase"><span>3. Driver Database</span></h2><p>The driver database of Device Detection Tool are special format text files – configuration file, pci.ids and a driver.db specified to each target OS.</p><h3 id="H3.1configurationfile"><span>3.1 configuration file</span></h3><p>DDTool reads arguments from a single configuration file, and this file will be put on a server. DDTool gets the configuration file remotely while launching. And then DDTool reads arguments from it. Those arguments are URL of pci.ids and driver.db, and</p><p>The configuration file is a XML file, and its format is as follows:<br/>&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br/>&lt;Configuation&gt;<br/>  &lt;timeout&gt;&lt;/timeout&gt;<br/>  &lt;conntimeout&gt;&lt;/conntimeout&gt;<br/>  &lt;readtimeout&gt;&lt;/readtimeout&gt;<br/>  &lt;pciids&gt;<br/>    &lt;hostip&gt;&lt;/hostip&gt;<br/>    &lt;dir&gt;&lt;/dir&gt;<br/>    &lt;filename&gt;&lt;/filename&gt;<br/>  &lt;/pciids&gt;<br/>  &lt;driverdb&gt;<br/>    &lt;db&gt;<br/>        &lt;number&gt;&lt;/number&gt;<br/>        &lt;hostip&gt;&lt;/hostip&gt;<br/>        &lt;dir&gt;&lt;/dir&gt;<br/>        &lt;filename&gt;&lt;/filename&gt;       <br/>    &lt;/db&gt;<br/>    &lt;db&gt;<br/>        .... ....<br/>    &lt;/db&gt;<br/>  &lt;/driverdb&gt;<br/>&lt;/Configuation&gt;</p><h3 id="H3.2pci.ids"><span>3.2 pci.ids</span></h3><p>pci.ids is a public repository of all known ID's used in PCI devices, and we can get full device names and vendor names instead of the numeric device id and vendor id by using it. It is maintained by developers outside Sun, and can be distributed under the 3-clause BSD License. We can adopt it as a part of DDTool Database without any license problem.</p><p>The following are examples of records in pci.ids:</p><p>-<del>-<br/>8086  Intel Corporation<br/>    ... ...<br/>    0008  Extended Express System Support Controller<br/>    0039  21145 Fast Ethernet<br/>    ... ...<br/>-</del>-<br/>In this case, two devices are listed. Their vendor id is identical -- 8086 which indicates that they are manufactured by Intel Corporation, and their device id are 0008 and 0039 respectively which indicate their name are 'Extended Express System Support Controller' and '21145 Fast Ethernet'.</p><h3 id="H3.3driver.db"><span>3.3 driver.db</span></h3><h4 id="H3.3.1overviewofdriver.db"><span>3.3.1 overview of driver.db</span></h4><p>driver.db is created and maintained by our team. We can use it to get driver availability status of devices. At present, DDTool provides driver.db for the latest Solaris 10 and Solaris Express Developer Edition OS.</p><ol><li>At the beginning of driver.db, there is a line of Solaris Version Information used to indicate which Solaris version is supported by the current DDTool Database. This line is like following:<br/>    --<br/>    Solaris_Versions        Solaris 10 8/07   Solaris 10 8/07   S10<br/>    --<br/>    It means the current DDTool Database provide driver support status for Solaris 10 8/07, the short name of this Solaris release is Solaris 10 8/07, and the S10 is the sign to indicate this release.</li><li>The driver.db consists kernel driver database, Xorg driver database, and drivername-classcode mapping table.</li></ol><h4 id="H3.3.2Kerneldriverdb"><span>3.3.2 Kernel driver db</span></h4><p>(1) every line in driver.db is a record which corresponds to a single device;<br/>(2) each line consists of 5 elements: pci_string, driver_name, driver_type, 64-bit_capability, and driver_location;</p><ul><li>pci_string is a string consists of vendor id, device id and so on, and its the keyword used to find a device's driver status</li><li>driver_name is the name of driver corresponding to the device identified by pci_string</li><li>driver_type should be one letter. It has totally two values: S and T.    <ul><li>S means this device has a Solaris driver (which is provided by Solaris OS). </li><li>T means this device has a third-party driver (which is provided by third-party vendor).</li></ul></li></ul><ul><li>64-bit_capability should be one letter as well. It has totally three values: Y, N and Z.<ul><li>Y means the driver is available on both of 32-bit and 64-bit Solaris OS. </li><li>N means the driver is only available on 32-bit Solaris OS.  </li><li>Z means the driver is only available on 64-bit Solaris OS.</li></ul></li></ul><ul><li>driver_location<ul><li>If driver_type is 'S', it is a Solaris bundled driver. And driver_location is the specific version of Solaris OS.</li><li>If driver_type is 'T', it is a third-party driver. And driver_location is the download address of this driver.</li><li>If driver_type is 'O', it is a driver published on OpenSolaris community. And driver_location is the download address of this driver.</li></ul></li></ul><p>The following are examples of records in updated driver.db:</p><p><em>[example 1]:<br/>-<del>-<br/># pci_string           driver_name    driver_type    64-bit_capability    driver_location<br/>pci14e4,1644          bge                 S                   Y                       Solaris 10 8/07<br/>-</del>-</em><br/>This device ( vendor id = 14e4, device id = 1644 ) has a Solaris driver which is supported by 32-bit and 64-bit Solaris 10 8/07.<br/><em>[example 2]:<br/>-<del>-<br/># pci_string           driver_name    driver_type    64-bit_capability    driver_location<br/>pci1274,5000          audio1371           T               Y                       <span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://www.tools.de/solaris/audio/beta/"><span class="wikigeneratedlinkcontent">http://www.tools.de/solaris/audio/beta/</span></a></span><br/>-</del>-</em><br/>This device ( vendor id = 1274, device id = 5000 ) has a third-party driver which can be downloaded from <span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://www.tools.de/solaris/audio/beta/"><span class="wikigeneratedlinkcontent">http://www.tools.de/solaris/audio/beta/</span></a></span>, and is supported by 32-bit and 64-bit Solaris 10 8/07.</p><h4 id="H3.3.3Xorgdriverdb"><span>3.3.3 Xorg driver db</span></h4><p>Device Detection Tool 2.0+ detects both the kernel video driver and the Xorg video driver for each video device. Not all video devices have both of the two types of video drivers. Some video devices have only the kernel driver. For example, the ATI RV280[Radeon 9200 PRO] video device has only a kernel video driver named vgatext.</p><p>Xorg driver db is a mapping table between pciids and Xorg driver name. Every line in Xorg Driver DB is a record which corresponds to a single device. The syntax is as follows:</p><p>--</p><p>pic&lt;vendor_id&gt;,&lt;device_id&gt; Xorg_drivername<br/>--</p><h4 id="H3.3.4drivername-classcodemappingtable"><span>3.3.4 drivername-classcode mapping table</span></h4><p>The table is used to check whether a matched driver really supports devices in a specific type. It is created manually by our team members, and at the end of the driver.db file. The syntax is as follows:</p><p>-<del>-<br/>driver_name class_code<br/>-</del>-<br/>The two columns are divided by a Tab. If there are more than one class code for the driver, all of them will be listed in the class_code column, and divided by “;”.</p><h2 id="H4.CollectPCIdevicedata"><span>4. Collect PCI device data</span></h2><h3 id="H4.1ParsingPCIdevicedatafromoutputmessageofsystemcommands"><span>4.1 Parsing PCI device data from output message of system commands</span></h3><p>Device Detection Tool 1.0 gets the device information by running specific system commands respectively on Solaris, Linux and Windows OS as follows, and parses the output message of system commands to extract device information such as vendor id, device id, etc..</p><table><tr><td><br/><strong>OS</strong></td></tr><tr><td><br/><strong>System Command</strong></td></tr><tr><td><br/><strong>Utility</strong></td></tr><tr><td><br/>Solaris OS</td></tr><tr><td><br/>prtconf -pv</td></tr><tr><td><br/>prtconf</td></tr><tr><td><br/>Windows OS</td></tr><tr><td><br/>reg query hklm\system\currentcontrolset\enum\pci /s</td></tr><tr><td><br/>register.exe</td></tr><tr><td><br/>Linux OS</td></tr><tr><td><br/>lspci -vv -n</td></tr><tr><td><br/>PCIUtilities</td></tr></table><p>For this reason, Device Detection Tool 1.0 depends on the availability and robustness of above system commands, and their output message format.</p><h3 id="H4.2Probeusers2019ssystemtogetPCIdevicedatadirectly"><span>4.2 Probe users’s system to get PCI device data directly</span></h3><p>Device Detection Tool 2.2 enhances the device data collecting method. It imports following interfaces to collect device information:</p><table><tr><td><br/><strong>OS</strong></td></tr><tr><td><br/><strong>Interface&nbsp;</strong></td></tr><tr><td><br/><strong>Solution &nbsp;</strong></td></tr><tr><td><br/>Solaris</td></tr><tr><td><br/>libdevinfo</td></tr><tr><td><br/>Looking up PCI nodes in prom tree and reading device data from the nodes</td></tr><tr><td><br/>Windows</td></tr><tr><td><br/>Win32 API</td></tr><tr><td><br/>Reading PCI device data from the registry through Win32 API</td></tr><tr><td><br/>Linux</td></tr><tr><td><br/>/proc/bus/pci</td></tr><tr><td><br/>Scanning the files in /proc/bus/pci and reading PCI device data</td></tr><tr><td><br/>Mac OS X</td></tr><tr><td><br/>IOPCIDevice</td></tr><tr><td><br/>Collecting PCI Device Information</td></tr><tr><td><br/>FreeBSD</td></tr><tr><td><br/>/dev/pci <br/>PCIOCREAD</td></tr><tr><td><br/>Reading PCI device data by scanning /dev/pci</td></tr></table><p>Device Detection Tool is a Java application, it builds a JNI binding for each of the interfaces to collect device information. The enhancement frees it from dependence of system commands.</p><p>The <strong>interface between native probe programs and DDTool</strong> is very simple. It is also output message porting to DDTool by the natvie programs. The message has a unique format on all platform as follows:<br/><em><strong>vendor_id(4b),device_id(4b),class_code(8b),sub-system_vendor_id(4b),sub-system_id(4b),revision_id(2b)</strong></em></p><p>The ids are separated by a ',' without space. One line ending with a line break (“\n”) is corresponding to a single device.</p><p>Following is an example:<br/><em>8086,29a0,00060000,1028,01dc,02<br/>1002,7187,00030000,1028,0402,00<br/>1002,71a7,00038000,1028,0403,00<br/>8086,104c,00020000,1028,01dc,02<br/>8086,284b,00040300,1028,01dc,02<br/>8086,283f,00060400,ffff,ffff,02<br/>8086,2836,000c0320,1028,01dc,02<br/>104c,8023,000c0010,1028,01dc,00<br/>8086,2825,00010185,1028,01dc,02<br/>... ...</em></p><h3 id="H4.3PCIdevicedatafilesimportingfunction"><span>4.3 PCI device data files importing function</span></h3><p>Device Detection Tool 2.0+ also allows device information to be feed into it from plain text files that contain the output message of system commands listed in the first table. The received device information is scanned and parsed by Device Detection Tool 2.0+ to extract device data (as what Device Detection Tool 1.0 did). This function enables the users to check the Solaris driver availability status for remote machines or those without Internet access.</p><h2 id="H5.RetrieveDeviceData"><span>5. Retrieve Device Data</span></h2><h3 id="H5.1OverviewofRetrieving"><span>5.1 Overview of Retrieving</span></h3><p>After the PCI device configuration data is collected, DDTool will retrieve the DDTool Database with these keywords(the values of device id, vendor id, class code, subsystem vendor id and subsystem id).</p><p>Retrieving a single device will look up pci.ids and driver.db sequentially ( please refer the table below):</p><table><tr><td><br/>Retrieved Text File</td></tr><tr><td><br/>Keywords</td></tr><tr><td><br/>Retrieval Result</td></tr><tr><td><br/>Algorithm of Retrieval</td></tr><tr><td><br/>comments</td></tr><tr><td><br/>pci.ids</td></tr><tr><td><br/>values of device id and vendor id</td></tr><tr><td><br/>device name and vendor name</td></tr><tr><td><br/>DDTool simply searches pci.ids (a text file) for the keywords  line by line.</td></tr><tr><td><br/>Technically, any PCI device has a corresponding entry in pci.ids.</td></tr><tr><td><br/>driver.db</td></tr><tr><td><br/>values of device id vendor id, class code, subsystem vendor id, and subsystem id</td></tr><tr><td><br/>driver support status for 32-bit and 64-bit  Solaris OS</td></tr><tr><td><br/>DDTool simply searches driver.db (a text file) for the keywords  line by line.</td></tr><tr><td><br/>While DDTool finds a entry in driver.db corresponding to the current device in processing, it means that this device has a driver. Otherwise, it mean the device has no driver supported by Solaris OS</td></tr></table><p>DDTool puts those retrieval result into report data. After every device is processed, the report data is created completely.</p><h3 id="H5.2DriverSearchingPolicy"><span>5.2 Driver Searching Policy</span></h3><h4 id="H5.2.1DeviceHiding"><span>5.2.1 Device Hiding</span></h4><pre>
Bridges, SMBus, Memory controller, secondary video controllers are filtered out from the final report. Because (a) they don't have impact on the installation of Solaris OS; and (b) Solaris OS generally don't have a driver for them. Thus all of these devices are ignored. DDTool won’t search driver status for them, and they won’t be in the final report.

Therefore, DDTool ignores following devices and won’t display them in the final report: those devices whose class code is begin with one of "000600", "000601", "000602", "000603", "000604", "000680", "0005", "000c05", "0008", or "000380".
</pre><h4 id="H5.2.2SearchingKernelDriverDB"><span>5.2.2 Searching Kernel Driver DB</span></h4><pre>
When a device is detected, DDTool is aware of its class_code, vendor_id, device_id, subsystem_vendor_id, subsystem_id, and revision_id. With the 6 values, 7 keywords can be created for this device as follows:

(KW1): pci&lt;vendor_id&gt;,&lt;device_id&gt;.&lt;subsystem_vendor_id&gt;.&lt;subsystem_id&gt;.&lt;revision_id&gt;
(KW2): pci&lt;vendor_id&gt;,&lt;device_id&gt;.&lt;subsystem_vendor_id&gt;.&lt;subsystem_id&gt;
(KW3): pci&lt;subsystem_vendor_id&gt;,&lt;subsystem_id&gt;
(KW4): pci&lt;vendor_id&gt;,&lt;device_id&gt;.&lt;revision_id&gt;
(KW5): pci&lt;vendor_id&gt;,&lt;device_id&gt;
(KW6): pciclass&lt;class_code&gt; (6 bytes class code)
(KW7): pciclass&lt;class_code&gt; (4 bytes class code)

The 7 keywords are sort by degressive priority. The priority of KW1 is the highest.

DDTool searches Kernel Driver DB line by line (each line in Kernel Driver DB is a separated record)with the 7 keywords.

(step 1) First of all, DDTool go through Solaris bundled records in PCI Kernel Driver DB complying with following rules:

(a) It compares the key-value of each record with keywords in decreasing priority: KW1 -&gt; KW2 -&gt; ... -&gt; KW7.

(b) If a record is matched, DDTool goes to check whether the class code of the device is listed corresponding record of the founded driver name in drivername- classcode mapping table. If so, the record is matched record. Otherwise, the record is ignored. 

(c) If any record matches the highest priority keyword (KW1), the record is returned.

(d) If any record matches one of non-highest priority keywords (KW2, KW3 ... KW7 ), this record is saved in buffer. And DDTool continues to search for other records. 

(e) In the searching process, if any record matches a keyword with another non-highest priority keyword which has a higher priority than the current buffered one, the new record is saved in buffer to replace the old one. 

(f) The searching process won’t stop until (c) or all driver records in the current category are compared.  In the latter situation, if DDTool only finds some record(s) matched with non-highest priority keyword(s), the buffered record is returned. If DDTool doesn’t find any record, null is returned.

(step 2) If a record is returned from searching Solaris bundled driver, and this driver is supported by both of 32-bit and 64-bit6 Solaris OS, this record is the result.
    Otherwise, if there is only 32-bit Solaris bundled driver available. This record is saved in buffer, and go through third-party records continuely following rule (a), (c) ~ (f) to search a 64-bit driver. 

(step 3) If a record is returned from searching third-party driver, and this driver is supported by both of 32-bit and 64-bit Solaris OS, or it is supported by 64-bit Solaris OS only, the 32-bit Solaris bundled driver and 64-bit thrid-party driver are displayed in the final report. 
    Otherwise, the tool continuely go through  OpenSolaris records following rule (a), (c) ~ (f). 

(step 4) If a record is returned from searching OpenSolaris driver, and this driver is supported by both of 32-bit and 64-bit Solaris OS, or it is supported by 64-bit Solaris OS only, the 32-bit Solaris bundled driver and 64-bit OpenSolaris driver are displayed in the final report. 
    Otherwise, there is only the 32-bit Solaris bundled driver displayed in the report.

Note: Since the classcode-drivername mapping table is only available for Solaris Bunlded driver now, the step of (b) is not useful for searching third-party of OpenSolaris driver.
</pre><h4 id="H5.2.3SearchingXorgDriverDB"><span>5.2.3 Searching Xorg Driver DB</span></h4><pre>
DDTool searches the corresponding Xorg driver status for a video device in the Xorg Driver DB.

(Step 1)
    (1.1) If a device's kernel driver name is 'nvidia', its Xorg driver name is 'nvidia'. In this case, DDTool returns and appends 'nvidia' to its kernel driver name.
    (1.2) If a device's kernel driver is a third party one, its Xorg driver name is the same as the third party kernel driver name. In this case, DDTool returns and appends the same name to its kernel driver name.
    (1.3) If a device has a Solaris kernel driver which is not 'nvidia', DDTool begins to searche each record in Xorg Driver DB with a single keyword which is "pci&lt;vendor_id&gt;,&lt;device_id&gt;" (KW5).

(Step 2) DDTool reads a line from Xorg Driver DB, split it into 2 strings, and extracts the first string as the key-value of this record.

(Step 3) In any record matches KW5, the record is the result record, and DDTool returns and appends the Xorg driver name contained in this record to this device's kernel driver name.

(Step 4) After DDTool searches all records in Xorg Driver DB, if there is no any record matching KW5 of this device, that means this video device has no Xorg driver. DDTool just returns without any other action.
</pre><h2 id="H6.GenerateReport"><span>6. Generate Report</span></h2><p>The report data will be sorted and formatted again to create the final report which could be displayed by UI.<br/>The field of 'device type' in final report is filled while creating final report. For each device, DDTool judges its type with its class code. Currently, DDTool divides all PCI devices into 7 types: 'Storage', 'Network', 'Video', 'Wireless', 'USB', 'Firewire' and 'Other', and build a map between class code and device type simply in the program.</p><h2 id="H7.Reference"><span>7. Reference</span></h2><p><span class="wikiexternallink"><a href="http://www.sun.com/bigadmin/hcl/hcts/device_detect.jsp">Sun Device Detection Tool web site</a></span></p><p><span class="wikilink"><a href="/bin/view/Project+ddtool/">Device Detection Tool Open Project Page</a></span></p><p><span class="wikiexternallink"><a href="http://developers.sun.com.cn/blog/sddtool/">Chinese Blog for Sun Device Detection Tool</a></span></p><p><span class="wikiexternallink"><a href="http://blogs.sun.com/moonocean/">Developer’s Blog</a></span></p>
</div>


    <div class="clearfloats"></div>
  </div>      <div id="xdocFooter">
  
                

       <div class="doc-tags" id="xdocTags">
        Tags:
        </div>
  
  <div id="xdocAuthors">
    <div class="xdocCreation">       Created by admin on 2009/10/26 12:13<br/>
          </div>
    <div class="xdocLastModification">       Last modified by admin on 2009/10/26 12:40
    </div>
  </div>
</div>
<div id="xwikidata" class="layoutsubsection">
        </div>  
    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Project ddtool Pages</h1>
<div class="xwikipanelcontents">
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Project+ddtool/designdoc">Design Document</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ddtool/files">Files</a></span></li>
</ul>
                    </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2011, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
