<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>Using virt-install to Install a Domain (Community Group xen.virtinstall) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Community+Group+xen/virtinstall" />
                    <link rel="canonical" href="/bin/view/Community+Group+xen/virtinstall" />
                            <meta name="document" content="Community Group xen.virtinstall"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Community Group xen"/>
    <meta name="page" content="virtinstall"/>
    <meta name="version" content="6.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Community+Group+xen/pages/virtinstall"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="Using virt-install to Install a Domain" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="johnlev" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/fullScreen.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Community Group xen";
XWiki.currentPage = "virtinstall";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Community+Group+xen/virtinstall";
window.docediturl = "/bin/edit/Community+Group+xen/virtinstall";
window.docsaveurl = "/bin/save/Community+Group+xen/virtinstall";
window.docgeturl = "/bin/get/Community+Group+xen/virtinstall";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/viewers/code.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/fullScreen.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Community_Group_xen viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FCommunity%2BGroup%2Bxen%2Fvirtinstall%3Fviewer%3Dcode%26%2338%3Blanguage%3Den"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+xen/"><strong>Community Group xen</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Community+Group+xen" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <table style="width: 100%;">
        <tr>
            <td style="width: 1%;">
                 <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>  
            </td>
            <td id="logo-text" style="width: 1%;">
                Solaris
            </td>         
            <td style="width: 98%;">
                <table id="loading-indicator">
                    <tr>
                        <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
                                 alt="Loading" title="Loading"/></td>
                        <td>Loading...</td>
                    </tr>
                </table>
            </td>
            <td style="width: 1%;">
                <table id="iconbar">
                    <tr>
                    <td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
                        Collectives</a></td>
                    <td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
                            Discussions</a></td>
                    <td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
                            Documentation</a></td>
                    <td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
                            Download</a></td>
                    <td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
                            Source Browser</a></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                              <a href='/bin/view/Community+Group+xen/docs'>Documentation</a> <span class='separator'>&#187;</span> <span class='current'>Using virt-install to Install a Domain</span>
                </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
        <a href="/bin/view/Community+Group+xen/virtinstall?language=en" class="language-default language-current">en</a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
        <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Community+Group+xen/virtinstall?format=pdf&amp;language=en" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+xen/virtinstall?format=rtf&amp;language=en" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Community+Group+xen/virtinstall?format=html&amp;language=en" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Community+Group+xen/virtinstall?viewer=code&amp;language=en"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Community+Group+xen/virtinstall?viewer=comments&amp;language=en" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+xen/virtinstall?viewer=attachments&amp;language=en" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+xen/virtinstall?viewer=history&amp;language=en" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+xen/virtinstall?viewer=information&amp;language=en" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Community+Group+xen/virtinstall?viewer=code&amp;language=en" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Community+Group+xen/virtinstall?xpage=print&amp;language=en" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          </span></div>
</div>

    </div>
    <div id="mainContentArea">
      


<div id="document-title"><h1>Wiki source code of <a href="/bin/view/Community+Group+xen/virtinstall">Using virt-install to Install a Domain</a></h1></div>
                <div id="document-info">
    <div>
                      <span id="contentshortcut"><a href="/bin/view/Community+Group+xen/virtinstall?viewer=content">Content</a></span>
          </div>
    <div class="clearfloats"></div>
  </div>







<div>
  <a href="/bin/view/Community+Group+xen/virtinstall?viewer=code&amp;showlinenumbers=0&amp;language=en" id="toggleLineNumbers">Hide line numbers</a>
                                  <textarea readonly="readonly" class="wiki-code" rows="25" cols="80">
  1: = Using virt-install to Install a Guest
  2: 
  3: **Note**: this page describes the latest OpenSolaris xVM bits. Older versions may work differently.
  4: 
  5: The command-line utility virt-install is used for installing new guest domains. In general, you specify an installation source, some disk storage and networking, and some other parameters. You will then go through the guest OS installation process. After virt-install is done, the OS will be installed, and its configuration available via virsh. virt-manager is an alternative if you want a graphical guest installation tool. virt-install must be run as the root user.
  6: 
  7: Below we'll show some typical invocations you might do. For more detailed information see [[the man page&gt;&gt;http://docs.sun.com/app/docs/doc/819-2240/virt-install-1m?l=en&amp;a=view]] and the [[System Administration Guide: Virtualization Using the Solaris Operating System&gt;&gt;http://docs.sun.com/app/docs/doc/819-2450/gfqsj?l=en&amp;a=view]].
  8: 
  9: == Configuring disk storage
 10: 
 11: The ~--disk option allows you to specify storage for a guest. xVM supports a number of different storage types, with various trade-offs. Some common choices are given below.
 12: 
 13: === Configuring a ZFS volume
 14: 
 15: {{{
 16: --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol
 17: }}}
 18: 
 19: This example creates a 10Gb [[ZFS volume&gt;&gt;http://docs.sun.com/app/docs/doc/819-5461/gaypf?l=en&amp;a=view]]. A ZFS volume enables all the features of ZFS (checksumming, snapshots, [[cloning&gt;&gt;Community Group xen.cloning-domains]], etc.) to be used for guest storage. However, it means that a guest cannot be easily migrated onto a different system without transferring the storage separately (via zfs send or whatever), so this is not a good choice for guests you want to live migrate.
 20: 
 21: Note that tank is a ZFS filesystem mounted on the dom0 at /tank, and we're specifying the dataset path. Unlike the zfs utilities, though, we currently have to prefix the path with a leading slash. Any intermediate datasets (here, guests/dom1) will be created as needed.
 22: 
 23: === Configuring a vdisk on a local filesystem
 24: 
 25: {{{
 26: --disk path=/guests/dom1/disk0,size=10,driver=tap,subdriver=vdisk,format=vmdk
 27: }}}
 28: 
 29: A VMDK format [[vdisk&gt;&gt;http://docs.sun.com/app/docs/doc/819-2240/vdiskadm-1m?a=view]] is virt-install's default if a directory path is given, or the path doesn't exist. This creates (or uses) a directory containing configuration information along with the files containing the image. Snapshotting and other features are provided by vdiskadm.
 30: 
 31: As well as VMWare's VMDK format, vdisks also support VHD (Microsoft's format) and VDI (VirtualBox's format). In general, VMDK is best-performing and most widely supported. Use format=vhd or format=vdi to choose these disk formats.
 32: 
 33: === Configuring a vdisk over NFS
 34: 
 35: {{{
 36: --disk path=/net/nfshost/guests/dom1/disk0,size=10,driver=tap,subdriver=vdisk,format=vmdk
 37: }}}
 38: 
 39: As vdisks can be stored on an NFS server, they are a good choice if you want to live migrate the guest, although remember the path to the vdisk must be exactly the same on each dom0 host.
 40: 
 41: For successful creation and use of a vdisk hosted on NFS, the user xvm on the dom0 host must have write permission for the given path. This may involve setting ACLs on the NFS host, or simply a chown of the containing directory to the xvm user or user ID 60.
 42: 
 43: === Configuring an iSCSI volume
 44: 
 45: {{{
 46: --disk path=/alias/0/iscsi/dom1/disk0,driver=phy,subdriver=iscsi
 47: }}}
 48: 
 49: iSCSI is a networked block device. The example above uses a pre-existing iSCSI target with the alias iscsi/dom1/disk0, and LUN 0. This is useful if you have already configured iSCSI on your dom0 and have volumes available in iscsiadm list target.
 50: 
 51: In addition to an alias, a volume can be specified by its LUN and target ID: path=/discover/0/iqn.1986-03.com.sun:02:d5ab1c26-0a7a-c6b4-98f8-d6d267eb2561. In general, it's simpler to use the Alias given for the target.
 52: 
 53: Finally, you can create a static config, in which case the volume is discovered, configured, and de-configured for you automatically. For example, given an iSCSI target at 192.168.0.70, LUN 0, and a target ID, you might specify path=/static/192.168.0.70/0/iqn.1986-03.com.sun:02:d5ab1c26-0a7a-c6b4-98f8-d6d267eb2561.
 54: 
 55: === Configuring a raw physical disk
 56: 
 57: {{{
 58: --disk path=/dev/dsk/c0t1d0s4,driver=phy
 59: }}}
 60: 
 61: You can use a block device accessible to dom0 for guest storage. This can be the best-performing method, but doesn't allow any kind of higher-level facilities such as snapshotting. It is also difficult to live-migrate if the device refers to a local disk drive.
 62: 
 63: === Configuring a raw file
 64: 
 65: {{{
 66: --disk path=/guests/dom1/disk0.img,size=10,driver=file
 67: }}}
 68: 
 69: Raw files are not recommended: it's almost always better to use one of the above methods instead. In particular, attempting to use raw files on a ZFS filesystem will be woefully slow.
 70: 
 71: == Configuring networking
 72: 
 73: You can specify networking for the guest via the ~--network option. Almost always, you will want to share a bridge amongst guest domains, but you can also dedicate an unused NIC, or perform host-only networking via an etherstub.
 74: 
 75: Most likely, you will want your guest OS to use DHCP to configure its networking setup. For this to work, a DHCP server must be available on the virtual network. By default, virt-install will automatically create a random MAC address for the guest with the Xen [[OUI&gt;&gt;http://standards.ieee.org/regauth/oui/index.shtml]]. If, however, your DHCP server doesn't hand out addresses to unknown clients, you will need to specific a MAC address configured as a client on the DHCP server. In addition, most PXE and JumpStart setups require a specified MAC address.
 76: 
 77: The mac= setting for the ~--network option can be used to do this: be careful to specify a valid MAC address - not much validation is done. In the examples, we presume that you don't need this option.
 78: 
 79: If you are running Xen on a laptop with a wireless connection as your primary NIC, you cannot use bridged mode, as the wireless chipsets typically reject any unknown MAC addresses. In this case, you can use an etherstub.
 80: 
 81: === Configuring a bridge
 82: 
 83: {{{
 84: --network bridge=e1000g0
 85: }}}
 86: 
 87: Bridged networking is used for ethernet-based sharing of a physical network resource. In the example above, a VNIC is created on top of the dom0 interface e1000g0. Alternatively, you can just specify ~--network bridge, in which case a host NIC will be automatically chosen (typically, the first UP interface on which a VNIC can be created). In fact, this is preferred, as it allows a guest domain's config to be migrated to host machines using a different NIC as the bridge.
 88: 
 89: Any traffic for the guest's MAC address is sent to the guest via the VNIC. VNICs configured on the system can be shown via dladm show-vnic. This VNIC is automatically removed once the domain is no longer running.
 90: 
 91: === Configuring a dedicated NIC
 92: 
 93: Specifying a network-setup script of vif-dedicated allows a guest to directly use a NIC on the host, without going through a VNIC. The NIC should not be configured on the host dom0. As of June 2009, it's not possible to configure this via virt-install. To add such a NIC after installation:
 94: 
 95: {{{
 96: virsh attach-interface dom1 bridge e1000g0 --script vif-dedicated
 97: }}}
 98: 
 99: === Configuring an etherstub
100: 
101: {{{
102: dladm create-etherstub stub0
103: dladm set-linkprop -p mtu=1500 stub0
104: ...
105: ... --network bridge=stub0
106: }}}
107: 
108: If you specify an etherstub as your bridge NIC, then you have a form of host-only networking: no packets can leave the virtual network created on top of stub0, as it is not connected to any physical interface. An MTU of 1500 (not the default 9000) is required.
109: 
110: You would typically then install from an ISO. For a network installation to work, you'll have to provide network services on top of the etherstub (for example, another guest might be connected to the etherstub to provide an NFS server).
111: 
112: === Configuring a VLAN
113: 
114: {{{
115: --network bridge,vlanid=2
116: }}}
117: 
118:  To configure a guest to use a particular VLAN ID, use the vlanid setting. For more information, see [[here&gt;&gt;Community Group xen.Bandwidth_VLAN_ID]].
119: 
120: === Configuring bandwidth control
121: 
122: {{{
123: --network bridge,capped-bandwidth=200M
124: }}}
125: 
126: The capped-bandwidth setting configures Crossbow bandwidth control. For more information, see [[here&gt;&gt;Community Group xen.Bandwidth_VLAN_ID]].
127: 
128: === Configuring a network mask
129: 
130: {{{
131: --extra-args &quot;-B subnet-mask=255.255.254.0&quot;
132: }}}
133: 
134: If you have a non-standard network mask, the guest OS's default may not be sufficient. This example tells a Solaris guest to use a mask of 255.255.254.0. Any such options are guest-specific. Note that the ~--extra-args option only apples to -paravirt installations.
135: 
136: == Accessing the guest console
137: 
138: By default, virt-install will attempt to connect to the guest's console when it starts, to allow an interactive installation. If you want to use a text-console install, the ~--nographics option can be used. In that case, the guests' console is routed to the terminal from which you invoke virt-install.
139: 
140: Alternatively, specifying ~--vnc will configure a virtual frame-buffer. In general, this works for both HVM and para-virtual guests, but there are some variations, as shown below.
141: 
142: If you're running virt-install in a graphical environment (that is, $DISPLAY is set, then it will start a VNC viewer connected to the guest console for you. Otherwise, you will see a message like this:
143: 
144: {{{
145: Unable to connect to graphical console; DISPLAY is not set.  Please connect to localhost:5900
146: Domain installation still in progress. Waiting for domain to complete installation.
147: }}}
148: 
149: Keep the virt-install process running, and connect to the VNC viewer given. Note that if you are connecting from a remote host (not dom0), you will have to configure [[dom0 VNC access&gt;&gt;Community Group xen.configuring-dom0]] before starting virt-install.
150: 
151: == Full examples
152: 
153: === Installing an OpenSolaris guest from an ISO
154: 
155: {{{
156: virt-install --paravirt --name dom1 --ram 1024 --nographics \
157:  --os-type=solaris --os-variant=opensolaris \
158:  --network bridge \
159:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
160:  --location /isos/osol-200906.iso
161: }}}
162: 
163: Installs OpenSolaris onto a ZFS volume from the ISO /isos/osol-200906.iso. 1024 megabytes is the recommended minimum for Solaris. As Solaris [[doesn't yet support&gt;&gt;http://bugs.opensolaris.org/bugdatabase/view_bug.do?bug_id=6634617]] a para-virtualized frame buffer, we start up a text install. After the guest starts, follow [[these instructions&gt;&gt;Community Group xen.opensolaris_domu]] to access the graphical installer.
164: 
165: Note that OpenSolaris currently requires networking configuration to happen via DHCP.
166: 
167: === Installing an OpenSolaris automated-install guest
168: 
169: {{{
170: virt-install --paravirt --name dom1 --ram 1024 --nographics \
171:  --os-type=solaris --os-variant=opensolaris \
172:  --network bridge \
173:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
174:  --location http://10.0.0.1:5555/space/images/osol_111b \
175:  --autocf install_service=myservice
176: }}}
177: 
178: Installs an OpenSolaris guest using the 'myservice' AI install service from a given install media. Note that you /must/ use the IP address of the install server, not its hostname.
179: 
180: {{{
181: virt-install --paravirt --name dom1 --ram 1024 --nographics \
182:  --os-type=solaris --os-variant=opensolaris \
183:  --network bridge \
184:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
185:  --location http://10.0.0.1:5555/space/images/osol_111b \
186:  --autocf &quot;&quot;
187: }}}
188: 
189: Installs an OpenSolaris guest, where the guest should self-discover its install service (note: in 2009.06, AI does not yet have this capacity, but it is one of the features being investigated by the development team).
190: 
191: === Installing a Windows guest
192: 
193: {{{
194: virt-install --hvm --name dom1 --ram 512 --vnc \
195:  --os-type=windows --os-variant=win2k \
196:  --network bridge \
197:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
198:  --cdrom /isos/osol-200906.iso
199: }}}
200: 
201: Since Windows doesn't have a full-PV mode, we specify --hvm for the virtualization type, and point to the installation ISO with --cdrom.
202: 
203: With Windows installs, the guest will reboot during the installation. virt-install will keep running during this guest reboot and ensure the installation media is presented to the guest as needed.
204: 
205: === Installing a Linux guest over HTTP
206: 
207: {{{
208: virt-install --paravirt --name dom1 --ram 1024 --vnc \
209:  --os-type=linux --os-variant=fedora8 \
210:  --network bridge \
211:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
212:  --location http://fedora.mirror.facebook.net/linux/releases/10/Fedora/x86_64/os/
213: }}}
214: 
215: Some versions of Linux, such as CentOS, Fedora, and others, can install directly from HTTP. Choose a suitable mirror nearest your host dom0.
216: 
217: Note that some Linux versions such as Fedora 10 will [[not successfully install with --nographics&gt;&gt;https://bugzilla.redhat.com/show_bug.cgi?id=504033]], and also have problems starting X: a text install via VNC works, however.
218: 
219: Some distributions allow you to change the RTC setting (for example, Fedora has a &quot;System clock uses UTC&quot; checkbox). If there is such an option, leave it as UTC: even though Solaris dom0 uses a localtime RTC, the system ensures the RTC is virtualized correctly for Linux, as long as you specify the ~--os-type flag.
220: 
221: === Installing a Linux guest from an ISO image
222: 
223: {{{
224: mount -F hsfs /isos/opensuse11.iso /mnt
225: share -o ro /mnt
226: 
227: virt-install --paravirt --name dom1 --ram 1024 --vnc \
228:  --os-type=linux --os-variant=sles10 \
229:  --network bridge \
230:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
231:  --location nfs:nfshost.domain.com:/mnt
232: }}}
233: 
234: If you cannot do an HTTP install, your other option is to use NFS-over-ISO. Since Linux is unable to do ~--paravirt installs from an ISO image, you have to share the ISO image over NFS, and install that way.
235: 
236: Make sure to specify the FQDN of your NFS host. Typical Linux installations insist on using DNS to resolve the names, so won't be able to find partial names like nfshost.domain.
237: 
238: === Installing a Solaris 10 guest from an ISO
239: 
240: {{{
241: virt-install --hvm --name dom1 --ram 1024 --vnc \
242:  --os-type=solaris --os-variant=solaris10 \
243:  --network bridge \
244:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
245:  --cdrom /isos/s10u7.iso
246: }}}
247: 
248: Solaris 10 only supports HVM mode. It's recommended to use at least Solaris 10 Update 7, though earlier versions also work.
249: 
250: === Installing a Solaris guest with PXE
251: 
252: {{{
253: virt-install --hvm --name dom1 --ram 1024 --vnc \
254:  --os-type=solaris --os-variant=solaris10 \
255:  --network bridge,mac=00:16:3e:1b:e8:18 \
256:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
257:  --pxe
258: }}}
259: 
260: Presuming you have a PXE server set up waiting for the given MAC address, this example will start up an Solaris guest via PXE boot. Note that only HVM guests support PXE currently.
261: 
262: === Installing a Solaris Nevada guest over NFS
263: 
264: {{{
265: virt-install --paravirt --name dom1 --ram 1024 --nographics \
266:  --os-type=solaris --os-variant=opensolaris \
267:  --network bridge,mac=00:16:3e:1b:e8:18 \
268:  --disk path=/tank/guests/dom1/disk0,size=10,driver=phy,subdriver=zvol \
269:  --location nfs:netinstall.sfbay.sun.com:/export/nv/x/latest/ \
270:  --extra-args &quot;-B subnet-mask=255.255.254.0&quot;
271: }}}
272: 
273: This is similar to the OpenSolaris ISO install, except that we're installing over NFS. In this case, we've chosen to specify a particular MAC address. We also have a non-standard subnet mask, so need to add that. Unlike OpenSolaris, Nevada has a text installer, so you can install directly from the console (this is recommended).
</textarea>
</div>

    <div class="clearfloats"></div>
  </div>    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Community Group xen Pages</h1>
<div class="xwikipanelcontents">
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/Migration+dry%2Drun">Migration+dry&#45;run</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/OVFsupport">Basic Open Virtualization Format Support</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/UpdatedFeatures">Updated Features</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/demos">Demonstrations</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/xvmscreencast">xVM Screencast</a></span></li>
</ul></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/devdocs">Developer documentation</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/developers">Xen For OpenSolaris Developers</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/install%2Ddepedencies">xVM Dependencies on Installer/LiveCD layouts</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/xVMTests">xVM Tests</a></span></li>
</ul></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/docs">Documentation</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/2008_11_dom0">How to Set up OpenSolaris as a dom0</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/Bandwidth_VLAN_ID">Configuring VLAN and bandwidth limits for a VNIC</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/SolarisAsGuestHost">Known Issues With Running Solaris OS as a Host and Guest on Different Virtualization Platforms</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/changing%2Dboot%2Dflags">Changing domU boot flags</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/cloning%2Ddomains">Cloning ZFS&#45;based domains</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/configuring%2Ddom0">Configuring dom0</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/guest%2Dcompatibility">Guest types known to work and not work</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/linux%2Ddom0">How To Install an OpenSolaris domU on a Linux dom0</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/manpages">Official docs</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/opensolaris_domu">How to Set up OpenSolaris as a Paravirtual Guest</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/serial%2Dconsole">Enabling serial console for the hypervisor</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/setupvnc">VNC access to guest domains</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/virtinstall">Using virt&#45;install to Install a Domain</a></span></li>
</ul></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/goals%2Dof%2Dthe%2Dproject">Goals of Project</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/help">Getting help</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/virtcfg+virtadm">virtcfg &amp; virtadm: making xVM guest administration easy</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/virtcfg%2Bvirtadm">virtcfg+virtadm</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/xVM+Visual+Panel">xVM Visual Panel</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/xdt+dtrace">xdt+dtrace</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/xen_faq">FAQ</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Community+Group+xen/sunxvmfaq">Sun's Announcement on Sun xVM hypervisor</a></span></li>
</ul></li>
</ul>
                              </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2012, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
