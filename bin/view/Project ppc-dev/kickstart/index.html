<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>Kickstarting OpenSolaris on PowerPC (Project ppc-dev.kickstart) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Project+ppc%2Ddev/kickstart" />
                    <link rel="canonical" href="/bin/view/Project+ppc%2Ddev/kickstart" />
                            <meta name="document" content="Project ppc-dev.kickstart"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Project ppc-dev"/>
    <meta name="page" content="kickstart"/>
    <meta name="version" content="1.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Project+ppc-dev/pages/kickstart"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="Kickstarting OpenSolaris on PowerPC" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="admin" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Project ppc-dev";
XWiki.currentPage = "kickstart";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Project+ppc%2Ddev/kickstart";
window.docediturl = "/bin/edit/Project+ppc%2Ddev/kickstart";
window.docsaveurl = "/bin/save/Project+ppc%2Ddev/kickstart";
window.docgeturl = "/bin/get/Project+ppc%2Ddev/kickstart";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Project_ppc-dev viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FProject%2Bppc-dev%2Fkickstart"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+ppc%2Ddev/"><strong>Project ppc-dev</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Project+ppc%2Ddev" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <table style="width: 100%;">
        <tr>
            <td style="width: 1%;">
                 <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>  
            </td>
            <td id="logo-text" style="width: 1%;">
                Solaris
            </td>         
            <td style="width: 98%;">
                <table id="loading-indicator">
                    <tr>
                        <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
                                 alt="Loading" title="Loading"/></td>
                        <td>Loading...</td>
                    </tr>
                </table>
            </td>
            <td style="width: 1%;">
                <table id="iconbar">
                    <tr>
                    <td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
                        Collectives</a></td>
                    <td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
                            Discussions</a></td>
                    <td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
                            Documentation</a></td>
                    <td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
                            Download</a></td>
                    <td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
                            Source Browser</a></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                  <span class='current'>Kickstarting OpenSolaris on PowerPC</span>
          </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
        <a href="/bin/view/Project+ppc%2Ddev/kickstart?language=en" class="language-default language-current">en</a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
          <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Project+ppc%2Ddev/kickstart?format=pdf&amp;language=en" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+ppc%2Ddev/kickstart?format=rtf&amp;language=en" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+ppc%2Ddev/kickstart?format=html&amp;language=en" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+ppc%2Ddev/kickstart?viewer=code&amp;language=en"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Project+ppc%2Ddev/kickstart?viewer=comments&amp;language=en" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ppc%2Ddev/kickstart?viewer=attachments&amp;language=en" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ppc%2Ddev/kickstart?viewer=history&amp;language=en" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ppc%2Ddev/kickstart?viewer=information&amp;language=en" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Project+ppc%2Ddev/kickstart?viewer=code&amp;language=en" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Project+ppc%2Ddev/kickstart?xpage=print&amp;language=en" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          <span class="submenuitem "><a href="/bin/view/Project+ppc%2Ddev/kickstart?xpage=copy" id="tmActionCopy" class="tmActionCopy">Copy</a></span>
      </span></div>
</div>

    </div>
    <div id="mainContentArea">
      








    
<div id="document-title"><h1>Kickstarting OpenSolaris on PowerPC</h1></div>





              <div id="document-info">
    <div>
          </div>
    <div class="clearfloats"></div>
  </div>

<div id="xwikicontent">
<h3 id="HOverviewoftheKickstart"><span>Overview of the Kickstart</span></h3><p>Sun Labs is providing a kickstart to the code base for OpenSolaris on PowerPC. While there has been much discussion and perhaps some confusion from the beginning of OpenSolaris about PowerPC, Power and what progress has actually been made towards the goal of a full port, the contribution here on this project is essentially the tangible work in progress.&nbsp;</p><p>What it is now</p><ul><li>32bit - G4 class processor</li><li>big endian ordering</li><li>single processor</li><li>statically linked unix/genunix</li><li>kernel boot up to vfs_mountroot</li><li>cross compile environment on x86 host to PPC based target</li><li>debug with printf(), PMDB or Metrowerks PowerTAP or ABI2000 w/GDB&nbsp;</li><li>will run on Genesi ODW with 7457, EFIKA or PowerMac G4, MacMini</li><li>GCC and GNU toolchain dependent</li><li>fully open source in PPC platform, arch and psm&nbsp;</li></ul><p>What it is not (at the moment)</p><ul><li>64 bit</li><li>MP</li><li>legacy support for the 2.5.1 apps or targets</li><li>Sun Studio / Tools compatible</li><li>finished or complete solaris consolidation for the architecture</li></ul><p>Sun Labs will continue to work on this code base with the community and will assist interested developers to get started. Below are notes gathered when we first started and expect that people new to this project will find them useful.</p><h3 id="HGeneralIntegrationApproaches"><span>General Integration Approaches</span></h3><p>Much has changed in Solaris since the original 2.5.1 PowerPC release and that source is extremely dated. Above all the amount of effort required to legally review the source in order to release it, was prohibitive, thus Sun chose not to include it in OpenSolaris. Additionally the relevant parts of that source have already been incorporated into the contribution.</p><p>Copy and modify<br/>-<del>-<br/>Many aspects of the code development with the Solaris on PowerPC project are made by copying existing code and modifying. &nbsp;It is a judgement call, made on a case-by-case basis, what existing code to use as the starting point.</del></p><p>Sometimes, it is best to start from the old Solaris/PPC 2.6 code. This is almost always appropriate for small leaf nodes that deal more with instruction-set architecture, which has not changed much over the last decade. &nbsp;Other times, it seems better to start with modern (ONNV) code for another processor, and modify for PowerPC. This is more appropriate for things that interact with operating system services, where the interfaces may have changed considerably.</p><p>Then, there is the question of which processor to use as a starting point. &nbsp;Our current work on 32-bit PowerPC is more like x86 in some ways, but more like Sparc in other ways.</p><p>PowerPC is more like x86:</p><ol><li>Both are 32-bit only. &nbsp;Yes, there are 64-bit PowerPC machines, but we are not porting to those, yet. &nbsp;Yes, there are 64-bit x86 machines, but that is practically a different ISA, so we need not consider that for our purposes, here.&nbsp;</li><li>Both are little-endian, see note:1 , so layout of some data structures can be cribbed off of IA32 code.</li><li>Both carve out a portion of each userland process address space for the kernel address space, whereas sparc has its own completely separate kernel address space. <br/>1.There is no dynamic reconfiguration to deal with, so physical memory management is easier.</li></ol><p>PowerPC is more like sparc:</p><ol><li>Both are big-endian, see note:1, so layout of some data structures can be cribbed off of sparc code.</li><li>Both have 32 general-purpose (integer) registers, whereas x86 has significantly fewer registers and almost none are truly general-purpose. &nbsp;And, as a consequence ...</li><li>Both almost always pass all function arguments in registers, whereas x86 must almost always pass arguments on the stack.&nbsp;</li><li>Both have 32-bit, 64-bit, and 128-bit binary IEEE 754 floating-point and a set of directly addressed floating-point registers, whereas x86 has its own 80-bit extended format, and has a mixed bag of floating-point stack and SSE &nbsp;registers.</li><li>Both use some form of OpenFirmware.</li></ol><p>note:1 PowerPC can work in big-endian or little-endian mode. Solaris/PPC supports both. &nbsp;Solaris 2.6 code was little-endian only; Solaris 2.11 code is big-endian, but code is written to work both ways. &nbsp;Some libc functions were built using a merge of x86 and sparc code for 2.11, and Tim Marsland's 2.6 PPC big-endian workspace.<br/>&nbsp;</p><h3 id="HBuildingtheSources2CMakingitallWork"><span>Building the Sources, Making it all Work</span></h3><p>This is just a quick guide listed here.</p><p>The assumption is that you have already a working Solaris x86 host with GCC and the tools setup on it. You have downloaded and extracted the latest source tarball or pulled from the ppc-dev/ppc-dev svn workspace, now you need to make it all. You must configure your polaris.sh script and if this is the first time you building a fresh workspace you must run setup-polaris. These steps are outlined in a bit more detail the README.polaris file.</p><p>If your using the ODW or the EFIKA as your target you will need to run VOF (Virtual Open Firmware). A little more detail on VOF can be found at the <span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/openfirm">task map page</a></span></p><p>Next thing is to build NFS boot which produces the binary inetboot This is the 2nd level bootstrap that is loaded by OpenFirmware. When inetboot is started it will prompt you for the kernel you want to download. In the source tree look at the README.inetboot notes which will not only help you build it but also setup your tftp and nfs server.</p><p>Build your kernel using these steps in this order</p><pre>
    in usr/src/uts/make install~_h
    in usr/src/head/make install~_h
    in usr/src/stand/make install
    in usr/src/psm/make install
    in usr/src/uts/make install
</pre><p>More details on these notes can be found in README.polaris, or if there are still questions post them on the discussion list. The final binary will be created and found in usr/src/uts/chrp/unix/debug32 and in your $ROOT/platform/kernel. Then copy up your proto_root to your nfsroot dir and you're good to go.</p><p>Static Linking: The current makefile will do a post build link of unix <br/>and genunix for one large bin. This was done to assist the Metrowerks debugger with location of symbols. KRTLD will still do all the module run time linking. This is now done as part of the overall make process, but it is fairly straightforward to return to the separate unix / genunix approach. KRTLD will still do it's job stitching it all together.</p><h3 id="HTargetDownloadandBootingtheKernel"><span>Target Download and Booting the Kernel</span></h3><p>Currently the kernel boots progresses to the point of loading and executing a hand coded $ROOT/sbin/init on the Genesi ODW workstation. This involves mounting a network root file system and then will load and exec the test init app. You can see a sample output of the target's console at the <span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/status">Status Page</a></span>.</p><p>So simply put to get to the same point as we are you first need an Pegasos ODW Workstation and a tftpboot, nfsroot server. We typically use our solaris x86 host development system as the target server, but we have also a Debian Linux x86 box as a target server also. Once that is setup and you have a built kernel, you need to populate your nfsroot with your created proto_root. You also need</p><p>openfirmware - binary provided on the <span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/status">Project Extras Page</a></span></p><p>inetboot - built and found in usr/src/psm/stand/boot/ppc/chrp</p><p>Once the ODW has booted you need to alternately set the irq routing. We have multiple irqs on 9 and have to manually move the RHINE irq. Enter the following on the command line</p><p>The above will load VOF from the tftpboot, then type</p><pre>
    boot net -v
</pre><p>This will load inetboot and you're off and running. If you have our handcoded init in your sbin dir, it should load and exec.</p><h3 id="HTargetLimitations"><span>Target Limitations</span></h3><p>Currently the focus has been on the ODW target. The kernel will load on Macs and the EFIKA board but wil panic much earlier due to specific PIC and decrementer initialization work that needs to be completed.&nbsp;</p><h3 id="HHistoryofSolarisonPowerPC"><span>History of Solaris on PowerPC</span></h3><p>PPC/Solaris 2.51 release 1995-1997, it was a full up release and functional. Further development was continued into 2.6 but dropped during this release cycle. We here in the Labs have access to many of the team personnel that did this port and fortunately have worked with them directly on other projects. These critical relationships were important to leverage. We have access to the source for all of this, but the community does not. It appears that much of this code is essentially unusable in a direct sense but some parts do have relevant. It was not possible or even practical to release the 2.6 source base.&nbsp;</p><p>ON source code gates and releases</p><pre>
    gate         OS	Solaris
    ~----
    on495-gate   5.5     2.5
    on596-gate   5.5.1   2.5.1
    on297-gate   5.6     2.6
    on998-gate   5.7     2.7
    on29-gate    5.8     2.8
    on81-gate    5.9     2.9
    on10-gate    5.10    10
    onnv-gate    5.10.1  10.1 ?
</pre><p>ON gates contain no systematic self-describing information. This table was built using information dug up by hand, from some combination of three methods:</p><ol><li>browse public/README</li><li>browse public/schedule</li><li>extract RELEASE variables from the corresponding tools gate</li></ol><ul><li>&nbsp;Quick and dirty list of OS release number and date</li><li>&nbsp;Relies on convention that each "modern" release of</li><li>&nbsp;Solaris has a corresponding tools directory and it contains templates for build environment in a standard location.</li><li>&nbsp;Does not work for anything prior to 5.8<br/><em>&nbsp;&nbsp;Also,&nbsp;</em>-patch-tools is more reliable for determining original release information, because for some reason release dates are kept "up to date" in the non-patch version of the tools gate.</li></ul><p>What internal ON gates have support for PowerPC?</p><pre>
    on297-gate/usr/src/uts/ppc
    on596-gate/usr/src/uts/ppc
</pre><h3 id="HBuildEnvironment"><span>Build Environment</span></h3><p>We have started with GCC as the basic tool chain the community initially developed an x86 build environment on x86 solaris box. The long term goal of &nbsp;self hosting is still a ways off. Full GCC support for the OpenSolaris source is complete and GCC is required since the Sun Workshop tools do not put out PPC binaries. The community has played a big part in getting this environment up and source compilation with PPC output functioning.&nbsp;</p><p>binutils 2.16.1<br/>gcc 3.4.3</p><h3 id="HHardware2FTargetTools"><span>Hardware/Target Tools</span></h3><p>Sun Labs has been using the <span class="wikiexternallink"><a href="http://www.freescale.com/webapp/sps/site/prod_summary.jsp?code=ETHERNETTAP&amp;fsrch=1">Metrowerks PowerTAP</a></span> to bring up low levels parts of the kernel until the Virtual Memory Manager is up. It will essential to discuss further how the tools can be used once protected memory is in order. Metrowerks has a kernel aware debugger that can be interfaced with Solaris. We have had discussions with Freescale on how exactly this can be achieved. There is a doc that describes the interface to the kernel. KMDB is important to get functional early on. We also have GDB via serial console and <span class="wikiexternallink"><a href="http://www.abatron.ch/products/xr/aspx/r.6/Sv.63713d7b43526570313d7b693d4b4856504b473555463253494933533241344a4c7d7d/rx/products_detail.htm">Abatron BDI 2000</a></span> &nbsp;with GDB support.</p><ul><li>Notes on target debugging.&nbsp;</li></ul><p>With the OpenSolaris on PowerPC project we have been working with a few targets to date. The ODW from Genesi and the PowerMacs/MacMini from Apple. The <span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://www.opensolaris.org/os/project/ppc-dev/"><span class="wikigeneratedlinkcontent">http://www.opensolaris.org/os/project/ppc-dev/</span></a></span> page has more detailed information on these targets. The basic requirement is that a target runs OpenFirmware.<br/>-<del>-</del></p><ul><li>Debugger Options</li></ul><p>We have 2 at this time. Good old console output that can be seen from the serial port on the ODW or directly to the display if you're using a PowerMac based target. The second choice and the way most of this early development has been done, is with the Metrowerks Codewarrior JTAG debugger from Freescale. This is a HW emulator and IDE that is hosted on a Linux system and downloads the kernel or it's associated pieces (inetboot, krtld, etc) directly to the target's memory, jump to entry and run. You have full source level debugging, stepping, breakpoints and a rich set of tools that give you insight into all levels of the hardware, regs, memory I/O, etc.</p><p>For general info and overview go to <span class="wikiexternallink"><a href="http://www.freescale.com/webapp/sps/site/overview.jsp?nodeId=01272694012309">Metrowerks TAP</a></span></p><p>In order to use this tool the target hardware needs to have the JTAG port "brought out" to a pins that can be accessed with the emulators connector. The ODW has this option designed in, unfortunately the PowerMacs do not. All of our low level bringup has been done on the ODW board. We expect that the community will be using the printf approach until KMDB or GDB is up on the target.</p><h3 id="HWhySunLabs3F"><span>Why Sun Labs?</span></h3><p>Sun Labs was uniquely positioned to be a main player in this early effort because of it's PPC HW &amp; tools expertise, embedded experience, relationships internally and externally and past history. Sun Labs is about research yet the team here found many aspects of this project beneficial this effort is generally straightforward knowing that a Solaris PPC port was done in 1995. Sun Labs will act as a direct interface between the community and Sun internals providing information, source and resources that cannot be gained otherwise.</p><h3 id="HSunLabsGoalforthe1stRelease"><span>Sun Labs Goal for the 1st Release</span></h3><p>We will focus on the areas such that enough of a kernel is booting to allow the community to be effective. The community has chosen the Genesi PegasosII based ODW with the Freescale MPC7447 as the cpu. This is a community effort but we are focusing on the pieces that we feel that Sun Labs can contribute to directly and have coordinated these efforts. The immediate goal that the Sun Labs team is committed to with the OpenSolaris PPC community is achievement of a booting, initialized and functional OpenSolaris kernel on a 32 bit PPC architecture with KMDB, GDB, network connection and a serial console in hopefully a reasonable timeframe.</p>
</div>


    <div class="clearfloats"></div>
  </div>      <div id="xdocFooter">
  
                

       <div class="doc-tags" id="xdocTags">
        Tags:
        </div>
  
  <div id="xdocAuthors">
    <div class="xdocCreation">       Created by admin on 2009/10/26 12:17<br/>
          </div>
    <div class="xdocLastModification">       Last modified by admin on 2009/10/26 12:17
    </div>
  </div>
</div>
<div id="xwikidata" class="layoutsubsection">
        </div>  
    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Project ppc-dev Pages</h1>
<div class="xwikipanelcontents">
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/GetStarted">Getting Started</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/faq">FAQ</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/files">Files</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/kickstart">Kickstarting OpenSolaris on PowerPC</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/status">Status</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/task_map">Project Task Map</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/atomic">Low Level Atomic Operations</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/bld_env">GNU Toolchain and Host Environment</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/boot_ldr">Bootloader &#45; Net/Disc</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/cache_behav">Cache Behavior</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/cbe">Cyclic Backend &#45; Timers</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/chk_res">Checkpoint and Restore</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/console">Console Items</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/ctf">CTF &#45; Compressed Text Format</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/ddi">DDI &#45; Device Driver Interface</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/dtrace">DTrace</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/hw_tools">Hardware Tools for the Target</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/inst">Installer</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/ism">ISM</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/kern_init">Kernel Inititalization</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/kmdb_mdb">KMDB / MDB / PMDB</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/krn_swtch">Kernel  Context Switching</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/krtld">Kernel Runtime Loader</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/modstubs">Module Stubs</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/mp">MP Support</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/openfirm">Openfirmware &#45; VOF</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/panic">Panic Handling</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/psm">Platform Specific Modules</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/root_nex">Root Nexus</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/rtld_ld">RTLD and ld</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/sys_calls">System Calls</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/traps">Exceptions, Traps and Interrupts</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/usr_libs">User Libraries</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/usr_swtch">User Context Switching</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/vm">Virtual Memory &#45; HAT</a></span></li>
</ul></li>
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/tools">Project Tools</a></span><ul class="star">
<li><span class="wikilink"><a href="/bin/view/Project+ppc%2Ddev/proj_xtra">Project Extras</a></span></li>
</ul></li>
</ul>
                              </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2012, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
