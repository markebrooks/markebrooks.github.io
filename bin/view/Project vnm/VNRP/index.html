<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                                    <title>Virtual Network Router Appliance Project (Project vnm.VNRP) - XWiki</title>
                <meta http-equiv="Content-Script-Type" content="text/javascript" />
                        <meta http-equiv="imagetoolbar" content="no"/>
                      <link rel="alternate" type="application/x-wiki" title="Edit" href="/bin/edit/Project+vnm/VNRP" />
                    <link rel="canonical" href="/bin/view/Project+vnm/VNRP" />
                            <meta name="document" content="Project vnm.VNRP"/>
    <meta name="wiki" content="xwiki"/>
    <meta name="space" content="Project vnm"/>
    <meta name="page" content="VNRP"/>
    <meta name="version" content="3.1"/>
    <meta name="restURL" content="/rest/wikis/xwiki/spaces/Project+vnm/pages/VNRP"/>
                <meta name="gwt:property" content="locale=en" />
                <meta name="revisit-after" content="7 days" />
<meta name="description" content="Virtual Network Router Appliance Project" />
<meta name="keywords" content="wiki " />
<meta name="distribution" content="GLOBAL" />
<meta name="rating" content="General" />
<meta name="author" content="admin" />
<meta http-equiv="reply-to" content="" />
<meta name="language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel="alternate" type="application/rss+xml" title="Wiki Feed RSS" href="/bin/view/Main/WebRss?xpage=rdf" />
<link rel="alternate" type="application/rss+xml" title="Blog RSS Feed" href="/bin/view/Blog/GlobalBlogRss?xpage=plain" />
<link rel="shortcut icon" href="/resources/icons/oso/icon.png">
                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
<link href="https://markebrooks.github.io/static/css/stylesheet.css" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/style.css?colorTheme=ColorThemes.Oso" rel="stylesheet" type="text/css" media="all" />
<link href="/bin/skin/skins/colibri/print.css" rel="stylesheet" type="text/css" media="print" />
        <!--[if IE]>
  <link href="/bin/skin/skins/colibri/ie%2Dall.css" rel="stylesheet" type="text/css" />
<![endif]-->
<!--[if IE 6]>
  <link href="/bin/skin/skins/colibri/ie%2D6.css" rel="stylesheet" type="text/css" />
<![endif]-->
<link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Settings?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/AnnotationCode/Style?language=en'/><link rel='stylesheet' type='text/css' href='/bin/ssx/XWiki/SharePage?language=en'/>
<link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/modalPopup.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/js/xwiki/widgets/jumpToPage.css?language=en'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/confirmationBox.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/resources/uicomponents/widgets/notification.css'/><link rel='stylesheet' type='text/css' href='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.css'/>

    
    <link href="/bin/skin/resources/js/xwiki/suggest/ajaxSuggest.css" rel="stylesheet" type="text/css" />
<link href="/bin/skin/resources/js/xwiki/lightbox/lightbox.css" rel="stylesheet" type="text/css" />
<!--[if IE]>
  <link href="/bin/skin/resources/js/xwiki/lightbox/lightboxIE.css" rel="stylesheet" type="text/css" />
<![endif]-->












<script type="text/javascript" src="/resources/js/prototype/prototype.js"></script>
<script type="text/javascript" src="/bin/skin/resources/js/xwiki/xwiki.js"></script>
<script type="text/javascript">
// <![CDATA[
XWiki.webapppath = "";
XWiki.servletpath = "bin/";
XWiki.contextPath = "";
XWiki.mainWiki = "xwiki";
XWiki.currentWiki = "xwiki";
XWiki.currentSpace = "Project vnm";
XWiki.currentPage = "VNRP";
XWiki.editor = "";
XWiki.viewer = "";
XWiki.contextaction = "view";
XWiki.docisnew = false;
XWiki.docsyntax = "xwiki/2.0";
XWiki.blacklistedSpaces = [ "Import","Panels","Scheduler","Stats","XAppClasses","XAppSheets","XAppTemplates","XWiki","WatchCode","WatchSheets","XApp","WatchAdmin","Watch","ColorThemes","AnnotationCode" ];
XWiki.hasEdit = false;
XWiki.hasProgramming = false;
XWiki.hasBackupPackImportRights = false;
window.docviewurl = "/bin/view/Project+vnm/VNRP";
window.docediturl = "/bin/edit/Project+vnm/VNRP";
window.docsaveurl = "/bin/save/Project+vnm/VNRP";
window.docgeturl = "/bin/get/Project+vnm/VNRP";
// ]]>
</script>
<script type='text/javascript' src='/bin/skin/resources/js/scriptaculous/effects.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/modalPopup.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/js/xwiki/widgets/jumpToPage.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmationBox.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/confirmedAjaxRequest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/resources/uicomponents/widgets/notification.js' defer='defer'></script>
<script type='text/javascript' src='/resources/uicomponents/widgets/list/xlist.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/suggest/ajaxSuggest.js' defer='defer'></script>
<script type='text/javascript' src='/bin/skin/skins/colibri/resources/uicomponents/viewers/tags.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/scriptaculous/scriptaculous.js' defer='defer'></script>
<script type='text/javascript' src='/resources/js/xwiki/accordion/accordion.js' defer='defer'></script>

<script type='text/javascript' src='/bin/jsx/XWiki/WebDAV?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Settings?language=en' defer='defer'></script>
<script type='text/javascript' src='/bin/jsx/AnnotationCode/Script?language=en' defer='defer'></script>

<script type="text/javascript" src="/resources/js/xwiki/compatibility.js" defer="defer"></script>

  </head>
  <body id="body" class="wiki-xwiki space-Project_vnm viewbody hideright">
<div id="xwikimaincontainer">
<div id="xwikimaincontainerinner">

  <div id="menuview">
    <div id="mainmenu" class="layoutsubsection actionmenu">
<strong id="xwikimenutitle" class="hidden">General Actions:</strong>
<div class="rightmenu">
      <div id="tmLogin" class="tmLogin topmenuentry ">
   <a class="tme" href="https://auth.opensolaris.org/login.action?targetUrl=http%3A%2F%2Fmarkebrooks.github.io%2Fbin%2Fview%2FProject%2Bvnm%2FVNRP"><strong>Log-in</strong></a>
  </div>
  </div>
<div class="leftmenu">
  <div id="tmWiki" class="tmWiki topmenuentry hasIcon">
   <a class="tme" href="/bin/view/Main/"><strong>Wiki</strong></a>
  </div>
  <div id="tmSpace" class="tmSpace topmenuentry dropdownmenuentry  hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+vnm/"><strong>Project vnm</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
                <span class="submenuitem "><a href="/bin/view/Main/SpaceIndex?space=Project+vnm" id="tmSpaceDocumentIndex" class="tmSpaceDocumentIndex">Document Index</a></span>
    </span></div>

<div id="tmSubSites" class="tmSubSites topmenuentry dropdownmenuentry dropdownnolink hasIcon" onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Subsites</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem hasIcon"><a href="https://cr.opensolaris.org/" id="tmCR" class="tmCR">Code Reviews</a></span>
<span class="submenuitem hasIcon"><a href="http://repo.opensolaris.org/" id="tmRepo" class="tmRepo">SCM Management</a></span>
<span class="submenuitem hasIcon"><a href="http://pkg.opensolaris.org/" id="tmPkg" class="tmPkg">Package Search</a></span>
<span class="submenuitem hasIcon"><a href="http://bugs.opensolaris.org/" id="tmBugs" class="tmBugs">Bugster</a></span>
<span class="submenuitem hasIcon"><a href="http://defect.opensolaris.org/" id="tmDefect" class="tmDefect">Bugzilla</a></span>
<span class="submenuitem hasIcon"><a href="http://test.opensolaris.org/" id="tmTest" class="tmTest">Test Machines</a></span>
<span class="submenuitem hasIcon"><a href="http://planet.opensolaris.org/" id="tmPlanet" class="tmPlanet">Planet</a></span>
<span class="submenuitem hasIcon"><a href="http://mail.opensolaris.org/" id="tmMail" class="tmMail">Mailing Lists</a></span>
<span class="submenuitem hasIcon"><a href="http://poll.opensolaris.org/" id="tmPoll" class="tmPoll">Elections &amp; Polls</a></span>
<span class="submenuitem hasIcon"><a href="http://arc.opensolaris.org/" id="tmArc" class="tmArc">ARC Case Logs</a></span>
<span class="submenuitem hasIcon"><a href="http://jucr.opensolaris.org/" id="tmJucr" class="tmJucr">Source Juicer</a></span>
<span class="submenuitem hasIcon"><a href="http://pkgfactory.opensolaris.org/" id="tmPkgfactory" class="tmPkgfactory">Package Factory</a></span>
<span class="submenuitem hasIcon"><a href="http://auth.opensolaris.org/" id="tmAuth" class="tmAuth">Auth</a></span>
</span></div>

</div>
</div>

  </div>
 <div id="header" class="layoutsection">
<div class="minwidthb"></div>

  <div id="header">
    <table style="width: 100%;">
        <tr>
            <td style="width: 1%;">
                 <a href="https://markebrooks.github.io/bin/view/Main/"><div id="logo"></div></a>  
            </td>
            <td id="logo-text" style="width: 1%;">
                Solaris
            </td>         
            <td style="width: 98%;">
                <table id="loading-indicator">
                    <tr>
                        <td><img src="https://markebrooks.github.io:443/static/images/busy.gif"
                                 alt="Loading" title="Loading"/></td>
                        <td>Loading...</td>
                    </tr>
                </table>
            </td>
            <td style="width: 1%;">
                <table id="iconbar">
                    <tr>
                    <td><a id="collectives-icon" href="https://markebrooks.github.io/bin/view/Main/collectives">
                        Collectives</a></td>
                    <td><a id="discussions-icon" href="https://markebrooks.github.io/bin/view/Main/discussions">
                            Discussions</a></td>
                    <td><a id="documentation-icon" href="https://markebrooks.github.io/bin/view/Main/documentation">
                            Documentation</a></td>
                    <td><a id="download-icon" href="https://markebrooks.github.io/bin/view/Main/downloads">
                            Download</a></td>
                    <td><a id="source-browser-icon" href="http://src.opensolaris.org/source">
                            Source Browser</a></td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</div>

 </div> 
  <div id="globallinks">
    <form action="/bin/view/Main/Search">
      <div class="globalsearch">
        <label class="hidden" for="headerglobalsearchinput">Search</label><input class="globalsearchinput withTip" id="headerglobalsearchinput" type="text" name="text" value="search..." size="15"/><input class="button" type="image" value="Go" alt="Go" src="/resources/icons/xwiki/search.png"/>
      </div>
    </form>
  </div> <div style="float:left;">

                

   <div id="hierarchy">
                  <span class='current'>Virtual Network Router Appliance Project</span>
          </div>

</div>
  <span class="glink" id="headerlanguages" style="float:right">
        <a href="/bin/view/Project+vnm/VNRP?language=en" class="language-default language-current">en</a>
    </span>


<div class="contenthideright" id="contentcontainer">
<div id="contentcontainerinner">
<div class="leftsidecolumns">
  <div id="contentcolumn"> 
          <div class="main layoutsubsection">
      <div id="contentmenu" class="actionmenu">
    <strong id="xwikicontentmenutitle" class="hidden">Page Actions:</strong>
<div class="rightmenu">
</div>
<div class="leftmenu">
  <div id="tmExport" class="tmExport topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>Export</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/export/Project+vnm/VNRP?format=pdf&amp;language=en" id="tmExportPdf" class="tmExportPdf">Export as PDF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+vnm/VNRP?format=rtf&amp;language=en" id="tmExportRtf" class="tmExportRtf">Export as RTF</a></span>
  <span class="submenuitem "><a href="/bin/export/Project+vnm/VNRP?format=html&amp;language=en" id="tmExportHtml" class="tmExportHtml">Export as HTML</a></span>
    </span></div>

<div id="tmShow" class="tmShow topmenuentry dropdownmenuentry  " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme" href="/bin/view/Project+vnm/VNRP?viewer=code&amp;language=en"><strong>View</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
<span class="submenuitem "><a href="/bin/view/Project+vnm/VNRP?viewer=comments&amp;language=en" id="tmViewComments" class="tmViewComments">Comments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+vnm/VNRP?viewer=attachments&amp;language=en" id="tmViewAttachments" class="tmViewAttachments">Attachments</a></span>
<span class="submenuitem "><a href="/bin/view/Project+vnm/VNRP?viewer=history&amp;language=en" id="tmViewHistory" class="tmViewHistory">History</a></span>
<span class="submenuitem "><a href="/bin/view/Project+vnm/VNRP?viewer=information&amp;language=en" id="tmViewInformation" class="tmViewInformation">Information</a></span>
<span class="submenuitem "><a href="/bin/view/Project+vnm/VNRP?viewer=code&amp;language=en" id="tmViewSource" class="tmViewSource">View Source</a></span>
</span></div>

  <div id="tmMoreActions" class="tmMoreActions topmenuentry dropdownmenuentry dropdownnolink " onmouseover="showsubmenu(this);" onmouseout="hidesubmenu(this);">
<span class="tme-extensible">
   <a class="tme"><strong>More actions</strong></a>
    <span class="hidden menucolon">: </span>
</span><span class="submenu hidden">
  <span class="submenuitem "><a href="/bin/view/Project+vnm/VNRP?xpage=print&amp;language=en" id="tmPrintPreview" class="tmPrintPreview">Print preview</a></span>
          <span class="submenuitem "><a href="/bin/view/Project+vnm/VNRP?xpage=copy" id="tmActionCopy" class="tmActionCopy">Copy</a></span>
      </span></div>
</div>

    </div>
    <div id="mainContentArea">
      








    
<div id="document-title"><h1>Virtual Network Router Appliance Project</h1></div>





              <div id="document-info">
    <div>
          </div>
    <div class="clearfloats"></div>
  </div>

<div id="xwikicontent">
<hr/><h1 id="HVNRP-VirtualNetworkRouterApplianceProject"><span><strong>VNRP - Virtual Network Router Appliance Project</strong></span></h1><hr/><ul><li><span class="wikilink"><a href="#intro">Introduction</a></span></li><li><span class="wikilink"><a href="#architecture">VNRP Architecture</a></span></li><li><span class="wikilink"><a href="#project">VNRP Project Prototype Requirements</a></span></li><li><span class="wikilink"><a href="#starting">Getting Started</a></span></li><li><span class="wikilink"><a href="#running">Virtualization Support</a></span></li><li><span class="wikilink"><a href="#downloads">Downloading</a></span></li><li><span class="wikilink"><a href="#future">Future Enhancements</a></span></li></ul><hr/><p> <strong>Introduction</strong></p><hr/><p>&nbsp;VNRP is a prototype of an appliance platform based on OpenSolaris/Indiana that enables deployment of an edge router in a development environment.</p><p>&nbsp;This initial version of VNRP configures RIP or OSPF protocols across a pair of Zones that represent the internal (Intranet) and external (Internet) networking domains. The set of available network interfaces can be assigned across the Zones and are isolated specifically to the Zones they belong to.</p><p>&nbsp;All the functionality provided by VNRP, as well as the source code, is currently available in OpenSolaris with the exception of the Crossbow Anchor VNIC support. Anchor VNIC support that's required by VNRP is temporarily provided by a network pseudo driver named vpnet. This driver is used to communicate between Solaris Zones that are using exclusive IP stacks without the need for allocating a physical hardware NIC port.</p><p>&nbsp;Though all the capabilities provided by VNRP are available in OpenSolaris, VNRP is a focused effort behind the integration and initial configuration of the Solaris router facilities using Zones, Quagga and Webmin. This can be used as-is to deploy elementary edge-router appliances, or used as a base for further development.</p><p>&nbsp;The software that VNRP provides on top of the OpenSolaris/Indiana distribution are experimental in nature and intended to showcase some of the current capabilities of Solaris as well as foster further development of router appliances in the community.</p><p>&nbsp;The <span class="wikilink"><a href="/bin/view/Project+crossbow/">Crossbow project</a></span> will provide unique functionality to VNRP, and integrated use of Crossbow capabilities will become available in VNRP once Crossbow integrates into OpenSolaris. We are also looking for ideas from the community on different ways by which Crossbow can provide differentiable capabilities in the VNRP effort.</p><p>&nbsp;The following project pages contain information related to VNRP:</p><ul><li><span class="wikilink"><a href="/bin/view/Project+crossbow/">Crossbow</a></span></li><li><span class="wikilink"><a href="/bin/view/Project+quagga/">Quagga</a></span></li><li><span class="wikilink"><a href="/bin/view/Project+vnm/">VirtualNetworkMachines</a></span></li><li><span class="wikilink"><a href="/bin/view/Project+rbridges/">RBridges</a></span></li></ul><hr/><p> <strong>Architecture:</strong></p><hr/><p> <img src="https://markebrooks.github.io/bin/download/Project+vnm/VNRP/VNRP-BluePrint.jpg" alt="VNRP-BluePrint.jpg"/>&nbsp;The VNRP appliance is composed of two Solaris Zones, connected to each other by individual pseudo network driver module instances vpnet0 and vpnet1. The Internet and Intranet zones are separated to function in their specific domain so failures and security issues are isolated.</p><p>&nbsp;Each domain runs as an ip-type=exclusive Zone so each can utilize its own routing protocol and own specific instances of network adapters. Currently OSPF and RIP are provided as protocol options. BGP Webmin additions are in the process of being developed, but any currently supported Quagga protocol may be configured manually in any Zone by creating appropriate configuration files and enabling the service:</p><pre>

	# svcs quagga
	STATE          STIME    FMRI
	disabled       Dec_12   svc:/network/routing/zebra:quagga
	disabled       Dec_12   svc:/network/routing/rip:quagga
	disabled       Dec_12   svc:/network/routing/ripng:quagga
	disabled       Dec_12   svc:/network/routing/ospf:quagga
	disabled       Dec_12   svc:/network/routing/ospf6:quagga
	disabled       Dec_12   svc:/network/routing/bgp:quagga 

</pre><p>&nbsp;The Intranet/Internet Zones were derived from an OpenSolaris build 76 installation that contained only the CORE packages. These images were transplanted to the Indiana LiveCD image for use in the VNRP release.</p><p>&nbsp;The VNRP Webmin components are located in /usr/sfw/lib/webmin/VNRP and provide a simple GUI for basic VNRP configuration.</p><p>&nbsp;The VNRP initialization script, located in /sbin/VNRP.init, is normally only run once in the LiveCD environment to startup the pre-configured Zones, initialize Quagga and Webmin and setup other environmental requirements. /sbin/VNRP.config starts up the Webmin browser and /sbin/VNRP.install is run as a wrapper script around the Indiana gui-install module to setup the installation environment (Zone installation currently needs special treatment to work with the Indiana gui-install).</p><p>&nbsp;The remainder of the VNRP sources reside in the Webmin directory (/usr/sfw/lib/webmin/VNRP), with the vpnet driver configuration file residing in /kernel/drv/vpnet.conf. The driver is initially configured to initialize only two interfaces (vpnet0/vpnet1), but can be reconfigured with up to 10 if needed (more than 10 require a recompile of the driver).</p><p>&nbsp;See the <strong><span class="wikilink"><a href="#downloads">Downloading</a></span></strong> section below for instructions on obtaining the vpnet driver package.</p><hr/><p> <strong>VNRP Project Prototype Requirements:</strong></p><hr/><p>&nbsp;The VNRP prototype is delivered on LiveCD media that allows "test driving" of the routing facilities without over-writing any existing local storage. After the "live" instance is brought up it can be instantiated on a local system drive to provide a persistent router instance, and modified more extensively once installed there.</p><p>&nbsp;This prototype is a developer release. The configuration tools are available for initial configuration and installation of a the router appliance on the following hardware:</p><ul><li>HW Platform:<ul><li>x64 - i86pc/i86xpv (i.e. an Ultra 20)</li><li>Minimum of 1GB memory - 2GB preferred</li><li>Minimum of two additional NIC ports (i.e. one dual e1000g PCI card)</li></ul></li></ul><p>&nbsp;The ISO image can either be burned onto a CD and used as a boot device, or booted directly as an xVM DomU instance from the ISO file (an example xVM configuration file is provided below).</p><ul><li>in-preview-VNRP.iso (660.5MB)<ul><li>OS: Indiana (snv_75) xVM</li><li>Routing Protocols: OSPF, RIP</li><li>Preconfigured Zones: global, internet, intranet</li><li>Network Interfaces: e1000g, nge, xnf, ...</li></ul></li></ul><hr/><p> <strong>Getting Started:</strong></p><hr/><ul><li>Burn/Boot</li><li>Play</li><li>Install/Develop...</li></ul><p>&nbsp;After burning the supplied ISO image to appropriate CD media (or DVD media if your system has a DVD player), insert the VNRP LiveCD into an x86 system and boot the system from that device.</p><p>&nbsp;Once booted, the LiveCD should automatically log in as user "jack" ... (N.B. if you're presented with a Solaris login, login as user "jack" using the password "jack"), it should then take you on to the Webmin login.</p><p>&nbsp;Webmin is used as the router configuration interface. The Webmin browser login should come up automatically (it may take a few seconds, be patient). After the Webmin browser appears, login as user "root" with the password "opensolaris".</p><p>&nbsp;Within Webmin, the Virtual Network Router Appliance Project screen will show three Solaris zones (global/internet/intranet), their currently configured router protocol configuration and all the available network interfaces that were detected during boot. The interfaces will be initially be attached to the global zone with routing turned off.</p><p>&nbsp;After selecting your routing protocol for the Internet and Intranet zones (OSPF or RIP), interfaces may be moved to their appropriate zones (i.e. interfaces attached to the local network should be placed in the intranet zone) and IP addresses can be assigned. You can select the use of DHCP for automatic IP address assignment, but only if a DHCP server is available on the attached subnet(s).</p><p>&nbsp;Clicking on the "Commit" button will instantiate the configuration.</p><p>&nbsp;Once your changes have been committed, turning back to the VNRP page will show the current state of the router configuration and allow further changes.</p><p>&nbsp;Installing to a local drive will provide more flexibility in adding additional software and making the configuration persistent across reboots. To proceed with installing the current configuration click on the "Install OpenSolaris" desktop icon and follow the installation instructions.</p><p>&nbsp;After rebooting to the locally installed version further changes can be made to the system through Webmin or any other available OpenSolaris administrative interface.</p><hr/><p> <strong>Virtualization Support</strong></p><hr/><p>&nbsp;The same ISO image can be brought up as a DomU instance on a system running Solaris xVM.</p><p>&nbsp;This allows you to run multiple xVM "appliances" on the same physical machine. As an example consider the case where a router and an intrusion prevention system could be run on the same physical box but each in their own guest domain. The vpnet driver could be used as a fast communication mechanism between guest domains (it also removes the requirement that without Crossbow Anchor VNIC support, one needs an external NIC device to communicate between domains).</p><p>&nbsp;Make the ISO image available to the Solaris xVM Dom0 either by copying it to local storage or exporting it via NFS. Create an xVM configuration file in /etc/xen/VNRP, then create a new DomU (xm create -c VNRP).</p><p>&nbsp;Example xVM configuration file:</p><pre>

        name = "VNRP" 
        vcpus = 1
        memory = "1024"

        ramdisk = '/boot/x86.microroot'

        #
        # Path to ISO image in /export/home/in-preview-VNRP.iso
        # 
        disk = [ 'file:/export/home/in-preview-VNRP.iso,6:cdrom,r' ]

        # 
        # Configure up to three NIC interfaces.  One (xnf0) for the
        # external Webmin interface, one for the internet connection and
        # one for the intranet.  Example:
        #
        #       xnf0/nge0 == public interface,
        #       xnf1/e1000g0 == internet connection
        #       xnf2/e1000g1 == local intranet.
        #
        vif = ['bridge=nge0', 'bridge=e1000g0', 'bridge=e1000g1' ]

        on_shutdown = "destroy"
        on_reboot = "destroy"
        on_crash = "destroy"

</pre><p>&nbsp;Once the domain is booted, logging in as user "jack" (password "jack") will start the initialization of the router appliance components:</p><pre>

        opensolaris console login: jack
        Password:
        Sun Microsystems Inc.   SunOS 5.11      snv_75  October 2007

        Initializing VNRP ... please wait ...
                starting Zones ...
                        internet ...
                        intranet ...
                initializing Quagga ...
                initializing Webmin ...
        Dec 19 12:27:18 localhost webmin[1359]: Webmin starting

        Initialize a public network interface and connect to Webmin via:

                http://(ip address):10000/VNRP/index.cgi

        -bash-3.2$

</pre><p>&nbsp;In this example, if DHCP services were available on the subnet that nge0 is connected to, the interface can be configured to use DHCP with ifconfig(1m):</p><pre>

        ifconfig xnf0 dhcp

</pre><p>&nbsp;An ifconfig -a will show the assigned address and an external Webmin VNRP session initiated from an external browser with the following URL:</p><pre>

        http://(assigned DHCP address):10000/VNRP/index.cgi

</pre><p>&nbsp;Once you've attached to the Webmin service on the VNRP domU instance you can proceed with your virtual router appliance configuration.</p><hr/><p><strong>Installing the configured VNRP instance</strong></p><p>&nbsp;While it's possible to run the VNRP.install script to instantiate the xVM domU VNRP instance on a virtual disk and persist the configuration, there are currently issues with booting ZFS-root based domU guests under xVM that prevent the image from being used.</p><p>&nbsp;In the mean time, the following instructions can be used to produce an image that can be booted as an xVM guest once the xVM/ZFS-root boot issues are resolved.</p><p>&nbsp;In order to install the configuration on a virtual drive using the gui-install you must specify a vdisk device that exists in the xVM configuration file prior to booting the domain:</p><pre>

        disk = [ 'file:/export/home/in-preview-VNRP.iso,6:cdrom,r',
		 'file:/export/home/your.disk.img,0,w' ]

</pre><p>&nbsp;You can then set an appropriate DISPLAY variable and run /sbin/VNRP.install to start the installation remotely. The resulting disk image would then be booted up directly in an xVM guest domain with a configuration file like the following:</p><pre>

        name = "your.domain" 
        vcpus = 1
        memory = "1024"
        ramdisk = '/boot/x86.microroot'
        disk = [ 'file:/export/home/your.disk.img,0,w' ]
        vif = ['bridge=nge0', 'bridge=e1000g0', 'bridge=e1000g1' ]
        on_shutdown = "destroy"
        on_reboot = "destroy"
        on_crash = "destroy"

</pre><p>&nbsp;N.B. There's currently a limit of three (3) VIF interfaces that can be configured for OpenSolaris xVM guest domains.</p><hr/><p> <strong>Downloading</strong></p><hr/><p>&nbsp;The VNRP iso image can be downloaded from <span class="wikiexternallink"><a href="http://dlc.sun.com/osol/VNRP/downloads/current/in-preview-VNRP.iso"><span class="wikiexternallink"><a class="wikimodel-freestanding" href="http://dlc.sun.com/osol/VNRP/downloads/current/in-preview-VNRP.iso"><span class="wikigeneratedlinkcontent">http://dlc.sun.com/osol/VNRP/downloads/current/in-preview-VNRP.iso</span></a></span></a></span> and assumes the same licensing and distribution restrictions as specified at the <span class="wikilink"><a href="/bin/view/Project+indiana/getit">Indiana Download</a></span> site. This contains an image that can be booted directly from a CD, or brought up within an xVM guest domain (see the Virtualization Support instructions above).</p><p>&nbsp;The vpnet driver used by VNRP can be downloaded from <span class="wikiexternallink"><a href="https://markebrooks.github.io/bin/download/Project+vnm/VNRP/vpnet-driver-20080108.i386.tar">vpnet-driver-20080108.i386.tar</a></span>. These same driver binaries already exist in the VNRP iso image so this tarfile is only useful for installing the vpnet driver on a system running OpenSolaris. The tarfile contains an SVR4 package stream that, once installed with pkgadd -d SUNWvpnet.pkg and the driver configuration file (/kernel/drv/vpnet.conf) modified to specify the required instances, can be enabled on the system simply by running "add_drv vpnet".</p><hr/><p> <strong>Future Enhancements:</strong></p><hr/><p><span class="wikilink"><a href="/bin/view/Project+crossbow/">Crossbow</a></span> will integrate into OpenSolaris proper at some point and will replace the need for the vpnet driver that's currently used in the VNRP appliance to route packets between the Intranet and Internet Zones. Crossbow will, in addition, present an additional new set of features that can be utilized in router appliance development.</p><p>&nbsp;Additional support for BGP and IPFilter firewall facilities.</p><p>&nbsp;The <span class="wikilink"><a href="/bin/view/Community+Group+arc/onepager">&nbsp;Newboot project</a></span> will provide an environment for SPARC LiveCD media support.</p><p>&nbsp;Fix support for booting ZFS-root instances installed from Indiana.</p><hr/><p>&nbsp;The VNRP project is open for questions and suggestions ... visit the <span class="wikicreatelink"><a href="/bin/create/Project+vnm/VirtualRouter?parent=Project+vnm.VNRP">&nbsp;Virtual Router</a></span> community page and subscribe to the VNM discussion <span class="wikilink"><a href="/bin/view/Project+vnm/mail%2Dlists">mail list</a></span> to participate in the project and track future releases ...</p><hr/>
</div>


    <div class="clearfloats"></div>
  </div>      <div id="xdocFooter">
  
                

       <div class="doc-tags" id="xdocTags">
        Tags:
        </div>
  
  <div id="xdocAuthors">
    <div class="xdocCreation">       Created by admin on 2009/10/26 12:18<br/>
          </div>
    <div class="xdocLastModification">       Last modified by admin on 2009/10/26 13:17
    </div>
  </div>
</div>
<div id="xwikidata" class="layoutsubsection">
        </div>  
    </div>      </div><div id="leftPanels" class="panels left">
                  <div class="panel expanded OSNav">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSNav');">Collectives</h1>
<div class="xwikipanelcontents">
<div id="xwikinavcontainer">
<span class="wikilink"><a href="/bin/view/Main/communities">Community Groups</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/projects">Projects</a></span><br/>
<span class="wikilink"><a href="/bin/view/Main/usergroups">User Groups</a></span>
</div><p/>
<script type="text/javascript">
document.observe('xwiki:dom:loaded', function() {
var obj = {div:'xwikinav',no:$count,height:250};
var acc = createAccordion(obj);
});
</script>
</div>
</div>
                        <div class="panel expanded OSDocs">
<h1 class="xwikipaneltitle" onclick="XWiki.togglePanelVisibility(this.parentNode, 'XWiki.XWikiGuest_Panels.OSDocs');">Project vnm Pages</h1>
<div class="xwikipanelcontents">
<ul class="star">
<li><span class="wikilink"><a href="/bin/view/Project+vnm/ILB">Integrated Load Balancer</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+vnm/Sitara">Project Sitara</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+vnm/VNRP">Virtual Network Router Appliance Project</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+vnm/files">Files</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+vnm/mail%2Dlists">Mail Lists</a></span></li>
<li><span class="wikilink"><a href="/bin/view/Project+vnm/vnm_admin">VNM Development Tools and Demo</a></span></li>
</ul>
                              </div>
</div>
      </div>

  </div>
<div class="clearfloats"></div>
  </div></div><div id="footerglobal" class="layoutsection">
<div class="minwidth"></div>
<hr/>
        <div id="xwikiplatformversion">XWiki Enterprise 2.7.1.34853 - <a onclick="openURL('http://enterprise.xwiki.org/xwiki/bin/view/Main/Documentation', '_blank'); return false;" href="http://www.xwiki.org/xwiki/bin/view/Main/Documentation">Documentation</a></div>
<br/>
  
      <div id="footer">
    <p>
                <a href="https://markebrooks.github.io/bin/view/Main/tou/">Terms of Use</a>
                |
                <a href="http://www.oracle.com/html/privacy.html">Privacy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/trademark/">Trademarks</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/copyrights/">Copyright Policy</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site_guidelines/">Site Guidelines</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/site-map/">Site Map</a>
                |
                <a href="https://markebrooks.github.io/bin/view/Main/help/">Help</a>
                <br/>Your use of this web site or any of its content or software indicates your agreement to be bound by these Terms of Use.<br/>
                &copy; 2012, Oracle Corporation and/or its affiliates.<br/><img src="https://markebrooks.github.io:443/static/images/logo_oracle_footer.gif" alt="Oracle Logo"/>
            </p>
        </div>

  
</div>

</div></div></body>
</html>
